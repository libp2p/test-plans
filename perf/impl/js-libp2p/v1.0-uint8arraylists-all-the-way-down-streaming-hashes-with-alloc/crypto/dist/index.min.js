(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var j0=Object.create;var Wr=Object.defineProperty;var tf=Object.getOwnPropertyDescriptor;var ef=Object.getOwnPropertyNames;var rf=Object.getPrototypeOf,nf=Object.prototype.hasOwnProperty;var ft=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),gt=(t,e)=>{for(var r in e)Wr(t,r,{get:e[r],enumerable:!0})},Ka=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ef(e))!nf.call(t,i)&&i!==r&&Wr(t,i,{get:()=>e[i],enumerable:!(n=tf(e,i))||n.enumerable});return t};var Nt=(t,e,r)=>(r=t!=null?j0(rf(t)):{},Ka(e||!t||!t.__esModule?Wr(r,"default",{value:t,enumerable:!0}):r,t)),af=t=>Ka(Wr({},"__esModule",{value:!0}),t);var it=ft((Vd,Va)=>{Va.exports={options:{usePureJavaScript:!1}}});var Ha=ft((qd,Fa)=>{var Fn={};Fa.exports=Fn;var qa={};Fn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=sf(t,e);else{var i=0,a=e.length,o=e.charAt(0),s=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<s.length;++f)c+=s[f]<<8,s[f]=c%a,c=c/a|0;for(;c>0;)s.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=s.length-1;i>=0;--i)n+=e[s[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Fn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=qa[e];if(!r){r=qa[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),o=[0],n=0;n<t.length;n++){var s=r[t.charCodeAt(n)];if(s===void 0)return;for(var f=0,c=s;f<o.length;++f)c+=o[f]*i,o[f]=c&255,c>>=8;for(;c>0;)o.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function sf(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var o=0,s=t.at(r);o<a.length;++o)s+=a[o]<<8,a[o]=s%n,s=s/n|0;for(;s>0;)a.push(s%n),s=s/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var bt=ft((Fd,Ya)=>{var za=it(),Ga=Ha(),g=Ya.exports=za.util=za.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(s){return setImmediate(s)};return}if(g.setImmediate=function(s){setTimeout(s,0)},typeof window<"u"&&typeof window.postMessage=="function"){let s=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var o=s,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",s,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Er(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=Hn;function Hn(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Hn||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=Hn;var of=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>of&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){Er(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){Er(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function ff(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=ff;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){Er(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return Er(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){Er(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",a="",o=0,s=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),s>=10&&(n+=a,a="",s=0),a+=String.fromCharCode(i),++s;return n+=a,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ae=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Wa="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,a,o,s=0;s<t.length;)i=t.charCodeAt(s++),a=t.charCodeAt(s++),o=t.charCodeAt(s++),r+=Se.charAt(i>>2),r+=Se.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=Se.charAt((a&15)<<2|o>>6),r+=isNaN(o)?"=":Se.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,o=0;o<t.length;)r=Ae[t.charCodeAt(o++)-43],n=Ae[t.charCodeAt(o++)-43],i=Ae[t.charCodeAt(o++)-43],a=Ae[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Ga.encode,decode:Ga.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,a,o,s=0;s<t.byteLength;)i=t[s++],a=t[s++],o=t[s++],r+=Se.charAt(i>>2),r+=Se.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=Se.charAt((a&15)<<2|o>>6),r+=isNaN(o)?"=":Se.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,o,s,f=0,c=r;f<t.length;)i=Ae[t.charCodeAt(f++)-43],a=Ae[t.charCodeAt(f++)-43],o=Ae[t.charCodeAt(f++)-43],s=Ae[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,o!==64&&(n[c++]=(a&15)<<4|o>>2,s!==64&&(n[c++]=(o&3)<<6|s));return e?c-r:n.subarray(0,c)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,Wa,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,Wa,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,o=r,s=0;s<t.length;++s)i[o++]=t.charCodeAt(s),a+=2;return e?a-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var zn=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Gn=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},cf=function(t,e,r,n){var i=Gn(t,e);i===null&&(i={}),i[r]=n,zn(t,e,i)},uf=function(t,e,r){var n=Gn(t,e);return n!==null&&(n=r in n?n[r]:null),n},hf=function(t,e,r){var n=Gn(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),zn(t,e,n)}},lf=function(t,e){zn(t,e,null)},Yr=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,o=null;for(var s in r){i=r[s];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){o=f}if(a)break}if(!a)throw o;return n};g.setItem=function(t,e,r,n,i){Yr(cf,arguments,i)};g.getItem=function(t,e,r,n){return Yr(uf,arguments,n)};g.removeItem=function(t,e,r,n){Yr(hf,arguments,n)};g.clearItems=function(t,e,r){Yr(lf,arguments,r)};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,a=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&a.push(n),o=e.lastIndex;var s=r[0][1];switch(s){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+s+"?>")}}return a.push(t.substring(o)),a.join("")};g.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,s=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+s:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?o+Math.abs(i-c).toFixed(a).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=g.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=g.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var o=r[r.length-1],s=e.length;!o||s!==o.end+1?r.push({start:s,end:s}):(o.end=s,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker>"u")return g.cores=1,e(null,g.cores);if(typeof Blob>"u")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var s=Date.now(),f=s+4;Date.now()<f;);self.postMessage({st:s,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,s,f){if(s===0){var c=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(u,h){o.push(a(f,h)),n(o,s-1,f)})}function i(o,s){for(var f=[],c=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(d){if(c.push(d.data),c.length===o){for(var x=0;x<o;++x)f[x].terminate();s(null,c)}}),f.push(h)}for(var u=0;u<o;++u)f[u].postMessage(u)}function a(o,s){for(var f=[],c=0;c<o;++c)for(var u=s[c],h=f[c]=[],d=0;d<o;++d)if(c!==d){var x=s[d];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(d)}return f.reduce(function(l,p){return Math.max(l,p.length)},0)}}});var Yn=ft((Hd,Za)=>{var Ct=it();bt();Za.exports=Ct.cipher=Ct.cipher||{};Ct.cipher.algorithms=Ct.cipher.algorithms||{};Ct.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ct.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ct.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ct.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ct.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ct.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ct.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ct.cipher.algorithms[t]=e};Ct.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ct.cipher.algorithms?Ct.cipher.algorithms[t]:null};var Wn=Ct.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Wn.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ct.util.createBuffer(),this.output=t.output||Ct.util.createBuffer(),this.mode.start(e)};Wn.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Wn.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var $n=ft((zd,$a)=>{var It=it();bt();It.cipher=It.cipher||{};var $=$a.exports=It.cipher.modes=It.cipher.modes||{};$.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.ecb.prototype.start=function(t){};$.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};$.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};$.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};$.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};$.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Zr(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};$.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};$.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};$.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};$.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};$.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Zr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Zr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb.prototype.decrypt=$.ofb.prototype.encrypt;$.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0};$.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Zr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}$r(this._inBlock)};$.ctr.prototype.decrypt=$.ctr.prototype.encrypt;$.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=It.util.createBuffer(),this._partialBytes=0,this._R=3774873600};$.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=It.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=It.util.createBuffer(t.additionalData):r=It.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=It.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Zn(n*8)))}this._inBlock=this._j0.slice(0),$r(this._inBlock),this._partialBytes=0,r=It.util.createBuffer(r),this._aDataLength=Zn(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};$.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),$r(this._inBlock)};$.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),$r(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};$.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=It.util.createBuffer();var n=this._aDataLength.concat(Zn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};$.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};$.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};$.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};$.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};$.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),o=0;o<i;++o){var s=[0,0,0,0],f=o/n|0,c=(n-1-o%n)*e;s[f]=1<<e-1<<c,a[o]=this.generateSubHashTable(this.multiply(s,t),e)}return a};$.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var o=1;o<a;++o){var s=i[a],f=i[o];i[a+o]=[s[0]^f[0],s[1]^f[1],s[2]^f[2],s[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function Zr(t,e){if(typeof t=="string"&&(t=It.util.createBuffer(t)),It.util.isArray(t)&&t.length>4){var r=t;t=It.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!It.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function $r(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Zn(t){return[t/4294967296|0,t&4294967295]}});var Xr=ft((Gd,ja)=>{var ot=it();Yn();$n();bt();ja.exports=ot.aes=ot.aes||{};ot.aes.startEncrypting=function(t,e,r,n){var i=Qr({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};ot.aes.createEncryptionCipher=function(t,e){return Qr({key:t,output:null,decrypt:!1,mode:e})};ot.aes.startDecrypting=function(t,e,r,n){var i=Qr({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};ot.aes.createDecryptionCipher=function(t,e){return Qr({key:t,output:null,decrypt:!0,mode:e})};ot.aes.Algorithm=function(t,e){Jn||Xa();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Xn(r._w,n,i,!1)},decrypt:function(n,i){return Xn(r._w,n,i,!0)}}}),r._init=!1};ot.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=ot.util.createBuffer(e);else if(ot.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=ot.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!ot.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!ot.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=Ja(e,t.decrypt&&!o),this._init=!0}};ot.aes._expandKey=function(t,e){return Jn||Xa(),Ja(t,e)};ot.aes._updateBlock=Xn;je("AES-ECB",ot.cipher.modes.ecb);je("AES-CBC",ot.cipher.modes.cbc);je("AES-CFB",ot.cipher.modes.cfb);je("AES-OFB",ot.cipher.modes.ofb);je("AES-CTR",ot.cipher.modes.ctr);je("AES-GCM",ot.cipher.modes.gcm);function je(t,e){var r=function(){return new ot.aes.Algorithm(t,e)};ot.cipher.registerAlgorithm(t,r)}var Jn=!1,Je=4,Pt,Qn,Qa,Ke,Wt;function Xa(){Jn=!0,Qa=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Pt=new Array(256),Qn=new Array(256),Ke=new Array(4),Wt=new Array(4);for(var e=0;e<4;++e)Ke[e]=new Array(256),Wt[e]=new Array(256);for(var r=0,n=0,i,a,o,s,f,c,u,e=0;e<256;++e){s=n^n<<1^n<<2^n<<3^n<<4,s=s>>8^s&255^99,Pt[r]=s,Qn[s]=r,f=t[s],i=t[r],a=t[i],o=t[a],c=f<<24^s<<16^s<<8^(s^f),u=(i^a^o)<<24^(r^o)<<16^(r^a^o)<<8^(r^i^o);for(var h=0;h<4;++h)Ke[h][r]=c,Wt[h][s]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function Ja(t,e){for(var r=t.slice(0),n,i=1,a=r.length,o=a+6+1,s=Je*o,f=a;f<s;++f)n=r[f-1],f%a===0?(n=Pt[n>>>16&255]<<24^Pt[n>>>8&255]<<16^Pt[n&255]<<8^Pt[n>>>24]^Qa[i]<<24,i++):a>6&&f%a===4&&(n=Pt[n>>>24]<<24^Pt[n>>>16&255]<<16^Pt[n>>>8&255]<<8^Pt[n&255]),r[f]=r[f-a]^n;if(e){var c,u=Wt[0],h=Wt[1],d=Wt[2],x=Wt[3],l=r.slice(0);s=r.length;for(var f=0,p=s-Je;f<s;f+=Je,p-=Je)if(f===0||f===s-Je)l[f]=r[p],l[f+1]=r[p+3],l[f+2]=r[p+2],l[f+3]=r[p+1];else for(var y=0;y<Je;++y)c=r[p+y],l[f+(3&-y)]=u[Pt[c>>>24]]^h[Pt[c>>>16&255]]^d[Pt[c>>>8&255]]^x[Pt[c&255]];r=l}return r}function Xn(t,e,r,n){var i=t.length/4-1,a,o,s,f,c;n?(a=Wt[0],o=Wt[1],s=Wt[2],f=Wt[3],c=Qn):(a=Ke[0],o=Ke[1],s=Ke[2],f=Ke[3],c=Pt);var u,h,d,x,l,p,y;u=e[0]^t[0],h=e[n?3:1]^t[1],d=e[2]^t[2],x=e[n?1:3]^t[3];for(var m=3,E=1;E<i;++E)l=a[u>>>24]^o[h>>>16&255]^s[d>>>8&255]^f[x&255]^t[++m],p=a[h>>>24]^o[d>>>16&255]^s[x>>>8&255]^f[u&255]^t[++m],y=a[d>>>24]^o[x>>>16&255]^s[u>>>8&255]^f[h&255]^t[++m],x=a[x>>>24]^o[u>>>16&255]^s[h>>>8&255]^f[d&255]^t[++m],u=l,h=p,d=y;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[d>>>8&255]<<8^c[x&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[d>>>16&255]<<16^c[x>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[d>>>24]<<24^c[x>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[x>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[d&255]^t[++m]}function Qr(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=ot.cipher.createDecipher(r,t.key):n=ot.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,o){var s=null;o instanceof ot.util.ByteBuffer&&(s=o,o={}),o=o||{},o.output=s,o.iv=a,i.call(n,o)},n}});var rn=ft((Wp,Ss)=>{var Tr=it();Tr.pki=Tr.pki||{};var Si=Ss.exports=Tr.pki.oids=Tr.oids=Tr.oids||{};function T(t,e){Si[t]=e,Si[e]=t}function rt(t,e){Si[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");rt("2.5.29.1","authorityKeyIdentifier");rt("2.5.29.2","keyAttributes");rt("2.5.29.3","certificatePolicies");rt("2.5.29.4","keyUsageRestriction");rt("2.5.29.5","policyMapping");rt("2.5.29.6","subtreesConstraint");rt("2.5.29.7","subjectAltName");rt("2.5.29.8","issuerAltName");rt("2.5.29.9","subjectDirectoryAttributes");rt("2.5.29.10","basicConstraints");rt("2.5.29.11","nameConstraints");rt("2.5.29.12","policyConstraints");rt("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");rt("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");rt("2.5.29.20","cRLNumber");rt("2.5.29.21","cRLReason");rt("2.5.29.22","expirationDate");rt("2.5.29.23","instructionCode");rt("2.5.29.24","invalidityDate");rt("2.5.29.25","cRLDistributionPoints");rt("2.5.29.26","issuingDistributionPoint");rt("2.5.29.27","deltaCRLIndicator");rt("2.5.29.28","issuingDistributionPoint");rt("2.5.29.29","certificateIssuer");rt("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");rt("2.5.29.33","policyMappings");rt("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");rt("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");rt("2.5.29.46","freshestCRL");rt("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Rr=ft((Yp,Cs)=>{var ct=it();bt();rn();var P=Cs.exports=ct.asn1=ct.asn1||{};P.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};P.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};P.create=function(t,e,r,n,i){if(ct.util.isArray(n)){for(var a=[],o=0;o<n.length;++o)n[o]!==void 0&&a.push(n[o]);n=a}var s={tagClass:t,type:e,constructed:r,composed:r||ct.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(s.bitStringContents=i.bitStringContents,s.original=P.copy(s)),s};P.copy=function(t,e){var r;if(ct.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(P.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:P.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};P.equals=function(t,e,r){if(ct.util.isArray(t)){if(!ct.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!P.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&P.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};P.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function _r(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var wc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;_r(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};P.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ct.util.createBuffer(t));var r=t.length(),n=nn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function nn(t,e,r,n){var i;_r(t,e,2);var a=t.getByte();e--;var o=a&192,s=a&31;i=t.length();var f=wc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,d=(a&32)===32;if(d)if(u=[],f===void 0)for(;;){if(_r(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}i=t.length(),u.push(nn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(nn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&o===P.Class.UNIVERSAL&&s===P.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&o===P.Class.UNIVERSAL&&s===P.Type.BITSTRING&&f>1){var x=t.read,l=e,p=0;if(s===P.Type.BITSTRING&&(_r(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},m=nn(t,e,r+1,y),E=i-t.length();e-=E,s==P.Type.BITSTRING&&E++;var b=m.tagClass;E===f&&(b===P.Class.UNIVERSAL||b===P.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=x,e=l)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(s===P.Type.BMPSTRING)for(u="";f>0;f-=2)_r(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var R=h===void 0?null:{bitStringContents:h};return P.create(o,s,d,u,R)}P.toDer=function(t){var e=ct.util.createBuffer(),r=t.tagClass|t.type,n=ct.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=P.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(P.toDer(t.value[a]))}else if(t.type===P.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===P.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),s="";do s+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(s.length|128);for(var a=s.length-1;a>=0;--a)e.putByte(s.charCodeAt(a))}return e.putBuffer(n),e};P.oidToDer=function(t){var e=t.split("."),r=ct.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,o,s=2;s<e.length;++s){n=!0,i=[],a=parseInt(e[s],10);do o=a&127,a=a>>>7,n||(o|=128),i.push(o),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};P.derToOid=function(t){var e;typeof t=="string"&&(t=ct.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};P.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(s=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,o,s,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),d=u*60+h;d*=6e4,f==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};P.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),s=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,d=t.charAt(h);if(d==="+"||d==="-"){var x=parseInt(t.substr(h+1,2),10),l=parseInt(t.substr(h+4,2),10);c=x*60+l,c*=6e4,d==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,o,s,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,o,s,f)),e};P.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};P.integerToDer=function(t){var e=ct.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};P.derToInteger=function(t){typeof t=="string"&&(t=ct.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};P.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&ct.util.isArray(e.value))for(var a=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[a]&&(i=P.validate(t.value[a],e.value[o],r,n),i?++a:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var s;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var As=/[^\\u0000-\\u00ff]/;P.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case P.Class.UNIVERSAL:n+="Universal:";break;case P.Class.APPLICATION:n+="Application:";break;case P.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case P.Class.PRIVATE:n+="Private:";break}if(t.tagClass===P.Class.UNIVERSAL)switch(n+=t.type,t.type){case P.Type.NONE:n+=" (None)";break;case P.Type.BOOLEAN:n+=" (Boolean)";break;case P.Type.INTEGER:n+=" (Integer)";break;case P.Type.BITSTRING:n+=" (Bit string)";break;case P.Type.OCTETSTRING:n+=" (Octet string)";break;case P.Type.NULL:n+=" (Null)";break;case P.Type.OID:n+=" (Object Identifier)";break;case P.Type.ODESC:n+=" (Object Descriptor)";break;case P.Type.EXTERNAL:n+=" (External or Instance of)";break;case P.Type.REAL:n+=" (Real)";break;case P.Type.ENUMERATED:n+=" (Enumerated)";break;case P.Type.EMBEDDED:n+=" (Embedded PDV)";break;case P.Type.UTF8:n+=" (UTF8)";break;case P.Type.ROID:n+=" (Relative Object Identifier)";break;case P.Type.SEQUENCE:n+=" (Sequence)";break;case P.Type.SET:n+=" (Set)";break;case P.Type.PRINTABLESTRING:n+=" (Printable String)";break;case P.Type.IA5String:n+=" (IA5String (ASCII))";break;case P.Type.UTCTIME:n+=" (UTC time)";break;case P.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case P.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,s="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(o+=1,s+=P.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(s+=","));n+=i+"Sub values: "+o+s}else{if(n+=i+"Value: ",t.type===P.Type.OID){var f=P.derToOid(t.value);n+=f,ct.pki&&ct.pki.oids&&f in ct.pki.oids&&(n+=" ("+ct.pki.oids[f]+") ")}if(t.type===P.Type.INTEGER)try{n+=P.derToInteger(t.value)}catch{n+="0x"+ct.util.bytesToHex(t.value)}else if(t.type===P.Type.BITSTRING){if(t.value.length>1?n+="0x"+ct.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===P.Type.OCTETSTRING)As.test(t.value)||(n+="("+t.value+") "),n+="0x"+ct.util.bytesToHex(t.value);else if(t.type===P.Type.UTF8)try{n+=ct.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+ct.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===P.Type.PRINTABLESTRING||t.type===P.Type.IA5String?n+=t.value:As.test(t.value)?n+="0x"+ct.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var _s=ft((Zp,Ts)=>{var lt=it();Yn();$n();bt();Ts.exports=lt.des=lt.des||{};lt.des.startEncrypting=function(t,e,r,n){var i=an({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};lt.des.createEncryptionCipher=function(t,e){return an({key:t,output:null,decrypt:!1,mode:e})};lt.des.startDecrypting=function(t,e,r,n){var i=an({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};lt.des.createDecryptionCipher=function(t,e){return an({key:t,output:null,decrypt:!0,mode:e})};lt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Is(r._keys,n,i,!1)},decrypt:function(n,i){return Is(r._keys,n,i,!0)}}}),r._init=!1};lt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=lt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Lc(e),this._init=!0}};ee("DES-ECB",lt.cipher.modes.ecb);ee("DES-CBC",lt.cipher.modes.cbc);ee("DES-CFB",lt.cipher.modes.cfb);ee("DES-OFB",lt.cipher.modes.ofb);ee("DES-CTR",lt.cipher.modes.ctr);ee("3DES-ECB",lt.cipher.modes.ecb);ee("3DES-CBC",lt.cipher.modes.cbc);ee("3DES-CFB",lt.cipher.modes.cfb);ee("3DES-OFB",lt.cipher.modes.ofb);ee("3DES-CTR",lt.cipher.modes.ctr);function ee(t,e){var r=function(){return new lt.des.Algorithm(t,e)};lt.cipher.registerAlgorithm(t,r)}var Bc=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Sc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Ac=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Cc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Ic=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Tc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],_c=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Rc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Lc(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],s=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],l=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],E=0,b,R=0;R<p;R++){var w=t.getInt32(),B=t.getInt32();b=(w>>>4^B)&252645135,B^=b,w^=b<<4,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>2^B)&858993459,B^=b,w^=b<<2,b=(B>>>-16^w)&65535,w^=b,B^=b<<-16,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=(B>>>8^w)&16711935,w^=b,B^=b<<8,b=(w>>>1^B)&1431655765,B^=b,w^=b<<1,b=w<<8|B>>>20&240,w=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=b;for(var L=0;L<m.length;++L){m[L]?(w=w<<2|w>>>26,B=B<<2|B>>>26):(w=w<<1|w>>>27,B=B<<1|B>>>27),w&=-15,B&=-15;var N=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|a[w>>>12&15]|o[w>>>8&15]|s[w>>>4&15],z=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|d[B>>>12&15]|x[B>>>8&15]|l[B>>>4&15];b=(z>>>16^N)&65535,y[E++]=N^b,y[E++]=z^b<<16}}return y}function Is(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,s=e[0],f=e[1];o=(s>>>4^f)&252645135,f^=o,s^=o<<4,o=(s>>>16^f)&65535,f^=o,s^=o<<16,o=(f>>>2^s)&858993459,s^=o,f^=o<<2,o=(f>>>8^s)&16711935,s^=o,f^=o<<8,o=(s>>>1^f)&1431655765,f^=o,s^=o<<1,s=s<<1|s>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],d=a[c];d!=u;d+=h){var x=f^t[d],l=(f>>>4|f<<28)^t[d+1];o=s,s=f,f=o^(Sc[x>>>24&63]|Cc[x>>>16&63]|Tc[x>>>8&63]|Rc[x&63]|Bc[l>>>24&63]|Ac[l>>>16&63]|Ic[l>>>8&63]|_c[l&63])}o=s,s=f,f=o}s=s>>>1|s<<31,f=f>>>1|f<<31,o=(s>>>1^f)&1431655765,f^=o,s^=o<<1,o=(f>>>8^s)&16711935,s^=o,f^=o<<8,o=(f>>>2^s)&858993459,s^=o,f^=o<<2,o=(s>>>16^f)&65535,f^=o,s^=o<<16,o=(s>>>4^f)&252645135,f^=o,s^=o<<4,r[0]=s,r[1]=f}function an(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=lt.cipher.createDecipher(r,t.key):n=lt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,o){var s=null;o instanceof lt.util.ByteBuffer&&(s=o,o={}),o=o||{},o.output=s,o.iv=a,i.call(n,o)},n}});var Me=ft(($p,Rs)=>{var sn=it();Rs.exports=sn.md=sn.md||{};sn.md.algorithms=sn.md.algorithms||{}});var Ns=ft((Qp,Ls)=>{var de=it();Me();bt();var Nc=Ls.exports=de.hmac=de.hmac||{};Nc.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,o){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in de.md.algorithms)e=de.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(o===null)o=t;else{if(typeof o=="string")o=de.util.createBuffer(o);else if(de.util.isArray(o)){var s=o;o=de.util.createBuffer();for(var f=0;f<s.length;++f)o.putByte(s[f])}var c=o.length();c>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=de.util.createBuffer(),n=de.util.createBuffer(),c=o.length();for(var f=0;f<c;++f){var s=o.at(f);r.putByte(54^s),n.putByte(92^s)}if(c<e.blockLength)for(var s=e.blockLength-c,f=0;f<s;++f)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var on=ft(()=>{});var Ai=ft((jp,Ds)=>{var Ut=it();Ns();Me();bt();var Dc=Ut.pkcs5=Ut.pkcs5||{},pe;Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&(pe=on());Ds.exports=Ut.pbkdf2=Dc.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Ut.util.isNodejs&&!Ut.options.usePureJavaScript&&pe.pbkdf2&&(i===null||typeof i!="object")&&(pe.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?pe.pbkdf2Sync.length===4?pe.pbkdf2(t,e,r,n,function(b,R){if(b)return a(b);a(null,R.toString("binary"))}):pe.pbkdf2(t,e,r,n,i,function(b,R){if(b)return a(b);a(null,R.toString("binary"))}):pe.pbkdf2Sync.length===4?pe.pbkdf2Sync(t,e,r,n).toString("binary"):pe.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ut.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ut.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var s=new Error("Derived key is too long.");if(a)return a(s);throw s}var f=Math.ceil(n/o),c=n-(f-1)*o,u=Ut.hmac.create();u.start(i,t);var h="",d,x,l;if(!a){for(var p=1;p<=f;++p){u.start(null,null),u.update(e),u.update(Ut.util.int32ToBytes(p)),d=l=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(l),x=u.digest().getBytes(),d=Ut.util.xorBytes(d,x,o),l=x;h+=p<f?d:d.substr(0,c)}return h}var p=1,y;function m(){if(p>f)return a(null,h);u.start(null,null),u.update(e),u.update(Ut.util.int32ToBytes(p)),d=l=u.digest().getBytes(),y=2,E()}function E(){if(y<=r)return u.start(null,null),u.update(l),x=u.digest().getBytes(),d=Ut.util.xorBytes(d,x,o),l=x,++y,Ut.util.setImmediate(E);h+=p<f?d:d.substr(0,c),++p,m()}m()}});var Us=ft((t1,Ps)=>{var cn=it();bt();var ks=Ps.exports=cn.pem=cn.pem||{};ks.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=fn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=fn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=fn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=fn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=cn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};ks.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var o=a[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var s={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:cn.util.decode64(a[3])};if(e.push(s),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var d=f[h];if(!/\s/.test(d[0]))break;u+=d,c=h}if(a=u.match(n),a){for(var x={name:a[1],values:[]},l=a[2].split(","),p=0;p<l.length;++p)x.values.push(kc(l[p]));if(s.procType)if(!s.contentDomain&&x.name==="Content-Domain")s.contentDomain=l[0]||"";else if(!s.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');s.dekInfo={algorithm:l[0],parameters:l[1]||null}}else s.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');s.procType={version:l[0],type:l[1]}}}++c}if(s.procType==="ENCRYPTED"&&!s.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function fn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,o=-1,i=0;i<e.length;++i,++a)if(a>65&&o!==-1){var s=e[o];s===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+s+e.substr(o+1),a=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function kc(t){return t.replace(/^\s+/,"")}});var Fs=ft((e1,qs)=>{var re=it();Me();bt();var Os=qs.exports=re.sha256=re.sha256||{};re.md.sha256=re.md.algorithms.sha256=Os;Os.create=function(){Ms||Pc();var t=null,e=re.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=re.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=re.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var s=n.fullMessageLength.length-1;s>=0;--s)n.fullMessageLength[s]+=o[1],o[1]=o[0]+(n.fullMessageLength[s]/4294967296>>>0),n.fullMessageLength[s]=n.fullMessageLength[s]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Ks(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=re.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=a&n.blockLength-1;i.putBytes(Ci.substr(0,n.blockLength-o));for(var s,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)s=n.fullMessageLength[u+1]*8,f=s/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=s>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ks(h,r,i);var d=re.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d.putInt32(h.h5),d.putInt32(h.h6),d.putInt32(h.h7),d},n};var Ci=null,Ms=!1,Vs=null;function Pc(){Ci="\x80",Ci+=re.util.fillString("\0",64),Vs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ms=!0}function Ks(t,e,r){for(var n,i,a,o,s,f,c,u,h,d,x,l,p,y,m,E=r.length();E>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,d=t.h2,x=t.h3,l=t.h4,p=t.h5,y=t.h6,m=t.h7,c=0;c<64;++c)o=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7),s=y^l&(p^y),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|d&(u^h),n=m+o+s+Vs[c]+e[c],i=a+f,m=y,y=p,p=l,l=x+n>>>0,x=d,d=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+d|0,t.h3=t.h3+x|0,t.h4=t.h4+l|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,E-=64}}});var zs=ft((r1,Hs)=>{var ne=it();bt();var un=null;ne.util.isNodejs&&!ne.options.usePureJavaScript&&!process.versions["node-webkit"]&&(un=on());var Uc=Hs.exports=ne.prng=ne.prng||{};Uc.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,d=e.plugin.increment,x=e.plugin.formatKey,l=e.plugin.formatSeed,p=ne.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(p.length()>=c)return u(null,p.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return ne.util.nextTick(function(){a(y)});var E=h(e.key,e.seed);e.generated+=E.length,p.putBytes(E),e.key=x(h(e.key,d(e.seed))),e.seed=l(h(e.key,e.seed)),ne.util.setImmediate(y)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,d=e.plugin.formatKey,x=e.plugin.formatSeed;e.key=null;for(var l=ne.util.createBuffer();l.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&o();var p=u(e.key,e.seed);e.generated+=p.length,l.putBytes(p),e.key=d(u(e.key,h(e.seed))),e.seed=x(u(e.key,e.seed))}return l.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return s(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,d){if(h)return c(h);e.collect(d),s(),c()})}function o(){if(e.pools[0].messageLength>=32)return s();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),s()}function s(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var d=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function f(c){var u=null,h=ne.util.globalScope,d=h.crypto||h.msCrypto;d&&d.getRandomValues&&(u=function(w){return d.getRandomValues(w)});var x=ne.util.createBuffer();if(u)for(;x.length()<c;){var l=Math.max(1,Math.min(c-x.length(),65536)/4),p=new Uint32Array(Math.floor(l));try{u(p);for(var y=0;y<p.length;++y)x.putInt32(p[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(x.length()<c)for(var m,E,b,R=Math.floor(Math.random()*65536);x.length()<c;){E=16807*(R&65535),m=16807*(R>>16),E+=(m&32767)<<16,E+=m>>15,E=(E&2147483647)+(E>>31),R=E&4294967295;for(var y=0;y<3;++y)b=R>>>(y<<3),b^=Math.floor(Math.random()*256),x.putByte(b&255)}return x.getBytes(c)}return un?(e.seedFile=function(c,u){un.randomBytes(c,function(h,d){if(h)return u(h);u(null,d.toString())})},e.seedFileSync=function(c){return un.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",d=0;d<u;d+=8)h+=String.fromCharCode(c>>d&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,d){function x(l){var p=l.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",x),d(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var d=h.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(x,l){c.postMessage({forge:{prng:{err:x,bytes:l}}})})};c.addEventListener("message",u)}},e}});var Lr=ft((n1,Ii)=>{var Tt=it();Xr();Fs();zs();bt();(function(){if(Tt.random&&Tt.random.getBytes){Ii.exports=Tt.random;return}(function(t){var e={},r=new Array(4),n=Tt.util.createBuffer();e.formatKey=function(h){var d=Tt.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),Tt.aes._expandKey(h,!1)},e.formatSeed=function(h){var d=Tt.util.createBuffer(h);return h=new Array(4),h[0]=d.getInt32(),h[1]=d.getInt32(),h[2]=d.getInt32(),h[3]=d.getInt32(),h},e.cipher=function(h,d){return Tt.aes._updateBlock(h,d,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Tt.md.sha256;function i(){var h=Tt.prng.create(e);return h.getBytes=function(d,x){return h.generate(d,x)},h.getBytesSync=function(d){return h.generate(d)},h}var a=i(),o=null,s=Tt.util.globalScope,f=s.crypto||s.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),Tt.options.usePureJavaScript||!Tt.util.isNodejs&&!o){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!Tt.random)Tt.random=a;else for(var u in a)Tt.random[u]=a[u];Tt.random.createInstance=i,Ii.exports=Tt.random})(typeof jQuery<"u"?jQuery:null)})()});var Zs=ft((i1,Ys)=>{var Kt=it();bt();var Ti=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Gs=[1,2,3,5],Kc=function(t,e){return t<<e&65535|(t&65535)>>16-e},Oc=function(t,e){return(t&65535)>>e|t<<16-e&65535};Ys.exports=Kt.rc2=Kt.rc2||{};Kt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Kt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),o=255>>(i&7),s;for(s=n;s<128;s++)r.putByte(Ti[r.at(s-1)+r.at(s-n)&255]);for(r.setAt(128-a,Ti[r.at(128-a)&o]),s=127-a;s>=0;s--)r.setAt(s,Ti[r.at(s+1)^r.at(s+a)]);return r};var Ws=function(t,e,r){var n=!1,i=null,a=null,o=null,s,f,c,u,h=[];for(t=Kt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(s=function(l){for(c=0;c<4;c++)l[c]+=h[u]+(l[(c+3)%4]&l[(c+2)%4])+(~l[(c+3)%4]&l[(c+1)%4]),l[c]=Kc(l[c],Gs[c]),u++},f=function(l){for(c=0;c<4;c++)l[c]+=h[l[(c+3)%4]&63]}):(s=function(l){for(c=3;c>=0;c--)l[c]=Oc(l[c],Gs[c]),l[c]-=h[u]+(l[(c+3)%4]&l[(c+2)%4])+(~l[(c+3)%4]&l[(c+1)%4]),u--},f=function(l){for(c=3;c>=0;c--)l[c]-=h[l[(c+3)%4]&63]});var d=function(l){var p=[];for(c=0;c<4;c++){var y=i.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var m=0;m<l.length;m++)for(var E=0;E<l[m][0];E++)l[m][1](p);for(c=0;c<4;c++)o!==null&&(r?o.putInt16Le(p[c]):p[c]^=o.getInt16Le()),a.putInt16Le(p[c])},x=null;return x={start:function(l,p){l&&typeof l=="string"&&(l=Kt.util.createBuffer(l)),n=!1,i=Kt.util.createBuffer(),a=p||new Kt.util.createBuffer,o=l,x.output=a},update:function(l){for(n||i.putBuffer(l);i.length()>=8;)d([[5,s],[1,f],[6,s],[1,f],[5,s]])},finish:function(l){var p=!0;if(r)if(l)p=l(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,x.update()),!r&&(p=i.length()===0,p))if(l)p=l(8,a,!r);else{var m=a.length(),E=a.at(m-1);E>m?p=!1:a.truncate(E)}return p}},x};Kt.rc2.startEncrypting=function(t,e,r){var n=Kt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createEncryptionCipher=function(t,e){return Ws(t,e,!0)};Kt.rc2.startDecrypting=function(t,e,r){var n=Kt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createDecryptionCipher=function(t,e){return Ws(t,e,!1)}});var dn=ft((a1,ro)=>{var _i=it();ro.exports=_i.jsbn=_i.jsbn||{};var ye,Mc=0xdeadbeefcafe,$s=(Mc&16777215)==15715070;function C(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}_i.jsbn.BigInteger=C;function tt(){return new C(null)}function Vc(t,e,r,n,i,a){for(;--a>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function qc(t,e,r,n,i,a){for(var o=e&32767,s=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=s*f+c*o;f=o*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+s*c+(i>>>30),r.data[n++]=f&1073741823}return i}function Qs(t,e,r,n,i,a){for(var o=e&16383,s=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=s*f+c*o;f=o*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+s*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(C.prototype.am=Qs,ye=28):$s&&navigator.appName=="Microsoft Internet Explorer"?(C.prototype.am=qc,ye=30):$s&&navigator.appName!="Netscape"?(C.prototype.am=Vc,ye=26):(C.prototype.am=Qs,ye=28);C.prototype.DB=ye;C.prototype.DM=(1<<ye)-1;C.prototype.DV=1<<ye;var Ri=52;C.prototype.FV=Math.pow(2,Ri);C.prototype.F1=Ri-ye;C.prototype.F2=2*ye-Ri;var Fc="0123456789abcdefghijklmnopqrstuvwxyz",hn=new Array,sr,Ht;sr=48;for(Ht=0;Ht<=9;++Ht)hn[sr++]=Ht;sr=97;for(Ht=10;Ht<36;++Ht)hn[sr++]=Ht;sr=65;for(Ht=10;Ht<36;++Ht)hn[sr++]=Ht;function Xs(t){return Fc.charAt(t)}function Js(t,e){var r=hn[t.charCodeAt(e)];return r??-1}function Hc(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function zc(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Ie(t){var e=tt();return e.fromInt(t),e}function Gc(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var o=r==8?t[n]&255:Js(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=o:a+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this.data[this.t++]=o>>this.DB-a):this.data[this.t-1]|=o<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&C.ZERO.subTo(this,this)}function Wc(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Yc(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",o=this.t,s=this.DB-o*this.DB%e;if(o-- >0)for(s<this.DB&&(n=this.data[o]>>s)>0&&(i=!0,a=Xs(n));o>=0;)s<e?(n=(this.data[o]&(1<<s)-1)<<e-s,n|=this.data[--o]>>(s+=this.DB-e)):(n=this.data[o]>>(s-=e)&r,s<=0&&(s+=this.DB,--o)),n>0&&(i=!0),i&&(a+=Xs(n));return i?a:"0"}function Zc(){var t=tt();return C.ZERO.subTo(this,t),t}function $c(){return this.s<0?this.negate():this}function Qc(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function ln(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Xc(){return this.t<=0?0:this.DB*(this.t-1)+ln(this.data[this.t-1]^this.s&this.DM)}function Jc(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function jc(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function tu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),o=this.s<<r&this.DM,s;for(s=this.t-1;s>=0;--s)e.data[s+a+1]=this.data[s]>>n|o,o=(this.data[s]&i)<<r;for(s=a-1;s>=0;--s)e.data[s]=0;e.data[a]=o,e.t=this.t+a+1,e.s=this.s,e.clamp()}function eu(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&a)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function ru(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function nu(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&C.ZERO.subTo(e,e)}function iu(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function au(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=tt());var a=tt(),o=this.s,s=t.s,f=this.DB-ln(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),d=this.FV/h,x=(1<<this.F1)/h,l=1<<this.F2,p=r.t,y=p-c,m=e??tt();for(a.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),C.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--y>=0;){var E=r.data[--p]==u?this.DM:Math.floor(r.data[p]*d+(r.data[p-1]+l)*x);if((r.data[p]+=a.am(0,E,r,y,0,c))<E)for(a.dlShiftTo(y,m),r.subTo(m,r);r.data[p]<--E;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),o!=s&&C.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&C.ZERO.subTo(r,r)}}}function su(t){var e=tt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(C.ZERO)>0&&t.subTo(e,e),e}function Ve(t){this.m=t}function ou(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function fu(t){return t}function cu(t){t.divRemTo(this.m,null,t)}function uu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function hu(t,e){t.squareTo(e),this.reduce(e)}Ve.prototype.convert=ou;Ve.prototype.revert=fu;Ve.prototype.reduce=cu;Ve.prototype.mulTo=uu;Ve.prototype.sqrTo=hu;function lu(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function qe(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function du(t){var e=tt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(C.ZERO)>0&&this.m.subTo(e,e),e}function pu(t){var e=tt();return t.copyTo(e),this.reduce(e),e}function yu(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function xu(t,e){t.squareTo(e),this.reduce(e)}function gu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}qe.prototype.convert=du;qe.prototype.revert=pu;qe.prototype.reduce=yu;qe.prototype.mulTo=gu;qe.prototype.sqrTo=xu;function mu(){return(this.t>0?this.data[0]&1:this.s)==0}function vu(t,e){if(t>4294967295||t<1)return C.ONE;var r=tt(),n=tt(),i=e.convert(this),a=ln(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function bu(t,e){var r;return t<256||e.isEven()?r=new Ve(e):r=new qe(e),this.exp(t,r)}C.prototype.copyTo=Hc;C.prototype.fromInt=zc;C.prototype.fromString=Gc;C.prototype.clamp=Wc;C.prototype.dlShiftTo=Jc;C.prototype.drShiftTo=jc;C.prototype.lShiftTo=tu;C.prototype.rShiftTo=eu;C.prototype.subTo=ru;C.prototype.multiplyTo=nu;C.prototype.squareTo=iu;C.prototype.divRemTo=au;C.prototype.invDigit=lu;C.prototype.isEven=mu;C.prototype.exp=vu;C.prototype.toString=Yc;C.prototype.negate=Zc;C.prototype.abs=$c;C.prototype.compareTo=Qc;C.prototype.bitLength=Xc;C.prototype.mod=su;C.prototype.modPowInt=bu;C.ZERO=Ie(0);C.ONE=Ie(1);function Eu(){var t=tt();return this.copyTo(t),t}function wu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Bu(){return this.t==0?this.s:this.data[0]<<24>>24}function Su(){return this.t==0?this.s:this.data[0]<<16>>16}function Au(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Cu(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Iu(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ie(r),i=tt(),a=tt(),o="";for(this.divRemTo(n,i,a);i.signum()>0;)o=(r+a.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,a);return a.intValue().toString(t)+o}function Tu(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,o=0,s=0;s<t.length;++s){var f=Js(t,s);if(f<0){t.charAt(s)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(o,0),a=0,o=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(o,0)),i&&C.ZERO.subTo(this,this)}function _u(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(C.ONE.shiftLeft(t-1),Li,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(C.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Ru(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Lu(t){return this.compareTo(t)==0}function Nu(t){return this.compareTo(t)<0?this:t}function Du(t){return this.compareTo(t)>0?this:t}function ku(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Pu(t,e){return t&e}function Uu(t){var e=tt();return this.bitwiseTo(t,Pu,e),e}function Li(t,e){return t|e}function Ku(t){var e=tt();return this.bitwiseTo(t,Li,e),e}function js(t,e){return t^e}function Ou(t){var e=tt();return this.bitwiseTo(t,js,e),e}function to(t,e){return t&~e}function Mu(t){var e=tt();return this.bitwiseTo(t,to,e),e}function Vu(){for(var t=tt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function qu(t){var e=tt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Fu(t){var e=tt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Hu(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function zu(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Hu(this.data[t]);return this.s<0?this.t*this.DB:-1}function Gu(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Wu(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Gu(this.data[r]^e);return t}function Yu(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Zu(t,e){var r=C.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function $u(t){return this.changeBit(t,Li)}function Qu(t){return this.changeBit(t,to)}function Xu(t){return this.changeBit(t,js)}function Ju(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function ju(t){var e=tt();return this.addTo(t,e),e}function th(t){var e=tt();return this.subTo(t,e),e}function eh(t){var e=tt();return this.multiplyTo(t,e),e}function rh(t){var e=tt();return this.divRemTo(t,e,null),e}function nh(t){var e=tt();return this.divRemTo(t,null,e),e}function ih(t){var e=tt(),r=tt();return this.divRemTo(t,e,r),new Array(e,r)}function ah(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function sh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Nr(){}function eo(t){return t}function oh(t,e,r){t.multiplyTo(e,r)}function fh(t,e){t.squareTo(e)}Nr.prototype.convert=eo;Nr.prototype.revert=eo;Nr.prototype.mulTo=oh;Nr.prototype.sqrTo=fh;function ch(t){return this.exp(t,new Nr)}function uh(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function hh(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function or(t){this.r2=tt(),this.q3=tt(),C.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function lh(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=tt();return t.copyTo(e),this.reduce(e),e}function dh(t){return t}function ph(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function yh(t,e){t.squareTo(e),this.reduce(e)}function xh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}or.prototype.convert=lh;or.prototype.revert=dh;or.prototype.reduce=ph;or.prototype.mulTo=xh;or.prototype.sqrTo=yh;function gh(t,e){var r=t.bitLength(),n,i=Ie(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Ve(e):e.isEven()?a=new or(e):a=new qe(e);var o=new Array,s=3,f=n-1,c=(1<<n)-1;if(o[1]=a.convert(this),n>1){var u=tt();for(a.sqrTo(o[1],u);s<=c;)o[s]=tt(),a.mulTo(u,o[s-2],o[s]),s+=2}var h=t.t-1,d,x=!0,l=tt(),p;for(r=ln(t.data[h])-1;h>=0;){for(r>=f?d=t.data[h]>>r-f&c:(d=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(d|=t.data[h-1]>>this.DB+r-f)),s=n;!(d&1);)d>>=1,--s;if((r-=s)<0&&(r+=this.DB,--h),x)o[d].copyTo(i),x=!1;else{for(;s>1;)a.sqrTo(i,l),a.sqrTo(l,i),s-=2;s>0?a.sqrTo(i,l):(p=i,i=l,l=p),a.mulTo(l,o[d],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,l),p=i,i=l,l=p,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function mh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function vh(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function bh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return C.ZERO;for(var r=t.clone(),n=this.clone(),i=Ie(1),a=Ie(0),o=Ie(0),s=Ie(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),a.subTo(s,a)):(n.subTo(r,n),e&&o.subTo(i,o),s.subTo(a,s))}if(n.compareTo(C.ONE)!=0)return C.ZERO;if(s.compareTo(t)>=0)return s.subtract(t);if(s.signum()<0)s.addTo(t,s);else return s;return s.signum()<0?s.add(t):s}var Yt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Eh=(1<<26)/Yt[Yt.length-1];function wh(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Yt[Yt.length-1]){for(e=0;e<Yt.length;++e)if(r.data[0]==Yt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Yt.length;){for(var n=Yt[e],i=e+1;i<Yt.length&&n<Eh;)n*=Yt[i++];for(n=r.modInt(n);e<i;)if(n%Yt[e++]==0)return!1}return r.millerRabin(t)}function Bh(t){var e=this.subtract(C.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Sh(),a,o=0;o<t;++o){do a=new C(this.bitLength(),i);while(a.compareTo(C.ONE)<=0||a.compareTo(e)>=0);var s=a.modPow(n,this);if(s.compareTo(C.ONE)!=0&&s.compareTo(e)!=0){for(var f=1;f++<r&&s.compareTo(e)!=0;)if(s=s.modPowInt(2,this),s.compareTo(C.ONE)==0)return!1;if(s.compareTo(e)!=0)return!1}}return!0}function Sh(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}C.prototype.chunkSize=Au;C.prototype.toRadix=Iu;C.prototype.fromRadix=Tu;C.prototype.fromNumber=_u;C.prototype.bitwiseTo=ku;C.prototype.changeBit=Zu;C.prototype.addTo=Ju;C.prototype.dMultiply=ah;C.prototype.dAddOffset=sh;C.prototype.multiplyLowerTo=uh;C.prototype.multiplyUpperTo=hh;C.prototype.modInt=vh;C.prototype.millerRabin=Bh;C.prototype.clone=Eu;C.prototype.intValue=wu;C.prototype.byteValue=Bu;C.prototype.shortValue=Su;C.prototype.signum=Cu;C.prototype.toByteArray=Ru;C.prototype.equals=Lu;C.prototype.min=Nu;C.prototype.max=Du;C.prototype.and=Uu;C.prototype.or=Ku;C.prototype.xor=Ou;C.prototype.andNot=Mu;C.prototype.not=Vu;C.prototype.shiftLeft=qu;C.prototype.shiftRight=Fu;C.prototype.getLowestSetBit=zu;C.prototype.bitCount=Wu;C.prototype.testBit=Yu;C.prototype.setBit=$u;C.prototype.clearBit=Qu;C.prototype.flipBit=Xu;C.prototype.add=ju;C.prototype.subtract=th;C.prototype.multiply=eh;C.prototype.divide=rh;C.prototype.remainder=nh;C.prototype.divideAndRemainder=ih;C.prototype.modPow=gh;C.prototype.modInverse=bh;C.prototype.pow=ch;C.prototype.gcd=mh;C.prototype.isProbablePrime=wh});var oo=ft((s1,so)=>{var ie=it();Me();bt();var io=so.exports=ie.sha1=ie.sha1||{};ie.md.sha1=ie.md.algorithms.sha1=io;io.create=function(){ao||Ah();var t=null,e=ie.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=ie.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=ie.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var s=n.fullMessageLength.length-1;s>=0;--s)n.fullMessageLength[s]+=o[1],o[1]=o[0]+(n.fullMessageLength[s]/4294967296>>>0),n.fullMessageLength[s]=n.fullMessageLength[s]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),no(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ie.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=a&n.blockLength-1;i.putBytes(Ni.substr(0,n.blockLength-o));for(var s,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)s=n.fullMessageLength[u+1]*8,f=s/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=s>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};no(h,r,i);var d=ie.util.createBuffer();return d.putInt32(h.h0),d.putInt32(h.h1),d.putInt32(h.h2),d.putInt32(h.h3),d.putInt32(h.h4),d},n};var Ni=null,ao=!1;function Ah(){Ni="\x80",Ni+=ie.util.fillString("\0",64),ao=!0}function no(t,e,r){for(var n,i,a,o,s,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,o=t.h2,s=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=s^a&(o^s),n=(i<<5|i>>>27)+c+f+1518500249+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=s^a&(o^s),n=(i<<5|i>>>27)+c+f+1518500249+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o^s,n=(i<<5|i>>>27)+c+f+1859775393+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^o^s,n=(i<<5|i>>>27)+c+f+1859775393+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&o|s&(a^o),n=(i<<5|i>>>27)+c+f+2400959708+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^o^s,n=(i<<5|i>>>27)+c+f+3395469782+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+o|0,t.h3=t.h3+s|0,t.h4=t.h4+f|0,h-=64}}});var uo=ft((o1,co)=>{var ae=it();bt();Lr();oo();var fo=co.exports=ae.pkcs1=ae.pkcs1||{};fo.encode_rsa_oaep=function(t,e,r){var n,i,a,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),a?a.start():a=ae.md.sha1.create(),o||(o=a);var s=Math.ceil(t.n.bitLength()/8),f=s-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",d=f-e.length,x=0;x<d;x++)h+="\0";var l=u.getBytes()+h+""+e;if(!i)i=ae.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var p=pn(i,s-a.digestLength-1,o),y=ae.util.xorBytes(l,p,l.length),m=pn(y,a.digestLength,o),E=ae.util.xorBytes(i,m,i.length);return"\0"+E+y};fo.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=o,y}if(i===void 0?i=ae.md.sha1.create():i.start(),a||(a=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var s=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=pn(u,i.digestLength,a),d=ae.util.xorBytes(c,h,c.length),x=pn(d,o-i.digestLength-1,a),l=ae.util.xorBytes(u,x,u.length),p=l.substring(0,i.digestLength),y=f!=="\0",m=0;m<i.digestLength;++m)y|=s.charAt(m)!==p.charAt(m);for(var E=1,b=i.digestLength,R=i.digestLength;R<l.length;R++){var w=l.charCodeAt(R),B=w&1^1,L=E?65534:0;y|=w&L,E=E&B,b+=E}if(y||l.charCodeAt(b)!==1)throw new Error("Invalid RSAES-OAEP padding.");return l.substring(b+1)};function pn(t,e,r){r||(r=ae.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var o=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var ho=ft((f1,Di)=>{var Te=it();bt();dn();Lr();(function(){if(Te.prime){Di.exports=Te.prime;return}var t=Di.exports=Te.prime=Te.prime||{},e=Te.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,d){return h|d};t.generateProbablePrime=function(h,d,x){typeof d=="function"&&(x=d,d={}),d=d||{};var l=d.algorithm||"PRIMEINC";typeof l=="string"&&(l={name:l}),l.options=l.options||{};var p=d.prng||Te.random,y={nextBytes:function(m){for(var E=p.getBytesSync(m.length),b=0;b<m.length;++b)m[b]=E.charCodeAt(b)}};if(l.name==="PRIMEINC")return a(h,y,l.options,x);throw new Error("Invalid prime generation algorithm: "+l.name)};function a(h,d,x,l){return"workers"in x?f(h,d,x,l):o(h,d,x,l)}function o(h,d,x,l){var p=c(h,d),y=0,m=u(p.bitLength());"millerRabinTests"in x&&(m=x.millerRabinTests);var E=10;"maxBlockTime"in x&&(E=x.maxBlockTime),s(p,h,d,y,m,E,l)}function s(h,d,x,l,p,y,m){var E=+new Date;do{if(h.bitLength()>d&&(h=c(d,x)),h.isProbablePrime(p))return m(null,h);h.dAddOffset(r[l++%8],0)}while(y<0||+new Date-E<y);Te.util.setImmediate(function(){s(h,d,x,l,p,y,m)})}function f(h,d,x,l){if(typeof Worker>"u")return o(h,d,x,l);var p=c(h,d),y=x.workers,m=x.workLoad||100,E=m*30/8,b=x.workerScript||"forge/prime.worker.js";if(y===-1)return Te.util.estimateCores(function(w,B){w&&(B=2),y=B-1,R()});R();function R(){y=Math.max(1,y);for(var w=[],B=0;B<y;++B)w[B]=new Worker(b);for(var L=y,B=0;B<y;++B)w[B].addEventListener("message",z);var N=!1;function z(H){if(!N){--L;var V=H.data;if(V.found){for(var Q=0;Q<w.length;++Q)w[Q].terminate();return N=!0,l(null,new e(V.prime,16))}p.bitLength()>h&&(p=c(h,d));var at=p.toString(16);H.target.postMessage({hex:at,workLoad:m}),p.dAddOffset(E,0)}}}}function c(h,d){var x=new e(h,d),l=h-1;return x.testBit(l)||x.bitwiseTo(e.ONE.shiftLeft(l),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var xn=ft((c1,vo)=>{var M=it();Rr();dn();rn();uo();ho();Lr();bt();typeof j>"u"&&(j=M.jsbn.BigInteger);var j,ki=M.util.isNodejs?on():null,v=M.asn1,zt=M.util;M.pki=M.pki||{};vo.exports=M.pki.rsa=M.rsa=M.rsa||{};var G=M.pki,Ch=[6,4,2,4,2,4,6,2],Ih={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Th={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},_h={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Rh=M.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Lh={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Nh=function(t){var e;if(t.algorithm in G.oids)e=G.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=v.oidToDer(e).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),a=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);a.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),a.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var o=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(o),v.toDer(i).getBytes()},go=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(j.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(j.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new j(M.util.bytesToHex(M.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(j.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var o=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};G.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=mo(t,e,r)):(i=M.util.createBuffer(),i.putBytes(t));for(var o=new j(i.toHex(),16),s=go(o,e,n),f=s.toString(16),c=M.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),c.getBytes()};G.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var o=new j(M.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var s=go(o,e,r),f=s.toString(16),c=M.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),n!==!1?yn(c.getBytes(),e,r):c.getBytes()};G.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||M.random,i={nextBytes:function(s){for(var f=n.getBytesSync(s.length),c=0;c<s.length;++c)s[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",o;if(a==="PRIMEINC")o={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new j(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+a);return o};G.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,d){return h|d},a=+new Date,o,s=0;t.keys===null&&(e<=0||s<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new j(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(j.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(kh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Ch[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(j.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)}}o=+new Date,s+=o-a,a=o}return t.keys!==null};G.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!M.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(lo("generateKeyPair"))return ki.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(s,f,c){if(s)return n(s);n(null,{privateKey:G.privateKeyFromPem(c),publicKey:G.publicKeyFromPem(f)})});if(po("generateKey")&&po("exportKey"))return zt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:xo(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(s){return zt.globalScope.crypto.subtle.exportKey("pkcs8",s.privateKey)}).then(void 0,function(s){n(s)}).then(function(s){if(s){var f=G.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(s)));n(null,{privateKey:f,publicKey:G.setRsaPublicKey(f.n,f.e)})}});if(yo("generateKey")&&yo("exportKey")){var i=zt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:xo(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(s){var f=s.target.result,c=zt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,d=G.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(h)));n(null,{privateKey:d,publicKey:G.setRsaPublicKey(d.n,d.e)})},c.onerror=function(u){n(u)}},i.onerror=function(s){n(s)};return}}else if(lo("generateKeyPairSync")){var a=ki.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:G.privateKeyFromPem(a.privateKey),publicKey:G.publicKeyFromPem(a.publicKey)}}}var o=G.rsa.createKeyPairGenerationState(t,e,r);if(!n)return G.rsa.stepKeyPairGenerationState(o,0),o.keys;Dh(o,r,n)};G.setRsaPublicKey=G.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(s,f,c){return mo(s,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(s,f){return M.pkcs1.encode_rsa_oaep(f,s,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(s){return s}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return G.rsa.encrypt(o,r,!0)},r.verify=function(n,i,a,o){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=yn(c,r,!0);var u=v.fromDer(c,{parseAllBytes:o._parseAllDigestBytes}),h={},d=[];if(!v.validate(u,Lh,h,d)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=d,x}var l=v.derToOid(h.algorithmIdentifier);if(!(l===M.oids.md2||l===M.oids.md5||l===M.oids.sha1||l===M.oids.sha224||l===M.oids.sha256||l===M.oids.sha384||l===M.oids.sha512||l===M.oids["sha512-224"]||l===M.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=l,x}if((l===M.oids.md2||l===M.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=yn(c,r,!0),f===c}});var s=G.rsa.decrypt(i,r,!0,!1);return a.verify(n,s,r.n.bitLength())},r};G.setRsaPrivateKey=G.rsa.setPrivateKey=function(t,e,r,n,i,a,o,s){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:o,qInv:s};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var d=G.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:yn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,l){return M.pkcs1.decode_rsa_oaep(l,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(d,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Nh},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var d=u.encode(c,f.n.bitLength());return G.rsa.encrypt(d,f,h)},f};G.wrapRsaPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(t).getBytes())])};G.privateKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Ih,e,r)&&(t=v.fromDer(M.util.createBuffer(e.privateKey))),e={},r=[],!v.validate(t,Th,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,o,s,f,c,u,h;return i=M.util.createBuffer(e.privateKeyModulus).toHex(),a=M.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=M.util.createBuffer(e.privateKeyPrivateExponent).toHex(),s=M.util.createBuffer(e.privateKeyPrime1).toHex(),f=M.util.createBuffer(e.privateKeyPrime2).toHex(),c=M.util.createBuffer(e.privateKeyExponent1).toHex(),u=M.util.createBuffer(e.privateKeyExponent2).toHex(),h=M.util.createBuffer(e.privateKeyCoefficient).toHex(),G.setRsaPrivateKey(new j(i,16),new j(a,16),new j(o,16),new j(s,16),new j(f,16),new j(c,16),new j(u,16),new j(h,16))};G.privateKeyToAsn1=G.privateKeyToRSAPrivateKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.qInv))])};G.publicKeyFromAsn1=function(t){var e={},r=[];if(v.validate(t,Rh,e,r)){var n=v.derToOid(e.publicKeyOid);if(n!==G.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!v.validate(t,_h,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=M.util.createBuffer(e.publicKeyModulus).toHex(),o=M.util.createBuffer(e.publicKeyExponent).toHex();return G.setRsaPublicKey(new j(a,16),new j(o,16))};G.publicKeyToAsn1=G.publicKeyToSubjectPublicKeyInfo=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(G.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[G.publicKeyToRSAPublicKey(t)])])};G.publicKeyToRSAPublicKey=function(t){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,se(t.e))])};function mo(t,e,r){var n=M.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var o=i-3-t.length,s;if(r===0||r===1){s=r===0?0:255;for(var f=0;f<o;++f)n.putByte(s)}else for(;o>0;){for(var c=0,u=M.random.getBytes(o),f=0;f<o;++f)s=u.charCodeAt(f),s===0?++c:n.putByte(s);o=c}return n.putByte(0),n.putBytes(t),n}function yn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=M.util.createBuffer(t),o=a.getByte(),s=a.getByte();if(o!==0||r&&s!==0&&s!==1||!r&&s!=2||r&&s===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(s===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(s===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(s===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Dh(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(s,f){if(s)return r(s);if(t.p=f,t.q!==null)return o(s,t.q);a(t.qBits,o)})}function a(s,f){M.prime.generateProbablePrime(s,n,f)}function o(s,f){if(s)return r(s);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.p=null,i();return}if(t.q.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.q=null,a(t.qBits,o);return}if(t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(j.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,o);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:G.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:G.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function se(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=M.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function kh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function lo(t){return M.util.isNodejs&&typeof ki[t]=="function"}function po(t){return typeof zt.globalScope<"u"&&typeof zt.globalScope.crypto=="object"&&typeof zt.globalScope.crypto.subtle=="object"&&typeof zt.globalScope.crypto.subtle[t]=="function"}function yo(t){return typeof zt.globalScope<"u"&&typeof zt.globalScope.msCrypto=="object"&&typeof zt.globalScope.msCrypto.subtle=="object"&&typeof zt.globalScope.msCrypto.subtle[t]=="function"}function xo(t){for(var e=M.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Ao=ft((u1,So)=>{var U=it();Xr();Rr();_s();Me();rn();Ai();Us();Lr();Zs();xn();bt();typeof bo>"u"&&(bo=U.jsbn.BigInteger);var bo,S=U.asn1,W=U.pki=U.pki||{};So.exports=W.pbe=U.pbe=U.pbe||{};var Fe=W.oids,Ph={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Uh={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Kh={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=U.random.getBytesSync(r.saltSize),i=r.count,a=S.integerToDer(i),o,s,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":o=16,c=16,u=Fe["aes128-CBC"],h=U.aes.createEncryptionCipher;break;case"aes192":o=24,c=16,u=Fe["aes192-CBC"],h=U.aes.createEncryptionCipher;break;case"aes256":o=32,c=16,u=Fe["aes256-CBC"],h=U.aes.createEncryptionCipher;break;case"des":o=8,c=8,u=Fe.desCBC,h=U.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),l=Bo(x),p=U.pkcs5.pbkdf2(e,n,i,o,l),y=U.random.getBytesSync(c),m=h(p);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes();var E=Oh(n,a,o,x);s=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Fe.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Fe.pkcs5PBKDF2).getBytes()),E]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(u).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var b=new U.util.ByteBuffer(n),p=W.pbe.generatePkcs12Key(e,b,1,i,o),y=W.pbe.generatePkcs12Key(e,b,2,i,o),m=U.des.createEncryptionCipher(p);m.start(y),m.update(S.toDer(t)),m.finish(),f=m.output.getBytes(),s=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Fe["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,n),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,a.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var R=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[s,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,f)]);return R};W.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!S.validate(t,Ph,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var o=S.derToOid(n.encryptionOid),s=W.pbe.getCipher(o,n.encryptionParams,e),f=U.util.createBuffer(n.encryptedData);return s.update(f),s.finish()&&(r=S.fromDer(s.output)),r};W.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(t).getBytes()};return U.pem.encode(r,{maxline:e})};W.encryptedPrivateKeyFromPem=function(t){var e=U.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer(e.body)};W.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(t));return n=W.encryptPrivateKeyInfo(n,e,r),W.encryptedPrivateKeyToPem(n)}var i,a,o,s;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,a=U.random.getBytesSync(16),s=U.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,a=U.random.getBytesSync(16),s=U.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,a=U.random.getBytesSync(16),s=U.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,a=U.random.getBytesSync(8),s=U.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,a=U.random.getBytesSync(8),s=U.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=U.pbe.opensslDeriveBytes(e,a.substr(0,8),o),u=s(c);u.start(a),u.update(S.toDer(W.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:U.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return U.pem.encode(h)};W.decryptRsaPrivateKey=function(t,e){var r=null,n=U.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,o;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,o=U.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,o=U.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,o=U.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,o=U.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,o=U.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,o=function(h){return U.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,o=function(h){return U.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,o=function(h){return U.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var s=U.util.hexToBytes(n.dekInfo.parameters),f=U.pbe.opensslDeriveBytes(e,s.substr(0,8),a),c=o(f);if(c.start(s),c.update(U.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(S.fromDer(r),e):r=S.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var o,s;if(typeof a>"u"||a===null){if(!("sha1"in U.md))throw new Error('"sha1" hash algorithm unavailable.');a=U.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new U.util.ByteBuffer,h=new U.util.ByteBuffer;if(t!=null){for(s=0;s<t.length;s++)h.putInt16(t.charCodeAt(s));h.putInt16(0)}var d=h.length(),x=e.length(),l=new U.util.ByteBuffer;l.fillWithByte(r,c);var p=c*Math.ceil(x/c),y=new U.util.ByteBuffer;for(s=0;s<p;s++)y.putByte(e.at(s%x));var m=c*Math.ceil(d/c),E=new U.util.ByteBuffer;for(s=0;s<m;s++)E.putByte(h.at(s%d));var b=y;b.putBuffer(E);for(var R=Math.ceil(i/f),w=1;w<=R;w++){var B=new U.util.ByteBuffer;B.putBytes(l.bytes()),B.putBytes(b.bytes());for(var L=0;L<n;L++)a.start(),a.update(B.getBytes()),B=a.digest();var N=new U.util.ByteBuffer;for(s=0;s<c;s++)N.putByte(B.at(s%f));var z=Math.ceil(x/c)+Math.ceil(d/c),H=new U.util.ByteBuffer;for(o=0;o<z;o++){var V=new U.util.ByteBuffer(b.getBytes(c)),Q=511;for(s=N.length()-1;s>=0;s--)Q=Q>>8,Q+=N.at(s)+V.at(s),V.setAt(s,Q&255);H.putBuffer(V)}b=H,u.putBuffer(B)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(t,e,r){switch(t){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(t,e,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!S.validate(e,Uh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=S.derToOid(n.kdfOid),t!==W.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=S.derToOid(n.encOid),t!==W.oids["aes128-CBC"]&&t!==W.oids["aes192-CBC"]&&t!==W.oids["aes256-CBC"]&&t!==W.oids["des-EDE3-CBC"]&&t!==W.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var o=n.kdfSalt,s=U.util.createBuffer(n.kdfIterationCount);s=s.getInt(s.length()<<3);var f,c;switch(W.oids[t]){case"aes128-CBC":f=16,c=U.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=U.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=U.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=U.des.createDecryptionCipher;break;case"desCBC":f=8,c=U.des.createDecryptionCipher;break}var u=wo(n.prfOid),h=U.pkcs5.pbkdf2(r,o,s,f,u),d=n.encIv,x=c(h);return x.start(d),x};W.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!S.validate(e,Kh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var o=U.util.createBuffer(n.salt),s=U.util.createBuffer(n.iterations);s=s.getInt(s.length()<<3);var f,c,u;switch(t){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=U.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(p,y){var m=U.rc2.createDecryptionCipher(p,40);return m.start(y,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=wo(n.prfOid),d=W.pbe.generatePkcs12Key(r,o,1,s,f,h);h.start();var x=W.pbe.generatePkcs12Key(r,o,2,s,c,h);return u(d,x)};W.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in U.md))throw new Error('"md5" hash algorithm unavailable.');n=U.md.md5.create()}e===null&&(e="");for(var i=[Eo(n,t+e)],a=16,o=1;a<r;++o,a+=16)i.push(Eo(n,i[o-1]+t+e));return i.join("").substr(0,r)};function Eo(t,e){return t.start().update(e).digest().getBytes()}function wo(t){var e;if(!t)e="hmacWithSHA1";else if(e=W.oids[S.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Bo(e)}function Bo(t){var e=U.md;switch(t){case"hmacWithSHA224":e=U.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Oh(t,e,r,n){var i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,U.util.hexToBytes(r.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(W.oids[n]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])),i}});var g0=ft((c2,x0)=>{var ht=it();Me();bt();var Vr=x0.exports=ht.sha512=ht.sha512||{};ht.md.sha512=ht.md.algorithms.sha512=Vr;var p0=ht.sha384=ht.sha512.sha384=ht.sha512.sha384||{};p0.create=function(){return Vr.create("SHA-384")};ht.md.sha384=ht.md.algorithms.sha384=p0;ht.sha512.sha256=ht.sha512.sha256||{create:function(){return Vr.create("SHA-512/256")}};ht.md["sha512/256"]=ht.md.algorithms["sha512/256"]=ht.sha512.sha256;ht.sha512.sha224=ht.sha512.sha224||{create:function(){return Vr.create("SHA-512/224")}};ht.md["sha512/224"]=ht.md.algorithms["sha512/224"]=ht.sha512.sha224;Vr.create=function(t){if(y0||nd(),typeof t>"u"&&(t="SHA-512"),!(t in $e))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=$e[t],r=null,n=ht.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var s={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return s.start=function(){s.messageLength=0,s.fullMessageLength=s.messageLength128=[];for(var f=s.messageLengthSize/4,c=0;c<f;++c)s.fullMessageLength.push(0);n=ht.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return s},s.start(),s.update=function(f,c){c==="utf8"&&(f=ht.util.encodeUtf8(f));var u=f.length;s.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=s.fullMessageLength.length-1;h>=0;--h)s.fullMessageLength[h]+=u[1],u[1]=u[0]+(s.fullMessageLength[h]/4294967296>>>0),s.fullMessageLength[h]=s.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),d0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),s},s.digest=function(){var f=ht.util.createBuffer();f.putBytes(n.bytes());var c=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize,u=c&s.blockLength-1;f.putBytes(pa.substr(0,s.blockLength-u));for(var h,d,x=s.fullMessageLength[0]*8,l=0;l<s.fullMessageLength.length-1;++l)h=s.fullMessageLength[l+1]*8,d=h/4294967296>>>0,x+=d,f.putInt32(x>>>0),x=h>>>0;f.putInt32(x);for(var p=new Array(r.length),l=0;l<r.length;++l)p[l]=r[l].slice(0);d0(p,i,f);var y=ht.util.createBuffer(),m;t==="SHA-512"?m=p.length:t==="SHA-384"?m=p.length-2:m=p.length-4;for(var l=0;l<m;++l)y.putInt32(p[l][0]),(l!==m-1||t!=="SHA-512/224")&&y.putInt32(p[l][1]);return y},s};var pa=null,y0=!1,ya=null,$e=null;function nd(){pa="\x80",pa+=ht.util.fillString("\0",128),ya=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],$e={},$e["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],$e["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],$e["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],$e["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],y0=!0}function d0(t,e,r){for(var n,i,a,o,s,f,c,u,h,d,x,l,p,y,m,E,b,R,w,B,L,N,z,H,V,Q,at,_t,I,k,_,D,A,K,O,q=r.length();q>=128;){for(I=0;I<16;++I)e[I][0]=r.getInt32()>>>0,e[I][1]=r.getInt32()>>>0;for(;I<80;++I)D=e[I-2],k=D[0],_=D[1],n=((k>>>19|_<<13)^(_>>>29|k<<3)^k>>>6)>>>0,i=((k<<13|_>>>19)^(_<<3|k>>>29)^(k<<26|_>>>6))>>>0,K=e[I-15],k=K[0],_=K[1],a=((k>>>1|_<<31)^(k>>>8|_<<24)^k>>>7)>>>0,o=((k<<31|_>>>1)^(k<<24|_>>>8)^(k<<25|_>>>7))>>>0,A=e[I-7],O=e[I-16],_=i+A[1]+o+O[1],e[I][0]=n+A[0]+a+O[0]+(_/4294967296>>>0)>>>0,e[I][1]=_>>>0;for(p=t[0][0],y=t[0][1],m=t[1][0],E=t[1][1],b=t[2][0],R=t[2][1],w=t[3][0],B=t[3][1],L=t[4][0],N=t[4][1],z=t[5][0],H=t[5][1],V=t[6][0],Q=t[6][1],at=t[7][0],_t=t[7][1],I=0;I<80;++I)c=((L>>>14|N<<18)^(L>>>18|N<<14)^(N>>>9|L<<23))>>>0,u=((L<<18|N>>>14)^(L<<14|N>>>18)^(N<<23|L>>>9))>>>0,h=(V^L&(z^V))>>>0,d=(Q^N&(H^Q))>>>0,s=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,f=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,x=(p&m|b&(p^m))>>>0,l=(y&E|R&(y^E))>>>0,_=_t+u+d+ya[I][1]+e[I][1],n=at+c+h+ya[I][0]+e[I][0]+(_/4294967296>>>0)>>>0,i=_>>>0,_=f+l,a=s+x+(_/4294967296>>>0)>>>0,o=_>>>0,at=V,_t=Q,V=z,Q=H,z=L,H=N,_=B+i,L=w+n+(_/4294967296>>>0)>>>0,N=_>>>0,w=b,B=R,b=m,R=E,m=p,E=y,_=i+o,p=n+a+(_/4294967296>>>0)>>>0,y=_>>>0;_=t[0][1]+y,t[0][0]=t[0][0]+p+(_/4294967296>>>0)>>>0,t[0][1]=_>>>0,_=t[1][1]+E,t[1][0]=t[1][0]+m+(_/4294967296>>>0)>>>0,t[1][1]=_>>>0,_=t[2][1]+R,t[2][0]=t[2][0]+b+(_/4294967296>>>0)>>>0,t[2][1]=_>>>0,_=t[3][1]+B,t[3][0]=t[3][0]+w+(_/4294967296>>>0)>>>0,t[3][1]=_>>>0,_=t[4][1]+N,t[4][0]=t[4][0]+L+(_/4294967296>>>0)>>>0,t[4][1]=_>>>0,_=t[5][1]+H,t[5][0]=t[5][0]+z+(_/4294967296>>>0)>>>0,t[5][1]=_>>>0,_=t[6][1]+Q,t[6][0]=t[6][0]+V+(_/4294967296>>>0)>>>0,t[6][1]=_>>>0,_=t[7][1]+_t,t[7][0]=t[7][0]+at+(_/4294967296>>>0)>>>0,t[7][1]=_>>>0,q-=128}}});var Pd={};gt(Pd,{aes:()=>wi,hmac:()=>en,keys:()=>Ia,pbkdf2:()=>Ta,randomBytes:()=>mr});var wi={};gt(wi,{create:()=>vc});var F=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Oa={16:"aes-128-ctr",32:"aes-256-ctr"};function Ma(t){if(t.length===16||t.length===32)return Oa[t.length];let e=Object.entries(Oa).map(([r,n])=>`${r} (${n})`).join(" / ");throw new F(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}var Op=Nt(Xr(),1),Ir=Nt(it(),1);function tr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var ni={};gt(ni,{base10:()=>mf});function df(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),o=a.charCodeAt(0);if(r[o]!==255)throw new TypeError(a+" is ambiguous");r[o]=i}var s=t.length,f=t.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function h(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var p=0,y=0,m=0,E=l.length;m!==E&&l[m]===0;)m++,p++;for(var b=(E-m)*u+1>>>0,R=new Uint8Array(b);m!==E;){for(var w=l[m],B=0,L=b-1;(w!==0||B<y)&&L!==-1;L--,B++)w+=256*R[L]>>>0,R[L]=w%s>>>0,w=w/s>>>0;if(w!==0)throw new Error("Non-zero carry");y=B,m++}for(var N=b-y;N!==b&&R[N]===0;)N++;for(var z=f.repeat(p);N<b;++N)z+=t.charAt(R[N]);return z}function d(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var p=0;if(l[p]!==" "){for(var y=0,m=0;l[p]===f;)y++,p++;for(var E=(l.length-p)*c+1>>>0,b=new Uint8Array(E);l[p];){var R=r[l.charCodeAt(p)];if(R===255)return;for(var w=0,B=E-1;(R!==0||w<m)&&B!==-1;B--,w++)R+=s*b[B]>>>0,b[B]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");m=w,p++}if(l[p]!==" "){for(var L=E-m;L!==E&&b[L]===0;)L++;for(var N=new Uint8Array(y+(E-L)),z=y;L!==E;)N[z++]=b[L++];return N}}}function x(l){var p=d(l);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:x}}var pf=df,yf=pf,ts=yf;var Zd=new Uint8Array(0);var es=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},he=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var rs=t=>new TextEncoder().encode(t),ns=t=>new TextDecoder().decode(t);var jn=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ti=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return as(this,e)}},ei=class{constructor(e){this.decoders=e}or(e){return as(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},as=(t,e)=>new ei({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ri=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new jn(e,r,n),this.decoder=new ti(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},er=({name:t,prefix:e,encode:r,decode:n})=>new ri(t,e,r,n),Ce=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=ts(r,e);return er({prefix:t,name:e,encode:n,decode:a=>he(i(a))})},xf=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let o=new Uint8Array(a*r/8|0),s=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,s+=r,s>=8&&(s-=8,o[c++]=255&f>>s)}if(s>=r||255&f<<8-s)throw new SyntaxError("Unexpected end of data");return o},gf=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",o=0,s=0;for(let f=0;f<t.length;++f)for(s=s<<8|t[f],o+=8;o>r;)o-=r,a+=e[i&s>>o];if(o&&(a+=e[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a},mt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>er({prefix:e,name:t,encode(i){return gf(i,n,r)},decode(i){return xf(i,n,r,t)}});var mf=Ce({prefix:"9",name:"base10",alphabet:"0123456789"});var ii={};gt(ii,{base16:()=>vf,base16upper:()=>bf});var vf=mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),bf=mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ai={};gt(ai,{base2:()=>Ef});var Ef=mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var si={};gt(si,{base256emoji:()=>Cf});var ss=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),wf=ss.reduce((t,e,r)=>(t[r]=e,t),[]),Bf=ss.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Sf(t){return t.reduce((e,r)=>(e+=wf[r],e),"")}function Af(t){let e=[];for(let r of t){let n=Bf[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Cf=er({prefix:"\u{1F680}",name:"base256emoji",encode:Sf,decode:Af});var oi={};gt(oi,{base32:()=>rr,base32hex:()=>Rf,base32hexpad:()=>Nf,base32hexpadupper:()=>Df,base32hexupper:()=>Lf,base32pad:()=>Tf,base32padupper:()=>_f,base32upper:()=>If,base32z:()=>kf});var rr=mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),If=mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Tf=mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_f=mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Rf=mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Lf=mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Nf=mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Df=mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kf=mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var fi={};gt(fi,{base36:()=>Pf,base36upper:()=>Uf});var Pf=Ce({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Uf=Ce({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ci={};gt(ci,{base58btc:()=>Ft,base58flickr:()=>Kf});var Ft=Ce({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Kf=Ce({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ui={};gt(ui,{base64:()=>wr,base64pad:()=>Of,base64url:()=>Mf,base64urlpad:()=>Vf});var wr=mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Of=mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Mf=mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vf=mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var hi={};gt(hi,{base8:()=>qf});var qf=mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var li={};gt(li,{identity:()=>Ff});var Ff=er({prefix:"\0",name:"identity",encode:t=>ns(t),decode:t=>rs(t)});var cp=new TextEncoder,up=new TextDecoder;var yi={};gt(yi,{identity:()=>pi});var Gf=cs,os=128,Wf=127,Yf=~Wf,Zf=Math.pow(2,31);function cs(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Zf;)e[r++]=t&255|os,t/=128;for(;t&Yf;)e[r++]=t&255|os,t>>>=7;return e[r]=t|0,cs.bytes=r-n+1,e}var $f=di,Qf=128,fs=127;function di(t,n){var r=0,n=n||0,i=0,a=n,o,s=t.length;do{if(a>=s)throw di.bytes=0,new RangeError("Could not decode varint");o=t[a++],r+=i<28?(o&fs)<<i:(o&fs)*Math.pow(2,i),i+=7}while(o>=Qf);return di.bytes=a-n,r}var Xf=Math.pow(2,7),Jf=Math.pow(2,14),jf=Math.pow(2,21),tc=Math.pow(2,28),ec=Math.pow(2,35),rc=Math.pow(2,42),nc=Math.pow(2,49),ic=Math.pow(2,56),ac=Math.pow(2,63),sc=function(t){return t<Xf?1:t<Jf?2:t<jf?3:t<tc?4:t<ec?5:t<rc?6:t<nc?7:t<ic?8:t<ac?9:10},oc={encode:Gf,decode:$f,encodingLength:sc},fc=oc,Br=fc;var Sr=(t,e=0)=>[Br.decode(t,e),Br.decode.bytes],nr=(t,e,r=0)=>(Br.encode(t,e,r),e),ir=t=>Br.encodingLength(t);var Oe=(t,e)=>{let r=e.byteLength,n=ir(t),i=n+ir(r),a=new Uint8Array(i+r);return nr(t,a,0),nr(r,a,n),a.set(e,i),new ar(t,r,e,a)},us=t=>{let e=he(t),[r,n]=Sr(e),[i,a]=Sr(e.subarray(n)),o=e.subarray(n+a);if(o.byteLength!==i)throw new Error("Incorrect length");return new ar(r,i,o,e)},hs=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&es(t.bytes,r.bytes)}},ar=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var ls=0,cc="identity",ds=he,uc=t=>Oe(ls,ds(t)),pi={code:ls,name:cc,encode:ds,digest:uc};var mi={};gt(mi,{sha256:()=>Mt,sha512:()=>hc});var gi=({name:t,code:e,encode:r})=>new xi(t,e,r),xi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Oe(this.code,r):r.then(n=>Oe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var ys=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Mt=gi({name:"sha2-256",code:18,encode:ys("SHA-256")}),hc=gi({name:"sha2-512",code:19,encode:ys("SHA-512")});var xs=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return dc(r,vi(t),e||Ft.encoder);default:return pc(r,vi(t),e||rr.encoder)}};var gs=new WeakMap,vi=t=>{let e=gs.get(t);if(e==null){let r=new Map;return gs.set(t,r),r}return e},jr=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Cr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==yc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Oe(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&hs(e.multihash,n.multihash)}toString(e){return xs(this,e)}toJSON(){return{"/":xs(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:o}=r;return new t(n,i,a,o||ms(n,i,a.bytes))}else if(r[xc]===!0){let{version:n,multihash:i,code:a}=r,o=us(i);return t.create(n,a,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Cr)throw new Error(`Version 0 CID must use dag-pb (code: ${Cr}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=ms(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Cr,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=he(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),o=new ar(r.multihashCode,r.digestSize,a,i);return[r.version===0?t.createV0(o):t.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,d]=Sr(e.subarray(r));return r+=d,h},i=n(),a=Cr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,s=n(),f=n(),c=r+f,u=c-o;return{version:i,codec:a,multihashCode:s,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=lc(e,r),a=t.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return vi(a).set(n,e),a}},lc=(t,e)=>{switch(t[0]){case"Q":{let r=e||Ft;return[Ft.prefix,r.decode(`${Ft.prefix}${t}`)]}case Ft.prefix:{let r=e||Ft;return[Ft.prefix,r.decode(t)]}case rr.prefix:{let r=e||rr;return[rr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},dc=(t,e,r)=>{let{prefix:n}=r;if(n!==Ft.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},pc=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},Cr=112,yc=18,ms=(t,e,r)=>{let n=ir(t),i=n+ir(e),a=new Uint8Array(i+r.byteLength);return nr(t,a,0),nr(e,a,n),a.set(r,i),a},xc=Symbol.for("@ipld/js-cid/CID");var bi={...li,...ai,...hi,...ni,...ii,...oi,...fi,...ci,...ui,...si},Cp={...mi,...yi};function le(t=0){return globalThis.Buffer?.allocUnsafe!=null?tr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function bs(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var vs=bs("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ei=bs("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=le(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),gc={utf8:vs,"utf-8":vs,hex:bi.base16,latin1:Ei,ascii:Ei,binary:Ei,...bi},tn=gc;function Bt(t,e="utf8"){let r=tn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function yt(t,e="utf8"){let r=tn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Es(t,e,r){let n=Ir.default.cipher.createCipher("AES-CTR",yt(e,"ascii"));return n.start({iv:yt(r,"ascii")}),{update:i=>(n.update(Ir.default.util.createBuffer(yt(i,"ascii"))),Bt(n.output.getBytes(),"ascii"))}}function ws(t,e,r){let n=Ir.default.cipher.createDecipher("AES-CTR",yt(e,"ascii"));return n.start({iv:yt(r,"ascii")}),{update:i=>(n.update(Ir.default.util.createBuffer(yt(i,"ascii"))),Bt(n.output.getBytes(),"ascii"))}}async function vc(t,e){let r=Ma(t),n=Es(r,t,e),i=ws(r,t,e);return{async encrypt(o){return n.update(o)},async decrypt(o){return i.update(o)}}}var en={};gt(en,{create:()=>Bi});var Et={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Bs={SHA1:20,SHA256:32,SHA512:64};var bc={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Ec=async(t,e)=>{let r=await Et.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function Bi(t,e){let r=bc[t],n=await Et.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return Ec(n,i)},length:Bs[t]}}var Ia={};gt(Ia,{generateEphemeralKeyPair:()=>c0,generateKeyPair:()=>_d,generateKeyPairFromSeed:()=>Rd,importKey:()=>kd,keyStretcher:()=>l0,keysPBM:()=>xr,marshalPrivateKey:()=>Dd,marshalPublicKey:()=>Nd,supportedKeys:()=>ce,unmarshalPrivateKey:()=>q0,unmarshalPublicKey:()=>Ld});var ux=Nt(Rr(),1),hx=Nt(Ao(),1);var Vn=Nt(it(),1);var la={};gt(la,{Ed25519PrivateKey:()=>Ze,Ed25519PublicKey:()=>Mr,generateKeyPair:()=>jl,generateKeyPairFromSeed:()=>ha,unmarshalEd25519PrivateKey:()=>Xl,unmarshalEd25519PublicKey:()=>Jl});function Zt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function Co(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Pi(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Io(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Co(t.outputLen),Co(t.blockLen)}function fr(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function To(t,e){Pi(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var gn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var _o=t=>t instanceof Uint8Array;var mn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),$t=(t,e)=>t<<32-e|t>>>e,Mh=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Mh)throw new Error("Non little-endian hardware is not supported");function Ui(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Dr(t){if(typeof t=="string"&&(t=Ui(t)),!_o(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function vn(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!_o(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var cr=class{clone(){return this._cloneInto()}},y1={}.toString;function bn(t){let e=n=>t().update(Dr(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ur(t=32){if(gn&&typeof gn.getRandomValues=="function")return gn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Vh(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),a=BigInt(4294967295),o=Number(r>>i&a),s=Number(r&a),f=n?4:0,c=n?0:4;t.setUint32(e+f,o,n),t.setUint32(e+c,s,n)}var hr=class extends cr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=mn(this.buffer)}update(e){fr(this);let{view:r,buffer:n,blockLen:i}=this;e=Dr(e);let a=e.length;for(let o=0;o<a;){let s=Math.min(i-this.pos,a-o);if(s===i){let f=mn(e);for(;i<=a-o;o+=i)this.process(f,o);continue}n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){fr(this),To(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:a}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;Vh(n,i-8,BigInt(this.length*8),a),this.process(n,0);let s=mn(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let c=f/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)s.setUint32(4*h,u[h],a)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:a,destroyed:o,pos:s}=this;return e.length=i,e.pos=s,e.finished=a,e.destroyed=o,i%r&&e.buffer.set(n),e}};var En=BigInt(4294967295),Ki=BigInt(32);function Ro(t,e=!1){return e?{h:Number(t&En),l:Number(t>>Ki&En)}:{h:Number(t>>Ki&En)|0,l:Number(t&En)|0}}function qh(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:a,l:o}=Ro(t[i],e);[r[i],n[i]]=[a,o]}return[r,n]}var Fh=(t,e)=>BigInt(t>>>0)<<Ki|BigInt(e>>>0),Hh=(t,e,r)=>t>>>r,zh=(t,e,r)=>t<<32-r|e>>>r,Gh=(t,e,r)=>t>>>r|e<<32-r,Wh=(t,e,r)=>t<<32-r|e>>>r,Yh=(t,e,r)=>t<<64-r|e>>>r-32,Zh=(t,e,r)=>t>>>r-32|e<<64-r,$h=(t,e)=>e,Qh=(t,e)=>t,Xh=(t,e,r)=>t<<r|e>>>32-r,Jh=(t,e,r)=>e<<r|t>>>32-r,jh=(t,e,r)=>e<<r-32|t>>>64-r,tl=(t,e,r)=>t<<r-32|e>>>64-r;function el(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var rl=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),nl=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,il=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),al=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,sl=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),ol=(t,e,r,n,i,a)=>e+r+n+i+a+(t/2**32|0)|0;var fl={fromBig:Ro,split:qh,toBig:Fh,shrSH:Hh,shrSL:zh,rotrSH:Gh,rotrSL:Wh,rotrBH:Yh,rotrBL:Zh,rotr32H:$h,rotr32L:Qh,rotlSH:Xh,rotlSL:Jh,rotlBH:jh,rotlBL:tl,add:el,add3L:rl,add3H:nl,add4L:il,add4H:al,add5H:ol,add5L:sl},Y=fl;var[cl,ul]=Y.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),_e=new Uint32Array(80),Re=new Uint32Array(80),Oi=class extends hr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:a,Cl:o,Dh:s,Dl:f,Eh:c,El:u,Fh:h,Fl:d,Gh:x,Gl:l,Hh:p,Hl:y}=this;return[e,r,n,i,a,o,s,f,c,u,h,d,x,l,p,y]}set(e,r,n,i,a,o,s,f,c,u,h,d,x,l,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=a|0,this.Cl=o|0,this.Dh=s|0,this.Dl=f|0,this.Eh=c|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=x|0,this.Gl=l|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let b=0;b<16;b++,r+=4)_e[b]=e.getUint32(r),Re[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){let R=_e[b-15]|0,w=Re[b-15]|0,B=Y.rotrSH(R,w,1)^Y.rotrSH(R,w,8)^Y.shrSH(R,w,7),L=Y.rotrSL(R,w,1)^Y.rotrSL(R,w,8)^Y.shrSL(R,w,7),N=_e[b-2]|0,z=Re[b-2]|0,H=Y.rotrSH(N,z,19)^Y.rotrBH(N,z,61)^Y.shrSH(N,z,6),V=Y.rotrSL(N,z,19)^Y.rotrBL(N,z,61)^Y.shrSL(N,z,6),Q=Y.add4L(L,V,Re[b-7],Re[b-16]),at=Y.add4H(Q,B,H,_e[b-7],_e[b-16]);_e[b]=at|0,Re[b]=Q|0}let{Ah:n,Al:i,Bh:a,Bl:o,Ch:s,Cl:f,Dh:c,Dl:u,Eh:h,El:d,Fh:x,Fl:l,Gh:p,Gl:y,Hh:m,Hl:E}=this;for(let b=0;b<80;b++){let R=Y.rotrSH(h,d,14)^Y.rotrSH(h,d,18)^Y.rotrBH(h,d,41),w=Y.rotrSL(h,d,14)^Y.rotrSL(h,d,18)^Y.rotrBL(h,d,41),B=h&x^~h&p,L=d&l^~d&y,N=Y.add5L(E,w,L,ul[b],Re[b]),z=Y.add5H(N,m,R,B,cl[b],_e[b]),H=N|0,V=Y.rotrSH(n,i,28)^Y.rotrBH(n,i,34)^Y.rotrBH(n,i,39),Q=Y.rotrSL(n,i,28)^Y.rotrBL(n,i,34)^Y.rotrBL(n,i,39),at=n&a^n&s^a&s,_t=i&o^i&f^o&f;m=p|0,E=y|0,p=x|0,y=l|0,x=h|0,l=d|0,{h,l:d}=Y.add(c|0,u|0,z|0,H|0),c=s|0,u=f|0,s=a|0,f=o|0,a=n|0,o=i|0;let I=Y.add3L(H,Q,_t);n=Y.add3H(I,z,V,at),i=I|0}({h:n,l:i}=Y.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:a,l:o}=Y.add(this.Bh|0,this.Bl|0,a|0,o|0),{h:s,l:f}=Y.add(this.Ch|0,this.Cl|0,s|0,f|0),{h:c,l:u}=Y.add(this.Dh|0,this.Dl|0,c|0,u|0),{h,l:d}=Y.add(this.Eh|0,this.El|0,h|0,d|0),{h:x,l}=Y.add(this.Fh|0,this.Fl|0,x|0,l|0),{h:p,l:y}=Y.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:m,l:E}=Y.add(this.Hh|0,this.Hl|0,m|0,E|0),this.set(n,i,a,o,s,f,c,u,h,d,x,l,p,y,m,E)}roundClean(){_e.fill(0),Re.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Mi=bn(()=>new Oi);var Sn={};gt(Sn,{bitGet:()=>gl,bitLen:()=>xl,bitMask:()=>kr,bitSet:()=>ml,bytesToHex:()=>xe,bytesToNumberBE:()=>ge,bytesToNumberLE:()=>Le,concatBytes:()=>me,createHmacDrbg:()=>Fi,ensureBytes:()=>vt,equalBytes:()=>pl,hexToBytes:()=>He,hexToNumber:()=>qi,numberToBytesBE:()=>Ne,numberToBytesLE:()=>ze,numberToHexUnpadded:()=>Do,numberToVarBytesBE:()=>dl,utf8ToBytes:()=>yl,validateObject:()=>oe});var No=BigInt(0),wn=BigInt(1),hl=BigInt(2),Bn=t=>t instanceof Uint8Array,ll=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function xe(t){if(!Bn(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=ll[t[r]];return e}function Do(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function qi(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function He(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,a=t.slice(i,i+2),o=Number.parseInt(a,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function ge(t){return qi(xe(t))}function Le(t){if(!Bn(t))throw new Error("Uint8Array expected");return qi(xe(Uint8Array.from(t).reverse()))}function Ne(t,e){return He(t.toString(16).padStart(e*2,"0"))}function ze(t,e){return Ne(t,e).reverse()}function dl(t){return He(Do(t))}function vt(t,e,r){let n;if(typeof e=="string")try{n=He(e)}catch(a){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${a}`)}else if(Bn(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function me(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Bn(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function pl(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function yl(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function xl(t){let e;for(e=0;t>No;t>>=wn,e+=1);return e}function gl(t,e){return t>>BigInt(e)&wn}var ml=(t,e,r)=>t|(r?wn:No)<<BigInt(e),kr=t=>(hl<<BigInt(t-1))-wn,Vi=t=>new Uint8Array(t),Lo=t=>Uint8Array.from(t);function Fi(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Vi(t),i=Vi(t),a=0,o=()=>{n.fill(1),i.fill(0),a=0},s=(...h)=>r(i,n,...h),f=(h=Vi())=>{i=s(Lo([0]),h),n=s(),h.length!==0&&(i=s(Lo([1]),h),n=s())},c=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,d=[];for(;h<e;){n=s();let x=n.slice();d.push(x),h+=n.length}return me(...d)};return(h,d)=>{o(),f(h);let x;for(;!(x=d(c()));)f();return o(),x}}var vl={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function oe(t,e,r={}){let n=(i,a,o)=>{let s=vl[a];if(typeof s!="function")throw new Error(`Invalid validator "${a}", expected function`);let f=t[i];if(!(o&&f===void 0)&&!s(f,t))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${a}`)};for(let[i,a]of Object.entries(e))n(i,a,!1);for(let[i,a]of Object.entries(r))n(i,a,!0);return t}var At=BigInt(0),dt=BigInt(1),Ge=BigInt(2),bl=BigInt(3),Hi=BigInt(4),ko=BigInt(5),Po=BigInt(8),El=BigInt(9),wl=BigInt(16);function st(t,e){let r=t%e;return r>=At?r:e+r}function Bl(t,e,r){if(r<=At||e<At)throw new Error("Expected power/modulo > 0");if(r===dt)return At;let n=dt;for(;e>At;)e&dt&&(n=n*t%r),t=t*t%r,e>>=dt;return n}function pt(t,e,r){let n=t;for(;e-- >At;)n*=n,n%=r;return n}function An(t,e){if(t===At||e<=At)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=st(t,e),n=e,i=At,a=dt,o=dt,s=At;for(;r!==At;){let c=n/r,u=n%r,h=i-o*c,d=a-s*c;n=r,r=u,i=o,a=s,o=h,s=d}if(n!==dt)throw new Error("invert: does not exist");return st(i,e)}function Sl(t){let e=(t-dt)/Ge,r,n,i;for(r=t-dt,n=0;r%Ge===At;r/=Ge,n++);for(i=Ge;i<t&&Bl(i,e,t)!==t-dt;i++);if(n===1){let o=(t+dt)/Hi;return function(f,c){let u=f.pow(c,o);if(!f.eql(f.sqr(u),c))throw new Error("Cannot find square root");return u}}let a=(r+dt)/Ge;return function(s,f){if(s.pow(f,e)===s.neg(s.ONE))throw new Error("Cannot find square root");let c=n,u=s.pow(s.mul(s.ONE,i),r),h=s.pow(f,a),d=s.pow(f,r);for(;!s.eql(d,s.ONE);){if(s.eql(d,s.ZERO))return s.ZERO;let x=1;for(let p=s.sqr(d);x<c&&!s.eql(p,s.ONE);x++)p=s.sqr(p);let l=s.pow(u,dt<<BigInt(c-x-1));u=s.sqr(l),h=s.mul(h,l),d=s.mul(d,u),c=x}return h}}function Al(t){if(t%Hi===bl){let e=(t+dt)/Hi;return function(n,i){let a=n.pow(i,e);if(!n.eql(n.sqr(a),i))throw new Error("Cannot find square root");return a}}if(t%Po===ko){let e=(t-ko)/Po;return function(n,i){let a=n.mul(i,Ge),o=n.pow(a,e),s=n.mul(i,o),f=n.mul(n.mul(s,Ge),o),c=n.mul(s,n.sub(f,n.ONE));if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}return t%wl,Sl(t)}var Uo=(t,e)=>(st(t,e)&dt)===dt,Cl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function zi(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Cl.reduce((n,i)=>(n[i]="function",n),e);return oe(t,r)}function Il(t,e,r){if(r<At)throw new Error("Expected power > 0");if(r===At)return t.ONE;if(r===dt)return e;let n=t.ONE,i=e;for(;r>At;)r&dt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=dt;return n}function Tl(t,e){let r=new Array(e.length),n=e.reduce((a,o,s)=>t.is0(o)?a:(r[s]=a,t.mul(a,o)),t.ONE),i=t.inv(n);return e.reduceRight((a,o,s)=>t.is0(o)?a:(r[s]=t.mul(a,r[s]),t.mul(a,o)),i),r}function Gi(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Cn(t,e,r=!1,n={}){if(t<=At)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:a}=Gi(t,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Al(t),s=Object.freeze({ORDER:t,BITS:i,BYTES:a,MASK:kr(i),ZERO:At,ONE:dt,create:f=>st(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return At<=f&&f<t},is0:f=>f===At,isOdd:f=>(f&dt)===dt,neg:f=>st(-f,t),eql:(f,c)=>f===c,sqr:f=>st(f*f,t),add:(f,c)=>st(f+c,t),sub:(f,c)=>st(f-c,t),mul:(f,c)=>st(f*c,t),pow:(f,c)=>Il(s,f,c),div:(f,c)=>st(f*An(c,t),t),sqrN:f=>f*f,addN:(f,c)=>f+c,subN:(f,c)=>f-c,mulN:(f,c)=>f*c,inv:f=>An(f,t),sqrt:n.sqrt||(f=>o(s,f)),invertBatch:f=>Tl(s,f),cmov:(f,c,u)=>u?c:f,toBytes:f=>r?ze(f,a):Ne(f,a),fromBytes:f=>{if(f.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${f.length}`);return r?Le(f):ge(f)}});return Object.freeze(s)}function Ko(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function Oo(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function Wi(t){let e=Oo(t);return e+Math.ceil(e/2)}function Mo(t,e,r=!1){let n=t.length,i=Oo(e),a=Wi(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);let o=r?ge(t):Le(t),s=st(o,e-dt)+dt;return r?ze(s,i):Ne(s,i)}var Rl=BigInt(0),Yi=BigInt(1);function In(t,e){let r=(i,a)=>{let o=a.negate();return i?o:a},n=i=>{let a=Math.ceil(e/i)+1,o=2**(i-1);return{windows:a,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,a){let o=t.ZERO,s=i;for(;a>Rl;)a&Yi&&(o=o.add(s)),s=s.double(),a>>=Yi;return o},precomputeWindow(i,a){let{windows:o,windowSize:s}=n(a),f=[],c=i,u=c;for(let h=0;h<o;h++){u=c,f.push(u);for(let d=1;d<s;d++)u=u.add(c),f.push(u);c=u.double()}return f},wNAF(i,a,o){let{windows:s,windowSize:f}=n(i),c=t.ZERO,u=t.BASE,h=BigInt(2**i-1),d=2**i,x=BigInt(i);for(let l=0;l<s;l++){let p=l*f,y=Number(o&h);o>>=x,y>f&&(y-=d,o+=Yi);let m=p,E=p+Math.abs(y)-1,b=l%2!==0,R=y<0;y===0?u=u.add(r(b,a[m])):c=c.add(r(R,a[E]))}return{p:c,f:u}},wNAFCached(i,a,o,s){let f=i._WINDOW_SIZE||1,c=a.get(i);return c||(c=this.precomputeWindow(i,f),f!==1&&a.set(i,s(c))),this.wNAF(f,c,o)}}}function Pr(t){return zi(t.Fp),oe(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Gi(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var Qt=BigInt(0),Vt=BigInt(1),Tn=BigInt(2),Ll=BigInt(8),Nl={zip215:!0};function Dl(t){let e=Pr(t);return oe(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function _n(t){let e=Dl(t),{Fp:r,n,prehash:i,hash:a,randomBytes:o,nByteLength:s,h:f}=e,c=Tn<<BigInt(s*8)-Vt,u=r.create,h=e.uvRatio||((D,A)=>{try{return{isValid:!0,value:r.sqrt(D*r.inv(A))}}catch{return{isValid:!1,value:Qt}}}),d=e.adjustScalarBytes||(D=>D),x=e.domain||((D,A,K)=>{if(A.length||K)throw new Error("Contexts/pre-hash are not supported");return D}),l=D=>typeof D=="bigint"&&Qt<D,p=(D,A)=>l(D)&&l(A)&&D<A,y=D=>D===Qt||p(D,c);function m(D,A){if(p(D,A))return D;throw new Error(`Expected valid scalar < ${A}, got ${typeof D} ${D}`)}function E(D){return D===Qt?D:m(D,n)}let b=new Map;function R(D){if(!(D instanceof w))throw new Error("ExtendedPoint expected")}class w{constructor(A,K,O,q){if(this.ex=A,this.ey=K,this.ez=O,this.et=q,!y(A))throw new Error("x required");if(!y(K))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(q))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof w)throw new Error("extended point not allowed");let{x:K,y:O}=A||{};if(!y(K)||!y(O))throw new Error("invalid affine point");return new w(K,O,Vt,u(K*O))}static normalizeZ(A){let K=r.invertBatch(A.map(O=>O.ez));return A.map((O,q)=>O.toAffine(K[q])).map(w.fromAffine)}_setWindowSize(A){this._WINDOW_SIZE=A,b.delete(this)}assertValidity(){let{a:A,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:q,ez:Z,et:X}=this,nt=u(O*O),J=u(q*q),et=u(Z*Z),wt=u(et*et),xt=u(nt*A),Rt=u(et*u(xt+J)),Lt=u(wt+u(K*u(nt*J)));if(Rt!==Lt)throw new Error("bad point: equation left != right (1)");let St=u(O*q),Dt=u(Z*X);if(St!==Dt)throw new Error("bad point: equation left != right (2)")}equals(A){R(A);let{ex:K,ey:O,ez:q}=this,{ex:Z,ey:X,ez:nt}=A,J=u(K*nt),et=u(Z*q),wt=u(O*nt),xt=u(X*q);return J===et&&wt===xt}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:A}=e,{ex:K,ey:O,ez:q}=this,Z=u(K*K),X=u(O*O),nt=u(Tn*u(q*q)),J=u(A*Z),et=K+O,wt=u(u(et*et)-Z-X),xt=J+X,Rt=xt-nt,Lt=J-X,St=u(wt*Rt),Dt=u(xt*Lt),ue=u(wt*Lt),Ue=u(Rt*xt);return new w(St,Dt,Ue,ue)}add(A){R(A);let{a:K,d:O}=e,{ex:q,ey:Z,ez:X,et:nt}=this,{ex:J,ey:et,ez:wt,et:xt}=A;if(K===BigInt(-1)){let Ra=u((Z-q)*(et+J)),La=u((Z+q)*(et-J)),qn=u(La-Ra);if(qn===Qt)return this.double();let Na=u(X*Tn*xt),Da=u(nt*Tn*wt),ka=Da+Na,Pa=La+Ra,Ua=Da-Na,$0=u(ka*qn),Q0=u(Pa*Ua),X0=u(ka*Ua),J0=u(qn*Pa);return new w($0,Q0,J0,X0)}let Rt=u(q*J),Lt=u(Z*et),St=u(nt*O*xt),Dt=u(X*wt),ue=u((q+Z)*(J+et)-Rt-Lt),Ue=Dt-St,br=Dt+St,_a=u(Lt-K*Rt),G0=u(ue*Ue),W0=u(br*_a),Y0=u(ue*_a),Z0=u(Ue*br);return new w(G0,W0,Z0,Y0)}subtract(A){return this.add(A.negate())}wNAF(A){return N.wNAFCached(this,b,A,w.normalizeZ)}multiply(A){let{p:K,f:O}=this.wNAF(m(A,n));return w.normalizeZ([K,O])[0]}multiplyUnsafe(A){let K=E(A);return K===Qt?L:this.equals(L)||K===Vt?this:this.equals(B)?this.wNAF(K).p:N.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return N.unsafeLadder(this,n).is0()}toAffine(A){let{ex:K,ey:O,ez:q}=this,Z=this.is0();A==null&&(A=Z?Ll:r.inv(q));let X=u(K*A),nt=u(O*A),J=u(q*A);if(Z)return{x:Qt,y:Vt};if(J!==Vt)throw new Error("invZ was invalid");return{x:X,y:nt}}clearCofactor(){let{h:A}=e;return A===Vt?this:this.multiplyUnsafe(A)}static fromHex(A,K=!1){let{d:O,a:q}=e,Z=r.BYTES;A=vt("pointHex",A,Z);let X=A.slice(),nt=A[Z-1];X[Z-1]=nt&-129;let J=Le(X);J===Qt||(K?m(J,c):m(J,r.ORDER));let et=u(J*J),wt=u(et-Vt),xt=u(O*et-q),{isValid:Rt,value:Lt}=h(wt,xt);if(!Rt)throw new Error("Point.fromHex: invalid y coordinate");let St=(Lt&Vt)===Vt,Dt=(nt&128)!==0;if(!K&&Lt===Qt&&Dt)throw new Error("Point.fromHex: x=0 and x_0=1");return Dt!==St&&(Lt=u(-Lt)),w.fromAffine({x:Lt,y:J})}static fromPrivateKey(A){return V(A).point}toRawBytes(){let{x:A,y:K}=this.toAffine(),O=ze(K,r.BYTES);return O[O.length-1]|=A&Vt?128:0,O}toHex(){return xe(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Vt,u(e.Gx*e.Gy)),w.ZERO=new w(Qt,Vt,Vt,Qt);let{BASE:B,ZERO:L}=w,N=In(w,s*8);function z(D){return st(D,n)}function H(D){return z(Le(D))}function V(D){let A=s;D=vt("private key",D,A);let K=vt("hashed private key",a(D),2*A),O=d(K.slice(0,A)),q=K.slice(A,2*A),Z=H(O),X=B.multiply(Z),nt=X.toRawBytes();return{head:O,prefix:q,scalar:Z,point:X,pointBytes:nt}}function Q(D){return V(D).pointBytes}function at(D=new Uint8Array,...A){let K=me(...A);return H(a(x(K,vt("context",D),!!i)))}function _t(D,A,K={}){D=vt("message",D),i&&(D=i(D));let{prefix:O,scalar:q,pointBytes:Z}=V(A),X=at(K.context,O,D),nt=B.multiply(X).toRawBytes(),J=at(K.context,nt,Z,D),et=z(X+J*q);E(et);let wt=me(nt,ze(et,r.BYTES));return vt("result",wt,s*2)}let I=Nl;function k(D,A,K,O=I){let{context:q,zip215:Z}=O,X=r.BYTES;D=vt("signature",D,2*X),A=vt("message",A),i&&(A=i(A));let nt=Le(D.slice(X,2*X)),J,et,wt;try{J=w.fromHex(K,Z),et=w.fromHex(D.slice(0,X),Z),wt=B.multiplyUnsafe(nt)}catch{return!1}if(!Z&&J.isSmallOrder())return!1;let xt=at(q,et.toRawBytes(),J.toRawBytes(),A);return et.add(J.multiplyUnsafe(xt)).subtract(wt).clearCofactor().equals(w.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:Q,sign:_t,verify:k,ExtendedPoint:w,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>o(r.BYTES),precompute(D=8,A=w.BASE){return A._setWindowSize(D),A.multiply(BigInt(3)),A}}}}var $i=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Vo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),K1=BigInt(0),kl=BigInt(1),Zi=BigInt(2),Pl=BigInt(5),qo=BigInt(10),Ul=BigInt(20),Kl=BigInt(40),Fo=BigInt(80);function Ol(t){let e=$i,n=t*t%e*t%e,i=pt(n,Zi,e)*n%e,a=pt(i,kl,e)*t%e,o=pt(a,Pl,e)*a%e,s=pt(o,qo,e)*o%e,f=pt(s,Ul,e)*s%e,c=pt(f,Kl,e)*f%e,u=pt(c,Fo,e)*c%e,h=pt(u,Fo,e)*c%e,d=pt(h,qo,e)*o%e;return{pow_p_5_8:pt(d,Zi,e)*t%e,b2:n}}function Ml(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Vl(t,e){let r=$i,n=st(e*e*e,r),i=st(n*n*e,r),a=Ol(t*i).pow_p_5_8,o=st(t*n*a,r),s=st(e*o*o,r),f=o,c=st(o*Vo,r),u=s===t,h=s===st(-t,r),d=s===st(-t*Vo,r);return u&&(o=f),(h||d)&&(o=c),Uo(o,r)&&(o=st(-o,r)),{isValid:u||h,value:o}}var ve=Cn($i,void 0,!0),Qi={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ve,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Mi,randomBytes:ur,adjustScalarBytes:Ml,uvRatio:Vl},lr=_n(Qi);function Ho(t,e,r){if(e.length>255)throw new Error("Context is too big");return vn(Ui("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var O1=_n({...Qi,domain:Ho}),M1=_n({...Qi,domain:Ho,prehash:Mi});var ql=(ve.ORDER+BigInt(3))/BigInt(8),V1=ve.pow(Zi,ql),q1=ve.sqrt(ve.neg(ve.ONE)),F1=(ve.ORDER-BigInt(5))/BigInt(8),H1=BigInt(486662);var z1=Ko(ve,ve.neg(BigInt(486664)));var G1=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),W1=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Y1=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Z1=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var $1=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var dr=32,be=64,Rn=32;async function zo(){let t=lr.utils.randomPrivateKey(),e=lr.getPublicKey(t);return{privateKey:Zo(t,e),publicKey:e}}async function Go(t){if(t.length!==Rn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=lr.getPublicKey(e);return{privateKey:Zo(e,r),publicKey:r}}async function Wo(t,e){let r=t.subarray(0,Rn);return lr.sign(e instanceof Uint8Array?e:e.subarray(),r)}async function Yo(t,e,r){return lr.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}function Zo(t,e){let r=new Uint8Array(be);for(let n=0;n<Rn;n++)r[n]=t[n],r[Rn+n]=e[n];return r}function fe(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=le(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return tr(r)}var Xi={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Ln(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,o=t?.iterations??32767,s=Et.get();r*=8;async function f(h,d){let x=s.getRandomValues(new Uint8Array(a)),l=s.getRandomValues(new Uint8Array(n)),p={name:e,iv:l};typeof d=="string"&&(d=Bt(d));let y;if(d.length===0){y=await s.subtle.importKey("jwk",Xi,{name:"AES-GCM"},!0,["encrypt"]);try{let E={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},b=await s.subtle.importKey("raw",d,{name:"PBKDF2"},!1,["deriveKey"]);y=await s.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}catch{y=await s.subtle.importKey("jwk",Xi,{name:"AES-GCM"},!0,["encrypt"])}}else{let E={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},b=await s.subtle.importKey("raw",d,{name:"PBKDF2"},!1,["deriveKey"]);y=await s.subtle.deriveKey(E,b,{name:e,length:r},!0,["encrypt"])}let m=await s.subtle.encrypt(p,y,h);return fe([x,p.iv,new Uint8Array(m)])}async function c(h,d){let x=h.subarray(0,a),l=h.subarray(a,a+n),p=h.subarray(a+n),y={name:e,iv:l};typeof d=="string"&&(d=Bt(d));let m;if(d.length===0)try{let b={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},R=await s.subtle.importKey("raw",d,{name:"PBKDF2"},!1,["deriveKey"]);m=await s.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}catch{m=await s.subtle.importKey("jwk",Xi,{name:"AES-GCM"},!0,["decrypt"])}else{let b={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},R=await s.subtle.importKey("raw",d,{name:"PBKDF2"},!1,["deriveKey"]);m=await s.subtle.deriveKey(b,R,{name:e,length:r},!0,["decrypt"])}let E=await s.subtle.decrypt(y,m,p);return new Uint8Array(E)}return{encrypt:f,decrypt:c}}async function pr(t,e){let n=await Ln().encrypt(t,e);return wr.encode(n)}var xr={};gt(xr,{KeyType:()=>ut,PrivateKey:()=>jt,PublicKey:()=>Jt});var Ji=new Float32Array([-0]),De=new Uint8Array(Ji.buffer);function Qo(t,e,r){Ji[0]=t,e[r]=De[0],e[r+1]=De[1],e[r+2]=De[2],e[r+3]=De[3]}function Xo(t,e){return De[0]=t[e],De[1]=t[e+1],De[2]=t[e+2],De[3]=t[e+3],Ji[0]}var ji=new Float64Array([-0]),kt=new Uint8Array(ji.buffer);function Jo(t,e,r){ji[0]=t,e[r]=kt[0],e[r+1]=kt[1],e[r+2]=kt[2],e[r+3]=kt[3],e[r+4]=kt[4],e[r+5]=kt[5],e[r+6]=kt[6],e[r+7]=kt[7]}function jo(t,e){return kt[0]=t[e],kt[1]=t[e+1],kt[2]=t[e+2],kt[3]=t[e+3],kt[4]=t[e+4],kt[5]=t[e+5],kt[6]=t[e+6],kt[7]=t[e+7],ji[0]}var Hl=BigInt(Number.MAX_SAFE_INTEGER),zl=BigInt(Number.MIN_SAFE_INTEGER),Ot=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return We;if(e<Hl&&e>zl)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,i=e-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>t0&&(i=0n,++n>t0&&(n=0n))),new t(Number(i),Number(n))}static fromNumber(e){if(e===0)return We;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(n,i)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):We}},We=new Ot(0,0);We.toBigInt=function(){return 0n};We.zzEncode=We.zzDecode=function(){return this};We.length=function(){return 1};var t0=4294967296n;function e0(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function r0(t,e,r){if(r-e<1)return"";let i,a=[],o=0,s;for(;e<r;)s=t[e++],s<128?a[o++]=s:s>191&&s<224?a[o++]=(s&31)<<6|t[e++]&63:s>239&&s<365?(s=((s&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,a[o++]=55296+(s>>10),a[o++]=56320+(s&1023)):a[o++]=(s&15)<<12|(t[e++]&63)<<6|t[e++]&63,o>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,a)),o=0);return i!=null?(o>0&&i.push(String.fromCharCode.apply(String,a.slice(0,o))),i.join("")):String.fromCharCode.apply(String,a.slice(0,o))}function ta(t,e,r){let n=r,i,a;for(let o=0;o<t.length;++o)i=t.charCodeAt(o),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&((a=t.charCodeAt(o+1))&64512)===56320?(i=65536+((i&1023)<<10)+(a&1023),++o,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128);return r-n}function Xt(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function Nn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var ea=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Xt(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Xt(this,4);return Nn(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Xt(this,4);return Nn(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Xt(this,4);let e=Xo(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw Xt(this,4);let e=jo(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Xt(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return r0(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Xt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Xt(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new Ot(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw Xt(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw Xt(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Xt(this,8);let e=Nn(this.buf,this.pos+=4),r=Nn(this.buf,this.pos+=4);return new Ot(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function ra(t){return new ea(t instanceof Uint8Array?t:t.subarray())}function Dn(t,e){let r=ra(t);return e.decode(r)}function na(t){let e=t??8192,r=e>>>1,n,i=e;return function(o){if(o<1||o>r)return le(o);i+o>e&&(n=le(e),i=0);let s=n.subarray(i,i+=o);return i&7&&(i=(i|7)+1),s}}var Ye=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function ia(){}var sa=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},Gl=na();function Wl(t){return globalThis.Buffer!=null?le(t):Gl(t)}var Or=class{len;head;tail;states;constructor(){this.len=0,this.head=new Ye(ia,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new Ye(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new oa((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Ur,10,Ot.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=Ot.fromBigInt(e);return this._push(Ur,r.length(),r)}uint64Number(e){let r=Ot.fromNumber(e);return this._push(Ur,r.length(),r)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=Ot.fromBigInt(e).zzEncode();return this._push(Ur,r.length(),r)}sint64Number(e){let r=Ot.fromNumber(e).zzEncode();return this._push(Ur,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(aa,1,e?1:0)}fixed32(e){return this._push(Kr,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=Ot.fromBigInt(e);return this._push(Kr,4,r.lo)._push(Kr,4,r.hi)}fixed64Number(e){let r=Ot.fromNumber(e);return this._push(Kr,4,r.lo)._push(Kr,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(Qo,4,e)}double(e){return this._push(Jo,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(aa,1,0):this.uint32(r)._push(Zl,r,e)}string(e){let r=e0(e);return r!==0?this.uint32(r)._push(ta,r,e):this._push(aa,1,0)}fork(){return this.states=new sa(this),this.head=this.tail=new Ye(ia,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ye(ia,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=Wl(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function aa(t,e,r){e[r]=t&255}function Yl(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var oa=class extends Ye{next;constructor(e,r){super(Yl,e,r),this.next=void 0}};function Ur(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Kr(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Zl(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(Or.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push($l,e,t),this},Or.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(Ql,e,t),this});function $l(t,e,r){e.set(t,r)}function Ql(t,e,r){t.length<40?ta(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(Bt(t),r)}function fa(){return new Or}function kn(t,e){let r=fa();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var yr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(yr||(yr={}));function Pn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ca(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,o){let s=e(a);o.int32(s)},n=function(a){let o=a.int32();return e(o)};return Pn("enum",yr.VARINT,r,n)}function Un(t,e){return Pn("message",yr.LENGTH_DELIMITED,t,e)}var ut;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(ut||(ut={}));var ua;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(ua||(ua={}));(function(t){t.codec=()=>ca(ua)})(ut||(ut={}));var Jt;(function(t){let e;t.codec=()=>(e==null&&(e=Un((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let o=r.uint32();switch(o>>>3){case 1:i.Type=ut.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>kn(r,t.codec()),t.decode=r=>Dn(r,t.codec())})(Jt||(Jt={}));var jt;(function(t){let e;t.codec=()=>(e==null&&(e=Un((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let o=r.uint32();switch(o>>>3){case 1:i.Type=ut.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>kn(r,t.codec()),t.decode=r=>Dn(r,t.codec())})(jt||(jt={}));var Mr=class{_key;constructor(e){this._key=gr(e,dr)}async verify(e,r){return Yo(this._key,r,e)}marshal(){return this._key}get bytes(){return Jt.encode({Type:ut.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Zt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}},Ze=class{_key;_publicKey;constructor(e,r){this._key=gr(e,be),this._publicKey=gr(r,dr)}async sign(e){return Wo(this._key,e)}get public(){return new Mr(this._publicKey)}marshal(){return this._key}get bytes(){return jt.encode({Type:ut.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Zt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}async id(){let e=pi.digest(this.public.bytes);return Ft.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return pr(this.bytes,e);throw new F(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Xl(t){if(t.length>be){t=gr(t,be+dr);let n=t.subarray(0,be),i=t.subarray(be,t.length);return new Ze(n,i)}t=gr(t,be);let e=t.subarray(0,be),r=t.subarray(dr);return new Ze(e,r)}function Jl(t){return t=gr(t,dr),new Mr(t)}async function jl(){let{privateKey:t,publicKey:e}=await zo();return new Ze(t,e)}async function ha(t){let{privateKey:e,publicKey:r}=await Go(t);return new Ze(e,r)}function gr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new F(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var Fy=Nt(bt(),1),Hy=Nt(dn(),1),i0=Nt(it(),1);function te(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=fe([new Uint8Array(e-r.length),r])}return yt(r,"base64url")}function qt(t){let e=Kn(t);return new i0.default.jsbn.BigInteger(yt(e,"base16"),16)}function Kn(t,e){let r=Bt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=fe([new Uint8Array(e-r.length),r])}return r}var a0={"P-256":256,"P-384":384,"P-521":521},td=Object.keys(a0),da=td.join(" / ");async function s0(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new F(`Unknown curve: ${t}. Must be ${da}`,"ERR_INVALID_CURVE");let e=await Et.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(a,o)=>{let s;o!=null?s=await Et.get().subtle.importKey("jwk",rd(t,o),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):s=e.privateKey;let f=await Et.get().subtle.importKey("jwk",f0(t,a),{name:"ECDH",namedCurve:t},!1,[]),c=await Et.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},s,a0[t]);return new Uint8Array(c,0,c.byteLength)},n=await Et.get().subtle.exportKey("jwk",e.publicKey);return{key:ed(n),genSharedKey:r}}var o0={"P-256":32,"P-384":48,"P-521":66};function ed(t){if(t.crv==null||t.x==null||t.y==null)throw new F("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new F(`Unknown curve: ${t.crv}. Must be ${da}`,"ERR_INVALID_CURVE");let e=o0[t.crv];return fe([Uint8Array.from([4]),Kn(t.x,e),Kn(t.y,e)],1+e*2)}function f0(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new F(`Unknown curve: ${t}. Must be ${da}`,"ERR_INVALID_CURVE");let r=o0[t];if(!Zt(e.subarray(0,1),Uint8Array.from([4])))throw new F("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:yt(e.subarray(1,r+1),"base64url"),y:yt(e.subarray(1+r),"base64url"),ext:!0}}var rd=(t,e)=>({...f0(t,e.public),d:yt(e.private,"base64url")});var c0=s0;async function u0(t,e){let r=wr.decode(t);return Ln().decrypt(r,e)}var h0={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function l0(t,e,r){let n=h0[t];if(n==null){let E=Object.keys(h0).join(" / ");throw new F(`unknown cipher type '${t}'. Must be ${E}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new F("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,o=20,s=Bt("key expansion"),f=2*(a+i+o),c=await Bi(e,r),u=await c.digest(s),h=[],d=0;for(;d<f;){let E=await c.digest(fe([u,s])),b=E.length;d+b>f&&(b=f-d),h.push(E),d+=b,u=await c.digest(u)}let x=f/2,l=fe(h),p=l.subarray(0,x),y=l.subarray(x,f),m=E=>({iv:E.subarray(0,a),cipherKey:E.subarray(a,a+i),macKey:E.subarray(a+i)});return{k1:m(p),k2:m(y)}}var ma={};gt(ma,{MAX_KEY_SIZE:()=>Hr,RsaPrivateKey:()=>vr,RsaPublicKey:()=>Fr,fromJwk:()=>ld,generateKeyPair:()=>dd,unmarshalRsaPrivateKey:()=>ud,unmarshalRsaPublicKey:()=>hd});var qr=Nt(it(),1);var L2=Nt(g0(),1);function mr(t){if(isNaN(t)||t<=0)throw new F("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return ur(t)}var d2=Nt(xn(),1),xa=Nt(it(),1);function m0(t,e){return e.map(r=>qt(t[r]))}function v0(t){return xa.default.pki.setRsaPrivateKey(...m0(t,["n","e","d","p","q","dp","dq","qi"]))}function b0(t){return xa.default.pki.setRsaPublicKey(...m0(t,["n","e"]))}var Qe={};gt(Qe,{jwkToPkcs1:()=>ad,jwkToPkix:()=>od,pkcs1ToJwk:()=>id,pkixToJwk:()=>sd});var x2=Nt(Rr(),1),g2=Nt(xn(),1);var Ee=Nt(it(),1);function id(t){let e=Ee.default.asn1.fromDer(yt(t,"ascii")),r=Ee.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:te(r.n),e:te(r.e),d:te(r.d),p:te(r.p),q:te(r.q),dp:te(r.dP),dq:te(r.dQ),qi:te(r.qInv),alg:"RS256"}}function ad(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new F("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ee.default.pki.privateKeyToAsn1({n:qt(t.n),e:qt(t.e),d:qt(t.d),p:qt(t.p),q:qt(t.q),dP:qt(t.dp),dQ:qt(t.dq),qInv:qt(t.qi)});return Bt(Ee.default.asn1.toDer(e).getBytes(),"ascii")}function sd(t){let e=Ee.default.asn1.fromDer(yt(t,"ascii")),r=Ee.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:te(r.n),e:te(r.e)}}function od(t){if(t.n==null||t.e==null)throw new F("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ee.default.pki.publicKeyToAsn1({n:qt(t.n),e:qt(t.e)});return Bt(Ee.default.asn1.toDer(e).getBytes(),"ascii")}async function E0(t){let e=await Et.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await S0(e);return{privateKey:r[0],publicKey:r[1]}}async function ga(t){let r=[await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await fd(t)],n=await S0({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function w0(t,e){let r=await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Et.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}async function B0(t,e,r){let n=await Et.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Et.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}async function S0(t){if(t.privateKey==null||t.publicKey==null)throw new F("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Et.get().subtle.exportKey("jwk",t.privateKey),Et.get().subtle.exportKey("jwk",t.publicKey)])}async function fd(t){return Et.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function A0(t,e,r,n){let i=e?b0(t):v0(t),a=yt(r instanceof Uint8Array?r:r.subarray(),"ascii"),o=n(a,i);return Bt(o,"ascii")}function C0(t,e){return A0(t,!0,e,(r,n)=>n.encrypt(r))}function I0(t,e){return A0(t,!1,e,(r,n)=>n.decrypt(r))}function On(t){if(t.kty!=="RSA")throw new F("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new F("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Bt(t.n,"base64url").length*8}var Hr=8192,Fr=class{_key;constructor(e){this._key=e}async verify(e,r){return B0(this._key,r,e)}marshal(){return Qe.jwkToPkix(this._key)}get bytes(){return Jt.encode({Type:ut.RSA,Data:this.marshal()}).subarray()}encrypt(e){return C0(this._key,e)}equals(e){return Zt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}},vr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return mr(16)}async sign(e){return w0(this._key,e)}get public(){if(this._publicKey==null)throw new F("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Fr(this._publicKey)}decrypt(e){return I0(this._key,e)}marshal(){return Qe.jwkToPkcs1(this._key)}get bytes(){return jt.encode({Type:ut.RSA,Data:this.marshal()}).subarray()}equals(e){return Zt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return yt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new qr.default.util.ByteBuffer(this.marshal()),i=qr.default.asn1.fromDer(n),a=qr.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return qr.default.pki.encryptRsaPrivateKey(a,e,o)}else{if(r==="libp2p-key")return pr(this.bytes,e);throw new F(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function ud(t){let e=Qe.pkcs1ToJwk(t);if(On(e)>Hr)throw new F("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await ga(e);return new vr(r.privateKey,r.publicKey)}function hd(t){let e=Qe.pkixToJwk(t);if(On(e)>Hr)throw new F("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Fr(e)}async function ld(t){if(On(t)>Hr)throw new F("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await ga(t);return new vr(e.privateKey,e.publicKey)}async function dd(t){if(t>Hr)throw new F("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await E0(t);return new vr(e.privateKey,e.publicKey)}var Sa={};gt(Sa,{Secp256k1PrivateKey:()=>Gr,Secp256k1PublicKey:()=>zr,generateKeyPair:()=>Td,unmarshalSecp256k1PrivateKey:()=>Cd,unmarshalSecp256k1PublicKey:()=>Id});var pd=(t,e,r)=>t&e^~t&r,yd=(t,e,r)=>t&e^t&r^e&r,xd=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ke=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pe=new Uint32Array(64),va=class extends hr{constructor(){super(64,32,8,!1),this.A=ke[0]|0,this.B=ke[1]|0,this.C=ke[2]|0,this.D=ke[3]|0,this.E=ke[4]|0,this.F=ke[5]|0,this.G=ke[6]|0,this.H=ke[7]|0}get(){let{A:e,B:r,C:n,D:i,E:a,F:o,G:s,H:f}=this;return[e,r,n,i,a,o,s,f]}set(e,r,n,i,a,o,s,f){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=a|0,this.F=o|0,this.G=s|0,this.H=f|0}process(e,r){for(let h=0;h<16;h++,r+=4)Pe[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let d=Pe[h-15],x=Pe[h-2],l=$t(d,7)^$t(d,18)^d>>>3,p=$t(x,17)^$t(x,19)^x>>>10;Pe[h]=p+Pe[h-7]+l+Pe[h-16]|0}let{A:n,B:i,C:a,D:o,E:s,F:f,G:c,H:u}=this;for(let h=0;h<64;h++){let d=$t(s,6)^$t(s,11)^$t(s,25),x=u+d+pd(s,f,c)+xd[h]+Pe[h]|0,p=($t(n,2)^$t(n,13)^$t(n,22))+yd(n,i,a)|0;u=c,c=f,f=s,s=o+x|0,o=a,a=i,i=n,n=x+p|0}n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,o=o+this.D|0,s=s+this.E|0,f=f+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,i,a,o,s,f,c,u)}roundClean(){Pe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var T0=bn(()=>new va);function gd(t){let e=Pr(t);oe(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:md,hexToBytes:vd}=Sn,Xe={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=Xe;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:md(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=Xe,r=typeof t=="string"?vd(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:a}=Xe._parseInt(r.subarray(2)),{d:o,l:s}=Xe._parseInt(a);if(s.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(t){let e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,r=c=>{let u=c.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),a=n.length/2,o=i.length/2,s=r(a),f=r(o);return`30${r(o+a+4)}02${f}${i}02${s}${n}`}},we=BigInt(0),Gt=BigInt(1),V2=BigInt(2),_0=BigInt(3),q2=BigInt(4);function bd(t){let e=gd(t),{Fp:r}=e,n=e.toBytes||((l,p,y)=>{let m=p.toAffine();return me(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),i=e.fromBytes||(l=>{let p=l.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),m=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:m}});function a(l){let{a:p,b:y}=e,m=r.sqr(l),E=r.mul(m,l);return r.add(r.add(E,r.mul(l,p)),y)}if(!r.eql(r.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function o(l){return typeof l=="bigint"&&we<l&&l<e.n}function s(l){if(!o(l))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(l){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:m,n:E}=e;if(p&&typeof l!="bigint"){if(l instanceof Uint8Array&&(l=xe(l)),typeof l!="string"||!p.includes(l.length))throw new Error("Invalid key");l=l.padStart(y*2,"0")}let b;try{b=typeof l=="bigint"?l:ge(vt("private key",l,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof l}`)}return m&&(b=st(b,E)),s(b),b}let c=new Map;function u(l){if(!(l instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,y,m){if(this.px=p,this.py=y,this.pz=m,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(p){let{x:y,y:m}=p||{};if(!p||!r.isValid(y)||!r.isValid(m))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let E=b=>r.eql(b,r.ZERO);return E(y)&&E(m)?h.ZERO:new h(y,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(m=>m.pz));return p.map((m,E)=>m.toAffine(y[E])).map(h.fromAffine)}static fromHex(p){let y=h.fromAffine(i(vt("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return h.BASE.multiply(f(p))}_setWindowSize(p){this._WINDOW_SIZE=p,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let m=r.sqr(y),E=a(p);if(!r.eql(m,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=p,B=r.eql(r.mul(y,w),r.mul(b,E)),L=r.eql(r.mul(m,w),r.mul(R,E));return B&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,m=r.mul(y,_0),{px:E,py:b,pz:R}=this,w=r.ZERO,B=r.ZERO,L=r.ZERO,N=r.mul(E,E),z=r.mul(b,b),H=r.mul(R,R),V=r.mul(E,b);return V=r.add(V,V),L=r.mul(E,R),L=r.add(L,L),w=r.mul(p,L),B=r.mul(m,H),B=r.add(w,B),w=r.sub(z,B),B=r.add(z,B),B=r.mul(w,B),w=r.mul(V,w),L=r.mul(m,L),H=r.mul(p,H),V=r.sub(N,H),V=r.mul(p,V),V=r.add(V,L),L=r.add(N,N),N=r.add(L,N),N=r.add(N,H),N=r.mul(N,V),B=r.add(B,N),H=r.mul(b,R),H=r.add(H,H),N=r.mul(H,V),w=r.sub(w,N),L=r.mul(H,z),L=r.add(L,L),L=r.add(L,L),new h(w,B,L)}add(p){u(p);let{px:y,py:m,pz:E}=this,{px:b,py:R,pz:w}=p,B=r.ZERO,L=r.ZERO,N=r.ZERO,z=e.a,H=r.mul(e.b,_0),V=r.mul(y,b),Q=r.mul(m,R),at=r.mul(E,w),_t=r.add(y,m),I=r.add(b,R);_t=r.mul(_t,I),I=r.add(V,Q),_t=r.sub(_t,I),I=r.add(y,E);let k=r.add(b,w);return I=r.mul(I,k),k=r.add(V,at),I=r.sub(I,k),k=r.add(m,E),B=r.add(R,w),k=r.mul(k,B),B=r.add(Q,at),k=r.sub(k,B),N=r.mul(z,I),B=r.mul(H,at),N=r.add(B,N),B=r.sub(Q,N),N=r.add(Q,N),L=r.mul(B,N),Q=r.add(V,V),Q=r.add(Q,V),at=r.mul(z,at),I=r.mul(H,I),Q=r.add(Q,at),at=r.sub(V,at),at=r.mul(z,at),I=r.add(I,at),V=r.mul(Q,I),L=r.add(L,V),V=r.mul(k,I),B=r.mul(_t,B),B=r.sub(B,V),V=r.mul(_t,Q),N=r.mul(k,N),N=r.add(N,V),new h(B,L,N)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return x.wNAFCached(this,c,p,y=>{let m=r.invertBatch(y.map(E=>E.pz));return y.map((E,b)=>E.toAffine(m[b])).map(h.fromAffine)})}multiplyUnsafe(p){let y=h.ZERO;if(p===we)return y;if(s(p),p===Gt)return this;let{endo:m}=e;if(!m)return x.unsafeLadder(this,p);let{k1neg:E,k1:b,k2neg:R,k2:w}=m.splitScalar(p),B=y,L=y,N=this;for(;b>we||w>we;)b&Gt&&(B=B.add(N)),w&Gt&&(L=L.add(N)),N=N.double(),b>>=Gt,w>>=Gt;return E&&(B=B.negate()),R&&(L=L.negate()),L=new h(r.mul(L.px,m.beta),L.py,L.pz),B.add(L)}multiply(p){s(p);let y=p,m,E,{endo:b}=e;if(b){let{k1neg:R,k1:w,k2neg:B,k2:L}=b.splitScalar(y),{p:N,f:z}=this.wNAF(w),{p:H,f:V}=this.wNAF(L);N=x.constTimeNegate(R,N),H=x.constTimeNegate(B,H),H=new h(r.mul(H.px,b.beta),H.py,H.pz),m=N.add(H),E=z.add(V)}else{let{p:R,f:w}=this.wNAF(y);m=R,E=w}return h.normalizeZ([m,E])[0]}multiplyAndAddUnsafe(p,y,m){let E=h.BASE,b=(w,B)=>B===we||B===Gt||!w.equals(E)?w.multiplyUnsafe(B):w.multiply(B),R=b(this,y).add(b(p,m));return R.is0()?void 0:R}toAffine(p){let{px:y,py:m,pz:E}=this,b=this.is0();p==null&&(p=b?r.ONE:r.inv(E));let R=r.mul(y,p),w=r.mul(m,p),B=r.mul(E,p);if(b)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:R,y:w}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===Gt)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===Gt?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return xe(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let d=e.nBitLength,x=In(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:f,weierstrassEquation:a,isWithinCurveOrder:o}}function Ed(t){let e=Pr(t);return oe(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function R0(t){let e=Ed(t),{Fp:r,n}=e,i=r.BYTES+1,a=2*r.BYTES+1;function o(I){return we<I&&I<r.ORDER}function s(I){return st(I,n)}function f(I){return An(I,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:d}=bd({...e,toBytes(I,k,_){let D=k.toAffine(),A=r.toBytes(D.x),K=me;return _?K(Uint8Array.from([k.hasEvenY()?2:3]),A):K(Uint8Array.from([4]),A,r.toBytes(D.y))},fromBytes(I){let k=I.length,_=I[0],D=I.subarray(1);if(k===i&&(_===2||_===3)){let A=ge(D);if(!o(A))throw new Error("Point is not on curve");let K=h(A),O=r.sqrt(K),q=(O&Gt)===Gt;return(_&1)===1!==q&&(O=r.neg(O)),{x:A,y:O}}else if(k===a&&_===4){let A=r.fromBytes(D.subarray(0,r.BYTES)),K=r.fromBytes(D.subarray(r.BYTES,2*r.BYTES));return{x:A,y:K}}else throw new Error(`Point of length ${k} was invalid. Expected ${i} compressed bytes or ${a} uncompressed bytes`)}}),x=I=>xe(Ne(I,e.nByteLength));function l(I){let k=n>>Gt;return I>k}function p(I){return l(I)?s(-I):I}let y=(I,k,_)=>ge(I.slice(k,_));class m{constructor(k,_,D){this.r=k,this.s=_,this.recovery=D,this.assertValidity()}static fromCompact(k){let _=e.nByteLength;return k=vt("compactSignature",k,_*2),new m(y(k,0,_),y(k,_,2*_))}static fromDER(k){let{r:_,s:D}=Xe.toSig(vt("DER",k));return new m(_,D)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(k){return new m(this.r,this.s,k)}recoverPublicKey(k){let{r:_,s:D,recovery:A}=this,K=L(vt("msgHash",k));if(A==null||![0,1,2,3].includes(A))throw new Error("recovery id invalid");let O=A===2||A===3?_+e.n:_;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let q=A&1?"03":"02",Z=c.fromHex(q+x(O)),X=f(O),nt=s(-K*X),J=s(D*X),et=c.BASE.multiplyAndAddUnsafe(Z,nt,J);if(!et)throw new Error("point at infinify");return et.assertValidity(),et}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return He(this.toDERHex())}toDERHex(){return Xe.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return He(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let E={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let I=Wi(e.n);return Mo(e.randomBytes(I),e.n)},precompute(I=8,k=c.BASE){return k._setWindowSize(I),k.multiply(BigInt(3)),k}};function b(I,k=!0){return c.fromPrivateKey(I).toRawBytes(k)}function R(I){let k=I instanceof Uint8Array,_=typeof I=="string",D=(k||_)&&I.length;return k?D===i||D===a:_?D===2*i||D===2*a:I instanceof c}function w(I,k,_=!0){if(R(I))throw new Error("first arg must be private key");if(!R(k))throw new Error("second arg must be public key");return c.fromHex(k).multiply(u(I)).toRawBytes(_)}let B=e.bits2int||function(I){let k=ge(I),_=I.length*8-e.nBitLength;return _>0?k>>BigInt(_):k},L=e.bits2int_modN||function(I){return s(B(I))},N=kr(e.nBitLength);function z(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(we<=I&&I<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ne(I,e.nByteLength)}function H(I,k,_=V){if(["recovered","canonical"].some(xt=>xt in _))throw new Error("sign() legacy options not supported");let{hash:D,randomBytes:A}=e,{lowS:K,prehash:O,extraEntropy:q}=_;K==null&&(K=!0),I=vt("msgHash",I),O&&(I=vt("prehashed msgHash",D(I)));let Z=L(I),X=u(k),nt=[z(X),z(Z)];if(q!=null){let xt=q===!0?A(r.BYTES):q;nt.push(vt("extraEntropy",xt))}let J=me(...nt),et=Z;function wt(xt){let Rt=B(xt);if(!d(Rt))return;let Lt=f(Rt),St=c.BASE.multiply(Rt).toAffine(),Dt=s(St.x);if(Dt===we)return;let ue=s(Lt*s(et+Dt*X));if(ue===we)return;let Ue=(St.x===Dt?0:2)|Number(St.y&Gt),br=ue;return K&&l(ue)&&(br=p(ue),Ue^=1),new m(Dt,br,Ue)}return{seed:J,k2sig:wt}}let V={lowS:e.lowS,prehash:!1},Q={lowS:e.lowS,prehash:!1};function at(I,k,_=V){let{seed:D,k2sig:A}=H(I,k,_),K=e;return Fi(K.hash.outputLen,K.nByteLength,K.hmac)(D,A)}c.BASE._setWindowSize(8);function _t(I,k,_,D=Q){let A=I;if(k=vt("msgHash",k),_=vt("publicKey",_),"strict"in D)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:O}=D,q,Z;try{if(typeof A=="string"||A instanceof Uint8Array)try{q=m.fromDER(A)}catch(St){if(!(St instanceof Xe.Err))throw St;q=m.fromCompact(A)}else if(typeof A=="object"&&typeof A.r=="bigint"&&typeof A.s=="bigint"){let{r:St,s:Dt}=A;q=new m(St,Dt)}else throw new Error("PARSE");Z=c.fromHex(_)}catch(St){if(St.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&q.hasHighS())return!1;O&&(k=e.hash(k));let{r:X,s:nt}=q,J=L(k),et=f(nt),wt=s(J*et),xt=s(X*et),Rt=c.BASE.multiplyAndAddUnsafe(Z,wt,xt)?.toAffine();return Rt?s(Rt.x)===X:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:w,sign:at,verify:_t,ProjectivePoint:c,Signature:m,utils:E}}var Mn=class extends cr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Io(e);let n=Dr(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,a=new Uint8Array(i);a.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<a.length;o++)a[o]^=54;this.iHash.update(a),this.oHash=e.create();for(let o=0;o<a.length;o++)a[o]^=106;this.oHash.update(a),a.fill(0)}update(e){return fr(this),this.iHash.update(e),this}digestInto(e){fr(this),Pi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:a,blockLen:o,outputLen:s}=this;return e=e,e.finished=i,e.destroyed=a,e.blockLen=o,e.outputLen=s,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ba=(t,e,r)=>new Mn(t,e).update(r).digest();ba.create=(t,e)=>new Mn(t,e);function wd(t){return{hash:t,hmac:(e,...r)=>ba(t,e,vn(...r)),randomBytes:ur}}function L0(t,e){let r=n=>R0({...t,...wd(n)});return Object.freeze({...r(e),create:r})}var k0=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),N0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Bd=BigInt(1),Ea=BigInt(2),D0=(t,e)=>(t+e/Ea)/e;function Sd(t){let e=k0,r=BigInt(3),n=BigInt(6),i=BigInt(11),a=BigInt(22),o=BigInt(23),s=BigInt(44),f=BigInt(88),c=t*t*t%e,u=c*c*t%e,h=pt(u,r,e)*u%e,d=pt(h,r,e)*u%e,x=pt(d,Ea,e)*c%e,l=pt(x,i,e)*x%e,p=pt(l,a,e)*l%e,y=pt(p,s,e)*p%e,m=pt(y,f,e)*y%e,E=pt(m,s,e)*p%e,b=pt(E,r,e)*u%e,R=pt(b,o,e)*l%e,w=pt(R,n,e)*c%e,B=pt(w,Ea,e);if(!wa.eql(wa.sqr(B),t))throw new Error("Cannot find square root");return B}var wa=Cn(k0,void 0,void 0,{sqrt:Sd}),Be=L0({a:BigInt(0),b:BigInt(7),Fp:wa,n:N0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=N0,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Bd*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,o=BigInt("0x100000000000000000000000000000000"),s=D0(a*t,e),f=D0(-n*t,e),c=st(t-s*r-f*i,e),u=st(-s*n-f*a,e),h=c>o,d=u>o;if(h&&(c=e-c),d&&(u=e-u),c>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:d,k2:u}}}},T0),j2=BigInt(0);var tx=Be.ProjectivePoint;function P0(){return Be.utils.randomPrivateKey()}async function U0(t,e){let{digest:r}=await Mt.digest(e instanceof Uint8Array?e:e.subarray());try{return Be.sign(r,t).toDERRawBytes()}catch(n){throw new F(String(n),"ERR_INVALID_INPUT")}}async function K0(t,e,r){try{let{digest:n}=await Mt.digest(r instanceof Uint8Array?r:r.subarray());return Be.verify(e,n,t)}catch(n){throw new F(String(n),"ERR_INVALID_INPUT")}}function O0(t){return Be.ProjectivePoint.fromHex(t).toRawBytes(!0)}function M0(t){try{Be.getPublicKey(t,!0)}catch(e){throw new F(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Ba(t){try{Be.ProjectivePoint.fromHex(t)}catch(e){throw new F(String(e),"ERR_INVALID_PUBLIC_KEY")}}function V0(t){try{return Be.getPublicKey(t,!0)}catch(e){throw new F(String(e),"ERR_INVALID_PRIVATE_KEY")}}var zr=class{_key;constructor(e){Ba(e),this._key=e}async verify(e,r){return K0(this._key,r,e)}marshal(){return O0(this._key)}get bytes(){return Jt.encode({Type:ut.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Zt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}},Gr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??V0(e),M0(this._key),Ba(this._publicKey)}async sign(e){return U0(this._key,e)}get public(){return new zr(this._publicKey)}marshal(){return this._key}get bytes(){return jt.encode({Type:ut.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Zt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Mt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return yt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return pr(this.bytes,e);throw new F(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Cd(t){return new Gr(t)}function Id(t){return new zr(t)}async function Td(){let t=P0();return new Gr(t)}var ce={rsa:ma,ed25519:la,secp256k1:Sa};function Aa(t){let e=Object.keys(ce).join(" / ");return new F(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ca(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return ce[t];throw Aa(t)}async function _d(t,e){return Ca(t).generateKeyPair(e??2048)}async function Rd(t,e,r){if(t.toLowerCase()!=="ed25519")throw new F("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return ha(e)}function Ld(t){let e=Jt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case ut.RSA:return ce.rsa.unmarshalRsaPublicKey(r);case ut.Ed25519:return ce.ed25519.unmarshalEd25519PublicKey(r);case ut.Secp256k1:return ce.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Aa(e.Type??"unknown")}}function Nd(t,e){return e=(e??"rsa").toLowerCase(),Ca(e),t.bytes}async function q0(t){let e=jt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case ut.RSA:return ce.rsa.unmarshalRsaPrivateKey(r);case ut.Ed25519:return ce.ed25519.unmarshalEd25519PrivateKey(r);case ut.Secp256k1:return ce.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Aa(e.Type??"RSA")}}function Dd(t,e){return e=(e??"rsa").toLowerCase(),Ca(e),t.bytes}async function kd(t,e){try{let i=await u0(t,e);return await q0(i)}catch{}let r=Vn.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new F("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=Vn.default.asn1.toDer(Vn.default.pki.privateKeyToAsn1(r));return n=Bt(n.getBytes(),"ascii"),ce.rsa.unmarshalRsaPrivateKey(n)}var H0=Nt(Ai(),1),z0=Nt(bt(),1),F0={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Ta(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let s=Object.keys(F0).join(" / ");throw new F(`Hash '${i}' is unknown or not supported. Must be ${s}`,"ERR_UNSUPPORTED_HASH_TYPE")}let a=F0[i],o=(0,H0.default)(t,e,r,n,a);return z0.default.encode64(o,null)}return af(Pd);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
