(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var xu=Object.create;var On=Object.defineProperty;var mu=Object.getOwnPropertyDescriptor;var bu=Object.getOwnPropertyNames;var vu=Object.getPrototypeOf,wu=Object.prototype.hasOwnProperty;var ht=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),_t=(t,e)=>{for(var r in e)On(t,r,{get:e[r],enumerable:!0})},ha=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of bu(e))!wu.call(t,i)&&i!==r&&On(t,i,{get:()=>e[i],enumerable:!(n=mu(e,i))||n.enumerable});return t};var zt=(t,e,r)=>(r=t!=null?xu(vu(t)):{},ha(e||!t||!t.__esModule?On(r,"default",{value:t,enumerable:!0}):r,t)),Eu=t=>ha(On({},"__esModule",{value:!0}),t);var xa=ht((og,ga)=>{"use strict";function ya(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Lu(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return ya(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),ya(new i,r)}}ga.exports=Lu});var lt=ht((h2,m0)=>{m0.exports={options:{usePureJavaScript:!1}}});var w0=ht((l2,v0)=>{var ks={};v0.exports=ks;var b0={};ks.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=il(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,f=t[i];c<a.length;++c)f+=a[c]<<8,a[c]=f%s,f=f/s|0;for(;f>0;)a.push(f%s),f=f/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};ks.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=b0[e];if(!r){r=b0[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<o.length;++c)f+=o[c]*i,o[c]=f&255,f>>=8;for(;f>0;)o.push(f&255),f>>=8}for(var u=0;t[u]===s&&u<t.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function il(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Bt=ht((d2,A0)=>{var E0=lt(),S0=w0(),b=A0.exports=E0.util=E0.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){b.nextTick=process.nextTick,typeof setImmediate=="function"?b.setImmediate=setImmediate:b.setImmediate=b.nextTick;return}if(typeof setImmediate=="function"){b.setImmediate=function(){return setImmediate.apply(void 0,arguments)},b.nextTick=function(a){return setImmediate(a)};return}if(b.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var o=a,t="forge.setImmediate",e=[];b.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var s=b.setImmediate;b.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}b.nextTick=b.setImmediate})();b.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;b.globalScope=function(){return b.isNodejs?globalThis:typeof self>"u"?window:self}();b.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};b.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};b.isArrayBufferView=function(t){return t&&b.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function yn(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}b.ByteBuffer=Ps;function Ps(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(b.isArrayBuffer(t)||b.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ps||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}b.ByteStringBuffer=Ps;var sl=4096;b.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>sl&&(this.data.substr(0,1),this._constructedStringLength=0)};b.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};b.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};b.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};b.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};b.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};b.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(b.encodeUtf8(t))};b.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};b.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};b.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};b.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};b.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};b.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};b.ByteStringBuffer.prototype.putInt=function(t,e){yn(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};b.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};b.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};b.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};b.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};b.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};b.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};b.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};b.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};b.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};b.ByteStringBuffer.prototype.getInt=function(t){yn(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};b.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};b.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};b.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};b.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};b.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};b.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};b.ByteStringBuffer.prototype.copy=function(){var t=b.createBuffer(this.data);return t.read=this.read,t};b.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};b.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};b.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};b.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};b.ByteStringBuffer.prototype.toString=function(){return b.decodeUtf8(this.bytes())};function ol(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=b.isArrayBuffer(t),n=b.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}b.DataBuffer=ol;b.DataBuffer.prototype.length=function(){return this.write-this.read};b.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};b.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};b.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};b.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};b.DataBuffer.prototype.putBytes=function(t,e){if(b.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(b.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof b.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&b.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof b.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=b.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=b.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};b.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};b.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};b.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};b.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};b.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};b.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};b.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};b.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};b.DataBuffer.prototype.putInt=function(t,e){yn(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};b.DataBuffer.prototype.putSignedInt=function(t,e){return yn(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};b.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};b.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};b.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};b.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};b.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};b.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};b.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};b.DataBuffer.prototype.getInt=function(t){yn(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};b.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};b.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};b.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};b.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};b.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};b.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};b.DataBuffer.prototype.copy=function(){return new b.DataBuffer(this)};b.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};b.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};b.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};b.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};b.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return b.binary.raw.encode(e);if(t==="hex")return b.binary.hex.encode(e);if(t==="base64")return b.binary.base64.encode(e);if(t==="utf8")return b.text.utf8.decode(e);if(t==="utf16")return b.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};b.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=b.encodeUtf8(t)),new b.ByteBuffer(t)};b.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};b.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};b.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};b.bytesToHex=function(t){return b.createBuffer(t).toHex()};b.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var $e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",We=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],B0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";b.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=$e.charAt(i>>2),r+=$e.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=$e.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":$e.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};b.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=We[t.charCodeAt(o++)-43],n=We[t.charCodeAt(o++)-43],i=We[t.charCodeAt(o++)-43],s=We[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};b.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};b.decodeUtf8=function(t){return decodeURIComponent(escape(t))};b.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:S0.encode,decode:S0.decode}};b.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};b.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};b.binary.hex.encode=b.bytesToHex;b.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};b.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=$e.charAt(i>>2),r+=$e.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=$e.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":$e.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};b.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,f=r;c<t.length;)i=We[t.charCodeAt(c++)-43],s=We[t.charCodeAt(c++)-43],o=We[t.charCodeAt(c++)-43],a=We[t.charCodeAt(c++)-43],n[f++]=i<<2|s>>4,o!==64&&(n[f++]=(s&15)<<4|o>>2,a!==64&&(n[f++]=(o&3)<<6|a));return e?f-r:n.subarray(0,f)};b.binary.base58.encode=function(t,e){return b.binary.baseN.encode(t,B0,e)};b.binary.base58.decode=function(t,e){return b.binary.baseN.decode(t,B0,e)};b.text={utf8:{},utf16:{}};b.text.utf8.encode=function(t,e,r){t=b.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};b.text.utf8.decode=function(t){return b.decodeUtf8(String.fromCharCode.apply(null,t))};b.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};b.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};b.deflate=function(t,e,r){if(e=b.decode64(t.deflate(b.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};b.inflate=function(t,e,r){var n=t.inflate(b.encode64(e)).rval;return n===null?null:b.decode64(n)};var Us=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=b.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Ks=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(b.decode64(r))),r},al=function(t,e,r,n){var i=Ks(t,e);i===null&&(i={}),i[r]=n,Us(t,e,i)},cl=function(t,e,r){var n=Ks(t,e);return n!==null&&(n=r in n?n[r]:null),n},fl=function(t,e,r){var n=Ks(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Us(t,e,n)}},ul=function(t,e){Us(t,e,null)},pi=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};b.setItem=function(t,e,r,n,i){pi(al,arguments,i)};b.getItem=function(t,e,r,n){return pi(cl,arguments,n)};b.removeItem=function(t,e,r,n){pi(fl,arguments,n)};b.clearItems=function(t,e,r){pi(ul,arguments,r)};b.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};b.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};b.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-f).toFixed(s).slice(2):"")};b.formatSize=function(t){return t>=1073741824?t=b.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=b.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=b.formatNumber(t/1024,0)+" KiB":t=b.formatNumber(t,0)+" bytes",t};b.bytesFromIP=function(t){return t.indexOf(".")!==-1?b.bytesFromIPv4(t):t.indexOf(":")!==-1?b.bytesFromIPv6(t):null};b.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=b.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};b.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=b.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=b.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};b.bytesToIP=function(t){return t.length===4?b.bytesToIPv4(t):t.length===16?b.bytesToIPv6(t):null};b.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};b.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=b.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};b.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in b&&!t.update)return e(null,b.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return b.cores=navigator.hardwareConcurrency,e(null,b.cores);if(typeof Worker>"u")return b.cores=1,e(null,b.cores);if(typeof Blob>"u")return b.cores=2,e(null,b.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var f=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return b.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,b.cores)}i(c,function(u,h){o.push(s(c,h)),n(o,a-1,c)})}function i(o,a){for(var c=[],f=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===o){for(var g=0;g<o;++g)c[g].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<o;++u)c[u].postMessage(u)}function s(o,a){for(var c=[],f=0;f<o;++f)for(var u=a[f],h=c[f]=[],l=0;l<o;++l)if(f!==l){var g=a[l];(u.st>g.st&&u.st<g.et||g.st>u.st&&g.st<u.et)&&h.push(l)}return c.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var yi=ht((p2,C0)=>{var gn=lt();gn.pki=gn.pki||{};var Os=C0.exports=gn.pki.oids=gn.oids=gn.oids||{};function k(t,e){Os[t]=e,Os[e]=t}function ft(t,e){Os[t]=e}k("1.2.840.113549.1.1.1","rsaEncryption");k("1.2.840.113549.1.1.4","md5WithRSAEncryption");k("1.2.840.113549.1.1.5","sha1WithRSAEncryption");k("1.2.840.113549.1.1.7","RSAES-OAEP");k("1.2.840.113549.1.1.8","mgf1");k("1.2.840.113549.1.1.9","pSpecified");k("1.2.840.113549.1.1.10","RSASSA-PSS");k("1.2.840.113549.1.1.11","sha256WithRSAEncryption");k("1.2.840.113549.1.1.12","sha384WithRSAEncryption");k("1.2.840.113549.1.1.13","sha512WithRSAEncryption");k("1.3.101.112","EdDSA25519");k("1.2.840.10040.4.3","dsa-with-sha1");k("1.3.14.3.2.7","desCBC");k("1.3.14.3.2.26","sha1");k("1.3.14.3.2.29","sha1WithRSASignature");k("2.16.840.1.101.3.4.2.1","sha256");k("2.16.840.1.101.3.4.2.2","sha384");k("2.16.840.1.101.3.4.2.3","sha512");k("2.16.840.1.101.3.4.2.4","sha224");k("2.16.840.1.101.3.4.2.5","sha512-224");k("2.16.840.1.101.3.4.2.6","sha512-256");k("1.2.840.113549.2.2","md2");k("1.2.840.113549.2.5","md5");k("1.2.840.113549.1.7.1","data");k("1.2.840.113549.1.7.2","signedData");k("1.2.840.113549.1.7.3","envelopedData");k("1.2.840.113549.1.7.4","signedAndEnvelopedData");k("1.2.840.113549.1.7.5","digestedData");k("1.2.840.113549.1.7.6","encryptedData");k("1.2.840.113549.1.9.1","emailAddress");k("1.2.840.113549.1.9.2","unstructuredName");k("1.2.840.113549.1.9.3","contentType");k("1.2.840.113549.1.9.4","messageDigest");k("1.2.840.113549.1.9.5","signingTime");k("1.2.840.113549.1.9.6","counterSignature");k("1.2.840.113549.1.9.7","challengePassword");k("1.2.840.113549.1.9.8","unstructuredAddress");k("1.2.840.113549.1.9.14","extensionRequest");k("1.2.840.113549.1.9.20","friendlyName");k("1.2.840.113549.1.9.21","localKeyId");k("1.2.840.113549.1.9.22.1","x509Certificate");k("1.2.840.113549.1.12.10.1.1","keyBag");k("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");k("1.2.840.113549.1.12.10.1.3","certBag");k("1.2.840.113549.1.12.10.1.4","crlBag");k("1.2.840.113549.1.12.10.1.5","secretBag");k("1.2.840.113549.1.12.10.1.6","safeContentsBag");k("1.2.840.113549.1.5.13","pkcs5PBES2");k("1.2.840.113549.1.5.12","pkcs5PBKDF2");k("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");k("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");k("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");k("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");k("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");k("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");k("1.2.840.113549.2.7","hmacWithSHA1");k("1.2.840.113549.2.8","hmacWithSHA224");k("1.2.840.113549.2.9","hmacWithSHA256");k("1.2.840.113549.2.10","hmacWithSHA384");k("1.2.840.113549.2.11","hmacWithSHA512");k("1.2.840.113549.3.7","des-EDE3-CBC");k("2.16.840.1.101.3.4.1.2","aes128-CBC");k("2.16.840.1.101.3.4.1.22","aes192-CBC");k("2.16.840.1.101.3.4.1.42","aes256-CBC");k("2.5.4.3","commonName");k("2.5.4.4","surname");k("2.5.4.5","serialNumber");k("2.5.4.6","countryName");k("2.5.4.7","localityName");k("2.5.4.8","stateOrProvinceName");k("2.5.4.9","streetAddress");k("2.5.4.10","organizationName");k("2.5.4.11","organizationalUnitName");k("2.5.4.12","title");k("2.5.4.13","description");k("2.5.4.15","businessCategory");k("2.5.4.17","postalCode");k("2.5.4.42","givenName");k("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");k("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");k("2.16.840.1.113730.1.1","nsCertType");k("2.16.840.1.113730.1.13","nsComment");ft("2.5.29.1","authorityKeyIdentifier");ft("2.5.29.2","keyAttributes");ft("2.5.29.3","certificatePolicies");ft("2.5.29.4","keyUsageRestriction");ft("2.5.29.5","policyMapping");ft("2.5.29.6","subtreesConstraint");ft("2.5.29.7","subjectAltName");ft("2.5.29.8","issuerAltName");ft("2.5.29.9","subjectDirectoryAttributes");ft("2.5.29.10","basicConstraints");ft("2.5.29.11","nameConstraints");ft("2.5.29.12","policyConstraints");ft("2.5.29.13","basicConstraints");k("2.5.29.14","subjectKeyIdentifier");k("2.5.29.15","keyUsage");ft("2.5.29.16","privateKeyUsagePeriod");k("2.5.29.17","subjectAltName");k("2.5.29.18","issuerAltName");k("2.5.29.19","basicConstraints");ft("2.5.29.20","cRLNumber");ft("2.5.29.21","cRLReason");ft("2.5.29.22","expirationDate");ft("2.5.29.23","instructionCode");ft("2.5.29.24","invalidityDate");ft("2.5.29.25","cRLDistributionPoints");ft("2.5.29.26","issuingDistributionPoint");ft("2.5.29.27","deltaCRLIndicator");ft("2.5.29.28","issuingDistributionPoint");ft("2.5.29.29","certificateIssuer");ft("2.5.29.30","nameConstraints");k("2.5.29.31","cRLDistributionPoints");k("2.5.29.32","certificatePolicies");ft("2.5.29.33","policyMappings");ft("2.5.29.34","policyConstraints");k("2.5.29.35","authorityKeyIdentifier");ft("2.5.29.36","policyConstraints");k("2.5.29.37","extKeyUsage");ft("2.5.29.46","freshestCRL");ft("2.5.29.54","inhibitAnyPolicy");k("1.3.6.1.4.1.11129.2.4.2","timestampList");k("1.3.6.1.5.5.7.1.1","authorityInfoAccess");k("1.3.6.1.5.5.7.3.1","serverAuth");k("1.3.6.1.5.5.7.3.2","clientAuth");k("1.3.6.1.5.5.7.3.3","codeSigning");k("1.3.6.1.5.5.7.3.4","emailProtection");k("1.3.6.1.5.5.7.3.8","timeStamping")});var mn=ht((y2,T0)=>{var xt=lt();Bt();yi();var F=T0.exports=xt.asn1=xt.asn1||{};F.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};F.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};F.create=function(t,e,r,n,i){if(xt.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||xt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=F.copy(a)),a};F.copy=function(t,e){var r;if(xt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(F.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:F.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};F.equals=function(t,e,r){if(xt.util.isArray(t)){if(!xt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!F.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&F.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};F.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function xn(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var hl=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;xn(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};F.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=xt.util.createBuffer(t));var r=t.length(),n=gi(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function gi(t,e,r,n){var i;xn(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=hl(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(s&32)===32;if(l)if(u=[],c===void 0)for(;;){if(xn(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}i=t.length(),u.push(gi(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),u.push(gi(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(u===void 0&&o===F.Class.UNIVERSAL&&a===F.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&o===F.Class.UNIVERSAL&&a===F.Type.BITSTRING&&c>1){var g=t.read,d=e,p=0;if(a===F.Type.BITSTRING&&(xn(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},x=gi(t,e,r+1,y),v=i-t.length();e-=v,a==F.Type.BITSTRING&&v++;var m=x.tagClass;v===c&&(m===F.Class.UNIVERSAL||m===F.Class.CONTEXT_SPECIFIC)&&(u=[x])}catch{}u===void 0&&(t.read=g,e=d)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===F.Type.BMPSTRING)for(u="";c>0;c-=2)xn(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var A=h===void 0?null:{bitStringContents:h};return F.create(o,a,l,u,A)}F.toDer=function(t){var e=xt.util.createBuffer(),r=t.tagClass|t.type,n=xt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=F.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(F.toDer(t.value[s]))}else if(t.type===F.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===F.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};F.oidToDer=function(t){var e=t.split("."),r=xt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};F.derToOid=function(t){var e;typeof t=="string"&&(t=xt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};F.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};F.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var g=parseInt(t.substr(h+1,2),10),d=parseInt(t.substr(h+4,2),10);f=g*60+d,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};F.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};F.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};F.integerToDer=function(t){var e=xt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};F.derToInteger=function(t){typeof t=="string"&&(t=xt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};F.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&xt.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=F.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var I0=/[^\\u0000-\\u00ff]/;F.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case F.Class.UNIVERSAL:n+="Universal:";break;case F.Class.APPLICATION:n+="Application:";break;case F.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case F.Class.PRIVATE:n+="Private:";break}if(t.tagClass===F.Class.UNIVERSAL)switch(n+=t.type,t.type){case F.Type.NONE:n+=" (None)";break;case F.Type.BOOLEAN:n+=" (Boolean)";break;case F.Type.INTEGER:n+=" (Integer)";break;case F.Type.BITSTRING:n+=" (Bit string)";break;case F.Type.OCTETSTRING:n+=" (Octet string)";break;case F.Type.NULL:n+=" (Null)";break;case F.Type.OID:n+=" (Object Identifier)";break;case F.Type.ODESC:n+=" (Object Descriptor)";break;case F.Type.EXTERNAL:n+=" (External or Instance of)";break;case F.Type.REAL:n+=" (Real)";break;case F.Type.ENUMERATED:n+=" (Enumerated)";break;case F.Type.EMBEDDED:n+=" (Embedded PDV)";break;case F.Type.UTF8:n+=" (UTF8)";break;case F.Type.ROID:n+=" (Relative Object Identifier)";break;case F.Type.SEQUENCE:n+=" (Sequence)";break;case F.Type.SET:n+=" (Set)";break;case F.Type.PRINTABLESTRING:n+=" (Printable String)";break;case F.Type.IA5String:n+=" (IA5String (ASCII))";break;case F.Type.UTCTIME:n+=" (UTC time)";break;case F.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case F.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=F.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===F.Type.OID){var c=F.derToOid(t.value);n+=c,xt.pki&&xt.pki.oids&&c in xt.pki.oids&&(n+=" ("+xt.pki.oids[c]+") ")}if(t.type===F.Type.INTEGER)try{n+=F.derToInteger(t.value)}catch{n+="0x"+xt.util.bytesToHex(t.value)}else if(t.type===F.Type.BITSTRING){if(t.value.length>1?n+="0x"+xt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===F.Type.OCTETSTRING)I0.test(t.value)||(n+="("+t.value+") "),n+="0x"+xt.util.bytesToHex(t.value);else if(t.type===F.Type.UTF8)try{n+=xt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+xt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===F.Type.PRINTABLESTRING||t.type===F.Type.IA5String?n+=t.value:I0.test(t.value)?n+="0x"+xt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Fs=ht((g2,_0)=>{var Nt=lt();Bt();_0.exports=Nt.cipher=Nt.cipher||{};Nt.cipher.algorithms=Nt.cipher.algorithms||{};Nt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Nt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Nt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Nt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Nt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Nt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Nt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Nt.cipher.algorithms[t]=e};Nt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Nt.cipher.algorithms?Nt.cipher.algorithms[t]:null};var Ms=Nt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Ms.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Nt.util.createBuffer(),this.output=t.output||Nt.util.createBuffer(),this.mode.start(e)};Ms.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Ms.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Hs=ht((x2,L0)=>{var Dt=lt();Bt();Dt.cipher=Dt.cipher||{};var nt=L0.exports=Dt.cipher.modes=Dt.cipher.modes||{};nt.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};nt.ecb.prototype.start=function(t){};nt.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};nt.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};nt.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};nt.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};nt.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};nt.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=xi(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};nt.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};nt.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};nt.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};nt.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};nt.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};nt.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=xi(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};nt.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=xi(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.ofb.prototype.decrypt=nt.ofb.prototype.encrypt;nt.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};nt.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=xi(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}mi(this._inBlock)};nt.ctr.prototype.decrypt=nt.ctr.prototype.encrypt;nt.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};nt.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Dt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Dt.util.createBuffer(t.additionalData):r=Dt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Dt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Vs(n*8)))}this._inBlock=this._j0.slice(0),mi(this._inBlock),this._partialBytes=0,r=Dt.util.createBuffer(r),this._aDataLength=Vs(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};nt.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),mi(this._inBlock)};nt.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),mi(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};nt.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Dt.util.createBuffer();var n=this._aDataLength.concat(Vs(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};nt.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};nt.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};nt.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};nt.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};nt.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,f=(n-1-o%n)*e;a[c]=1<<e-1<<f,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};nt.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var f=i[s^n];i[s]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return i};function xi(t,e){if(typeof t=="string"&&(t=Dt.util.createBuffer(t)),Dt.util.isArray(t)&&t.length>4){var r=t;t=Dt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Dt.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function mi(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Vs(t){return[t/4294967296|0,t&4294967295]}});var $s=ht((m2,k0)=>{var pt=lt();Fs();Hs();Bt();k0.exports=pt.aes=pt.aes||{};pt.aes.startEncrypting=function(t,e,r,n){var i=bi({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};pt.aes.createEncryptionCipher=function(t,e){return bi({key:t,output:null,decrypt:!1,mode:e})};pt.aes.startDecrypting=function(t,e,r,n){var i=bi({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};pt.aes.createDecryptionCipher=function(t,e){return bi({key:t,output:null,decrypt:!0,mode:e})};pt.aes.Algorithm=function(t,e){Gs||N0();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return zs(r._w,n,i,!1)},decrypt:function(n,i){return zs(r._w,n,i,!0)}}}),r._init=!1};pt.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=pt.util.createBuffer(e);else if(pt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=pt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!pt.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!pt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=D0(e,t.decrypt&&!o),this._init=!0}};pt.aes._expandKey=function(t,e){return Gs||N0(),D0(t,e)};pt.aes._updateBlock=zs;Pr("AES-ECB",pt.cipher.modes.ecb);Pr("AES-CBC",pt.cipher.modes.cbc);Pr("AES-CFB",pt.cipher.modes.cfb);Pr("AES-OFB",pt.cipher.modes.ofb);Pr("AES-CTR",pt.cipher.modes.ctr);Pr("AES-GCM",pt.cipher.modes.gcm);function Pr(t,e){var r=function(){return new pt.aes.Algorithm(t,e)};pt.cipher.registerAlgorithm(t,r)}var Gs=!1,kr=4,$t,qs,R0,ar,ue;function N0(){Gs=!0,R0=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;$t=new Array(256),qs=new Array(256),ar=new Array(4),ue=new Array(4);for(var e=0;e<4;++e)ar[e]=new Array(256),ue[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,f,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,$t[r]=a,qs[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],f=c<<24^a<<16^a<<8^(a^c),u=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)ar[h][r]=f,ue[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function D0(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=kr*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=$t[n>>>16&255]<<24^$t[n>>>8&255]<<16^$t[n&255]<<8^$t[n>>>24]^R0[i]<<24,i++):s>6&&c%s===4&&(n=$t[n>>>24]<<24^$t[n>>>16&255]<<16^$t[n>>>8&255]<<8^$t[n&255]),r[c]=r[c-s]^n;if(e){var f,u=ue[0],h=ue[1],l=ue[2],g=ue[3],d=r.slice(0);a=r.length;for(var c=0,p=a-kr;c<a;c+=kr,p-=kr)if(c===0||c===a-kr)d[c]=r[p],d[c+1]=r[p+3],d[c+2]=r[p+2],d[c+3]=r[p+1];else for(var y=0;y<kr;++y)f=r[p+y],d[c+(3&-y)]=u[$t[f>>>24]]^h[$t[f>>>16&255]]^l[$t[f>>>8&255]]^g[$t[f&255]];r=d}return r}function zs(t,e,r,n){var i=t.length/4-1,s,o,a,c,f;n?(s=ue[0],o=ue[1],a=ue[2],c=ue[3],f=qs):(s=ar[0],o=ar[1],a=ar[2],c=ar[3],f=$t);var u,h,l,g,d,p,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],g=e[n?1:3]^t[3];for(var x=3,v=1;v<i;++v)d=s[u>>>24]^o[h>>>16&255]^a[l>>>8&255]^c[g&255]^t[++x],p=s[h>>>24]^o[l>>>16&255]^a[g>>>8&255]^c[u&255]^t[++x],y=s[l>>>24]^o[g>>>16&255]^a[u>>>8&255]^c[h&255]^t[++x],g=s[g>>>24]^o[u>>>16&255]^a[h>>>8&255]^c[l&255]^t[++x],u=d,h=p,l=y;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[g&255]^t[++x],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[g>>>8&255]<<8^f[u&255]^t[++x],r[2]=f[l>>>24]<<24^f[g>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++x],r[n?1:3]=f[g>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++x]}function bi(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=pt.cipher.createDecipher(r,t.key):n=pt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof pt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var K0=ht((b2,U0)=>{var vt=lt();Fs();Hs();Bt();U0.exports=vt.des=vt.des||{};vt.des.startEncrypting=function(t,e,r,n){var i=vi({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};vt.des.createEncryptionCipher=function(t,e){return vi({key:t,output:null,decrypt:!1,mode:e})};vt.des.startDecrypting=function(t,e,r,n){var i=vi({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};vt.des.createDecryptionCipher=function(t,e){return vi({key:t,output:null,decrypt:!0,mode:e})};vt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return P0(r._keys,n,i,!1)},decrypt:function(n,i){return P0(r._keys,n,i,!0)}}}),r._init=!1};vt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=vt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=vl(e),this._init=!0}};pe("DES-ECB",vt.cipher.modes.ecb);pe("DES-CBC",vt.cipher.modes.cbc);pe("DES-CFB",vt.cipher.modes.cfb);pe("DES-OFB",vt.cipher.modes.ofb);pe("DES-CTR",vt.cipher.modes.ctr);pe("3DES-ECB",vt.cipher.modes.ecb);pe("3DES-CBC",vt.cipher.modes.cbc);pe("3DES-CFB",vt.cipher.modes.cfb);pe("3DES-OFB",vt.cipher.modes.ofb);pe("3DES-CTR",vt.cipher.modes.ctr);function pe(t,e){var r=function(){return new vt.des.Algorithm(t,e)};vt.cipher.registerAlgorithm(t,r)}var ll=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],dl=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],pl=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],yl=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],gl=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],xl=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],ml=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],bl=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function vl(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],x=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],v=0,m,A=0;A<p;A++){var S=t.getInt32(),B=t.getInt32();m=(S>>>4^B)&252645135,B^=m,S^=m<<4,m=(B>>>-16^S)&65535,S^=m,B^=m<<-16,m=(S>>>2^B)&858993459,B^=m,S^=m<<2,m=(B>>>-16^S)&65535,S^=m,B^=m<<-16,m=(S>>>1^B)&1431655765,B^=m,S^=m<<1,m=(B>>>8^S)&16711935,S^=m,B^=m<<8,m=(S>>>1^B)&1431655765,B^=m,S^=m<<1,m=S<<8|B>>>20&240,S=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=m;for(var R=0;R<x.length;++R){x[R]?(S=S<<2|S>>>26,B=B<<2|B>>>26):(S=S<<1|S>>>27,B=B<<1|B>>>27),S&=-15,B&=-15;var _=e[S>>>28]|r[S>>>24&15]|n[S>>>20&15]|i[S>>>16&15]|s[S>>>12&15]|o[S>>>8&15]|a[S>>>4&15],O=c[B>>>28]|f[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|g[B>>>8&15]|d[B>>>4&15];m=(O>>>16^_)&65535,y[v++]=_^m,y[v++]=O^m<<16}}return y}function P0(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=s[f+1],h=s[f+2],l=s[f];l!=u;l+=h){var g=c^t[l],d=(c>>>4|c<<28)^t[l+1];o=a,a=c,c=o^(dl[g>>>24&63]|yl[g>>>16&63]|xl[g>>>8&63]|bl[g&63]|ll[d>>>24&63]|pl[d>>>16&63]|gl[d>>>8&63]|ml[d&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function vi(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=vt.cipher.createDecipher(r,t.key):n=vt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof vt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var cr=ht((v2,O0)=>{var wi=lt();O0.exports=wi.md=wi.md||{};wi.md.algorithms=wi.md.algorithms||{}});var F0=ht((w2,M0)=>{var Ne=lt();cr();Bt();var wl=M0.exports=Ne.hmac=Ne.hmac||{};wl.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Ne.md.algorithms)e=Ne.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Ne.util.createBuffer(o);else if(Ne.util.isArray(o)){var a=o;o=Ne.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var f=o.length();f>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Ne.util.createBuffer(),n=Ne.util.createBuffer(),f=o.length();for(var c=0;c<f;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<e.blockLength)for(var a=e.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Ei=ht(()=>{});var H0=ht((B2,V0)=>{var Wt=lt();F0();cr();Bt();var El=Wt.pkcs5=Wt.pkcs5||{},De;Wt.util.isNodejs&&!Wt.options.usePureJavaScript&&(De=Ei());V0.exports=Wt.pbkdf2=El.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Wt.util.isNodejs&&!Wt.options.usePureJavaScript&&De.pbkdf2&&(i===null||typeof i!="object")&&(De.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?De.pbkdf2Sync.length===4?De.pbkdf2(t,e,r,n,function(m,A){if(m)return s(m);s(null,A.toString("binary"))}):De.pbkdf2(t,e,r,n,i,function(m,A){if(m)return s(m);s(null,A.toString("binary"))}):De.pbkdf2Sync.length===4?De.pbkdf2Sync(t,e,r,n).toString("binary"):De.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Wt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Wt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),f=n-(c-1)*o,u=Wt.hmac.create();u.start(i,t);var h="",l,g,d;if(!s){for(var p=1;p<=c;++p){u.start(null,null),u.update(e),u.update(Wt.util.int32ToBytes(p)),l=d=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(d),g=u.digest().getBytes(),l=Wt.util.xorBytes(l,g,o),d=g;h+=p<c?l:l.substr(0,f)}return h}var p=1,y;function x(){if(p>c)return s(null,h);u.start(null,null),u.update(e),u.update(Wt.util.int32ToBytes(p)),l=d=u.digest().getBytes(),y=2,v()}function v(){if(y<=r)return u.start(null,null),u.update(d),g=u.digest().getBytes(),l=Wt.util.xorBytes(l,g,o),d=g,++y,Wt.util.setImmediate(v);h+=p<c?l:l.substr(0,f),++p,x()}x()}});var G0=ht((A2,z0)=>{var Bi=lt();Bt();var q0=z0.exports=Bi.pem=Bi.pem||{};q0.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Si(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Si(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Si(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Si(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Bi.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};q0.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Bi.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(i),f=0;s&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(s=u.match(n),s){for(var g={name:s[1],values:[]},d=s[2].split(","),p=0;p<d.length;++p)g.values.push(Sl(d[p]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Si(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function Sl(t){return t.replace(/^\s+/,"")}});var Q0=ht((C2,X0)=>{var ye=lt();cr();Bt();var W0=X0.exports=ye.sha256=ye.sha256||{};ye.md.sha256=ye.md.algorithms.sha256=W0;W0.create=function(){Y0||Bl();var t=null,e=ye.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=ye.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ye.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),$0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=ye.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Ws.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};$0(h,r,i);var l=ye.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Ws=null,Y0=!1,Z0=null;function Bl(){Ws="\x80",Ws+=ye.util.fillString("\0",64),Z0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Y0=!0}function $0(t,e,r){for(var n,i,s,o,a,c,f,u,h,l,g,d,p,y,x,v=r.length();v>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[f]=n+e[f-7]+i+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,g=t.h3,d=t.h4,p=t.h5,y=t.h6,x=t.h7,f=0;f<64;++f)o=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=y^d&(p^y),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=x+o+a+Z0[f]+e[f],i=s+c,x=y,y=p,p=d,d=g+n>>>0,g=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+g|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+x|0,v-=64}}});var j0=ht((I2,J0)=>{var ge=lt();Bt();var Ai=null;ge.util.isNodejs&&!ge.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ai=Ei());var Al=J0.exports=ge.prng=ge.prng||{};Al.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,g=e.plugin.formatKey,d=e.plugin.formatSeed,p=ge.util.createBuffer();e.key=null,y();function y(x){if(x)return u(x);if(p.length()>=f)return u(null,p.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return ge.util.nextTick(function(){s(y)});var v=h(e.key,e.seed);e.generated+=v.length,p.putBytes(v),e.key=g(h(e.key,l(e.seed))),e.seed=d(h(e.key,e.seed)),ge.util.setImmediate(y)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var d=ge.util.createBuffer();d.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&o();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=l(u(e.key,h(e.seed))),e.seed=g(u(e.key,e.seed))}return d.getBytes(f)};function s(f){if(e.pools[0].messageLength>=32)return a(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),a(),f()})}function o(){if(e.pools[0].messageLength>=32)return a();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=ge.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(S){return l.getRandomValues(S)});var g=ge.util.createBuffer();if(u)for(;g.length()<f;){var d=Math.max(1,Math.min(f-g.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var y=0;y<p.length;++y)g.putInt32(p[y])}catch(S){if(!(typeof QuotaExceededError<"u"&&S instanceof QuotaExceededError))throw S}}if(g.length()<f)for(var x,v,m,A=Math.floor(Math.random()*65536);g.length()<f;){v=16807*(A&65535),x=16807*(A>>16),v+=(x&32767)<<16,v+=x>>15,v=(v&2147483647)+(v>>31),A=v&4294967295;for(var y=0;y<3;++y)m=A>>>(y<<3),m^=Math.floor(Math.random()*256),g.putByte(m&255)}return g.getBytes(f)}return Ai?(e.seedFile=function(f,u){Ai.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return Ai.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function g(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",g),l(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(g,d){f.postMessage({forge:{prng:{err:g,bytes:d}}})})};f.addEventListener("message",u)}},e}});var bn=ht((T2,Ys)=>{var kt=lt();$s();Q0();j0();Bt();(function(){if(kt.random&&kt.random.getBytes){Ys.exports=kt.random;return}(function(t){var e={},r=new Array(4),n=kt.util.createBuffer();e.formatKey=function(h){var l=kt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),kt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=kt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return kt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=kt.md.sha256;function i(){var h=kt.prng.create(e);return h.getBytes=function(l,g){return h.generate(l,g)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=kt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),kt.options.usePureJavaScript||!kt.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}s.collect(f),f=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!kt.random)kt.random=s;else for(var u in s)kt.random[u]=s[u];kt.random.createInstance=i,Ys.exports=kt.random})(typeof jQuery<"u"?jQuery:null)})()});var nc=ht((_2,rc)=>{var Yt=lt();Bt();var Zs=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],tc=[1,2,3,5],Cl=function(t,e){return t<<e&65535|(t&65535)>>16-e},Il=function(t,e){return(t&65535)>>e|t<<16-e&65535};rc.exports=Yt.rc2=Yt.rc2||{};Yt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Yt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Zs[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Zs[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Zs[r.at(a+1)^r.at(a+s)]);return r};var ec=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,f,u,h=[];for(t=Yt.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(a=function(d){for(f=0;f<4;f++)d[f]+=h[u]+(d[(f+3)%4]&d[(f+2)%4])+(~d[(f+3)%4]&d[(f+1)%4]),d[f]=Cl(d[f],tc[f]),u++},c=function(d){for(f=0;f<4;f++)d[f]+=h[d[(f+3)%4]&63]}):(a=function(d){for(f=3;f>=0;f--)d[f]=Il(d[f],tc[f]),d[f]-=h[u]+(d[(f+3)%4]&d[(f+2)%4])+(~d[(f+3)%4]&d[(f+1)%4]),u--},c=function(d){for(f=3;f>=0;f--)d[f]-=h[d[(f+3)%4]&63]});var l=function(d){var p=[];for(f=0;f<4;f++){var y=i.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var x=0;x<d.length;x++)for(var v=0;v<d[x][0];v++)d[x][1](p);for(f=0;f<4;f++)o!==null&&(r?o.putInt16Le(p[f]):p[f]^=o.getInt16Le()),s.putInt16Le(p[f])},g=null;return g={start:function(d,p){d&&typeof d=="string"&&(d=Yt.util.createBuffer(d)),n=!1,i=Yt.util.createBuffer(),s=p||new Yt.util.createBuffer,o=d,g.output=s},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,g.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,s,!r);else{var x=s.length(),v=s.at(x-1);v>x?p=!1:s.truncate(v)}return p}},g};Yt.rc2.startEncrypting=function(t,e,r){var n=Yt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Yt.rc2.createEncryptionCipher=function(t,e){return ec(t,e,!0)};Yt.rc2.startDecrypting=function(t,e,r){var n=Yt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Yt.rc2.createDecryptionCipher=function(t,e){return ec(t,e,!1)}});var Ti=ht((L2,hc)=>{var Xs=lt();hc.exports=Xs.jsbn=Xs.jsbn||{};var ke,Tl=0xdeadbeefcafe,ic=(Tl&16777215)==15715070;function D(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Xs.jsbn.BigInteger=D;function ot(){return new D(null)}function _l(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function Ll(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=a*c+f*o;c=o*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+a*f+(i>>>30),r.data[n++]=c&1073741823}return i}function sc(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=a*c+f*o;c=o*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(D.prototype.am=sc,ke=28):ic&&navigator.appName=="Microsoft Internet Explorer"?(D.prototype.am=Ll,ke=30):ic&&navigator.appName!="Netscape"?(D.prototype.am=_l,ke=26):(D.prototype.am=sc,ke=28);D.prototype.DB=ke;D.prototype.DM=(1<<ke)-1;D.prototype.DV=1<<ke;var Qs=52;D.prototype.FV=Math.pow(2,Qs);D.prototype.F1=Qs-ke;D.prototype.F2=2*ke-Qs;var Rl="0123456789abcdefghijklmnopqrstuvwxyz",Ci=new Array,Ur,re;Ur=48;for(re=0;re<=9;++re)Ci[Ur++]=re;Ur=97;for(re=10;re<36;++re)Ci[Ur++]=re;Ur=65;for(re=10;re<36;++re)Ci[Ur++]=re;function oc(t){return Rl.charAt(t)}function ac(t,e){var r=Ci[t.charCodeAt(e)];return r??-1}function Nl(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Dl(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Ye(t){var e=ot();return e.fromInt(t),e}function kl(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:ac(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&D.ZERO.subTo(this,this)}function Pl(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Ul(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=oc(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=oc(n));return i?s:"0"}function Kl(){var t=ot();return D.ZERO.subTo(this,t),t}function Ol(){return this.s<0?this.negate():this}function Ml(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Ii(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Fl(){return this.t<=0?0:this.DB*(this.t-1)+Ii(this.data[this.t-1]^this.s&this.DM)}function Vl(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Hl(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function ql(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function zl(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function Gl(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function $l(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&D.ZERO.subTo(e,e)}function Wl(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Yl(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ot());var s=ot(),o=this.s,a=t.s,c=this.DB-Ii(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var f=s.t,u=s.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?s.data[f-2]>>this.F2:0),l=this.FV/h,g=(1<<this.F1)/h,d=1<<this.F2,p=r.t,y=p-f,x=e??ot();for(s.dlShiftTo(y,x),r.compareTo(x)>=0&&(r.data[r.t++]=1,r.subTo(x,r)),D.ONE.dlShiftTo(f,x),x.subTo(s,s);s.t<f;)s.data[s.t++]=0;for(;--y>=0;){var v=r.data[--p]==u?this.DM:Math.floor(r.data[p]*l+(r.data[p-1]+d)*g);if((r.data[p]+=s.am(0,v,r,y,0,f))<v)for(s.dlShiftTo(y,x),r.subTo(x,r);r.data[p]<--v;)r.subTo(x,r)}e!=null&&(r.drShiftTo(f,e),o!=a&&D.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&D.ZERO.subTo(r,r)}}}function Zl(t){var e=ot();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(D.ZERO)>0&&t.subTo(e,e),e}function fr(t){this.m=t}function Xl(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Ql(t){return t}function Jl(t){t.divRemTo(this.m,null,t)}function jl(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function td(t,e){t.squareTo(e),this.reduce(e)}fr.prototype.convert=Xl;fr.prototype.revert=Ql;fr.prototype.reduce=Jl;fr.prototype.mulTo=jl;fr.prototype.sqrTo=td;function ed(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ur(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function rd(t){var e=ot();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(D.ZERO)>0&&this.m.subTo(e,e),e}function nd(t){var e=ot();return t.copyTo(e),this.reduce(e),e}function id(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function sd(t,e){t.squareTo(e),this.reduce(e)}function od(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ur.prototype.convert=rd;ur.prototype.revert=nd;ur.prototype.reduce=id;ur.prototype.mulTo=od;ur.prototype.sqrTo=sd;function ad(){return(this.t>0?this.data[0]&1:this.s)==0}function cd(t,e){if(t>4294967295||t<1)return D.ONE;var r=ot(),n=ot(),i=e.convert(this),s=Ii(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function fd(t,e){var r;return t<256||e.isEven()?r=new fr(e):r=new ur(e),this.exp(t,r)}D.prototype.copyTo=Nl;D.prototype.fromInt=Dl;D.prototype.fromString=kl;D.prototype.clamp=Pl;D.prototype.dlShiftTo=Vl;D.prototype.drShiftTo=Hl;D.prototype.lShiftTo=ql;D.prototype.rShiftTo=zl;D.prototype.subTo=Gl;D.prototype.multiplyTo=$l;D.prototype.squareTo=Wl;D.prototype.divRemTo=Yl;D.prototype.invDigit=ed;D.prototype.isEven=ad;D.prototype.exp=cd;D.prototype.toString=Ul;D.prototype.negate=Kl;D.prototype.abs=Ol;D.prototype.compareTo=Ml;D.prototype.bitLength=Fl;D.prototype.mod=Zl;D.prototype.modPowInt=fd;D.ZERO=Ye(0);D.ONE=Ye(1);function ud(){var t=ot();return this.copyTo(t),t}function hd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function ld(){return this.t==0?this.s:this.data[0]<<24>>24}function dd(){return this.t==0?this.s:this.data[0]<<16>>16}function pd(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function yd(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function gd(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ye(r),i=ot(),s=ot(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function xd(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=ac(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&D.ZERO.subTo(this,this)}function md(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(D.ONE.shiftLeft(t-1),Js,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(D.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function bd(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function vd(t){return this.compareTo(t)==0}function wd(t){return this.compareTo(t)<0?this:t}function Ed(t){return this.compareTo(t)>0?this:t}function Sd(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Bd(t,e){return t&e}function Ad(t){var e=ot();return this.bitwiseTo(t,Bd,e),e}function Js(t,e){return t|e}function Cd(t){var e=ot();return this.bitwiseTo(t,Js,e),e}function cc(t,e){return t^e}function Id(t){var e=ot();return this.bitwiseTo(t,cc,e),e}function fc(t,e){return t&~e}function Td(t){var e=ot();return this.bitwiseTo(t,fc,e),e}function _d(){for(var t=ot(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Ld(t){var e=ot();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Rd(t){var e=ot();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Nd(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Dd(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Nd(this.data[t]);return this.s<0?this.t*this.DB:-1}function kd(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Pd(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=kd(this.data[r]^e);return t}function Ud(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Kd(t,e){var r=D.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Od(t){return this.changeBit(t,Js)}function Md(t){return this.changeBit(t,fc)}function Fd(t){return this.changeBit(t,cc)}function Vd(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Hd(t){var e=ot();return this.addTo(t,e),e}function qd(t){var e=ot();return this.subTo(t,e),e}function zd(t){var e=ot();return this.multiplyTo(t,e),e}function Gd(t){var e=ot();return this.divRemTo(t,e,null),e}function $d(t){var e=ot();return this.divRemTo(t,null,e),e}function Wd(t){var e=ot(),r=ot();return this.divRemTo(t,e,r),new Array(e,r)}function Yd(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Zd(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function vn(){}function uc(t){return t}function Xd(t,e,r){t.multiplyTo(e,r)}function Qd(t,e){t.squareTo(e)}vn.prototype.convert=uc;vn.prototype.revert=uc;vn.prototype.mulTo=Xd;vn.prototype.sqrTo=Qd;function Jd(t){return this.exp(t,new vn)}function jd(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function tp(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Kr(t){this.r2=ot(),this.q3=ot(),D.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function ep(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ot();return t.copyTo(e),this.reduce(e),e}function rp(t){return t}function np(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function ip(t,e){t.squareTo(e),this.reduce(e)}function sp(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Kr.prototype.convert=ep;Kr.prototype.revert=rp;Kr.prototype.reduce=np;Kr.prototype.mulTo=sp;Kr.prototype.sqrTo=ip;function op(t,e){var r=t.bitLength(),n,i=Ye(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new fr(e):e.isEven()?s=new Kr(e):s=new ur(e);var o=new Array,a=3,c=n-1,f=(1<<n)-1;if(o[1]=s.convert(this),n>1){var u=ot();for(s.sqrTo(o[1],u);a<=f;)o[a]=ot(),s.mulTo(u,o[a-2],o[a]),a+=2}var h=t.t-1,l,g=!0,d=ot(),p;for(r=Ii(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[l].copyTo(i),g=!1;else{for(;a>1;)s.sqrTo(i,d),s.sqrTo(d,i),a-=2;a>0?s.sqrTo(i,d):(p=i,i=d,d=p),s.mulTo(d,o[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)s.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function ap(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function cp(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function fp(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return D.ZERO;for(var r=t.clone(),n=this.clone(),i=Ye(1),s=Ye(0),o=Ye(0),a=Ye(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(D.ONE)!=0)return D.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var he=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],up=(1<<26)/he[he.length-1];function hp(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=he[he.length-1]){for(e=0;e<he.length;++e)if(r.data[0]==he[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<he.length;){for(var n=he[e],i=e+1;i<he.length&&n<up;)n*=he[i++];for(n=r.modInt(n);e<i;)if(n%he[e++]==0)return!1}return r.millerRabin(t)}function lp(t){var e=this.subtract(D.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=dp(),s,o=0;o<t;++o){do s=new D(this.bitLength(),i);while(s.compareTo(D.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(D.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(D.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function dp(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}D.prototype.chunkSize=pd;D.prototype.toRadix=gd;D.prototype.fromRadix=xd;D.prototype.fromNumber=md;D.prototype.bitwiseTo=Sd;D.prototype.changeBit=Kd;D.prototype.addTo=Vd;D.prototype.dMultiply=Yd;D.prototype.dAddOffset=Zd;D.prototype.multiplyLowerTo=jd;D.prototype.multiplyUpperTo=tp;D.prototype.modInt=cp;D.prototype.millerRabin=lp;D.prototype.clone=ud;D.prototype.intValue=hd;D.prototype.byteValue=ld;D.prototype.shortValue=dd;D.prototype.signum=yd;D.prototype.toByteArray=bd;D.prototype.equals=vd;D.prototype.min=wd;D.prototype.max=Ed;D.prototype.and=Ad;D.prototype.or=Cd;D.prototype.xor=Id;D.prototype.andNot=Td;D.prototype.not=_d;D.prototype.shiftLeft=Ld;D.prototype.shiftRight=Rd;D.prototype.getLowestSetBit=Dd;D.prototype.bitCount=Pd;D.prototype.testBit=Ud;D.prototype.setBit=Od;D.prototype.clearBit=Md;D.prototype.flipBit=Fd;D.prototype.add=Hd;D.prototype.subtract=qd;D.prototype.multiply=zd;D.prototype.divide=Gd;D.prototype.remainder=$d;D.prototype.divideAndRemainder=Wd;D.prototype.modPow=op;D.prototype.modInverse=fp;D.prototype.pow=Jd;D.prototype.gcd=ap;D.prototype.isProbablePrime=hp});var gc=ht((R2,yc)=>{var xe=lt();cr();Bt();var dc=yc.exports=xe.sha1=xe.sha1||{};xe.md.sha1=xe.md.algorithms.sha1=dc;dc.create=function(){pc||pp();var t=null,e=xe.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=xe.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=xe.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),lc(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=xe.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(js.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};lc(h,r,i);var l=xe.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var js=null,pc=!1;function pp(){js="\x80",js+=xe.util.fillString("\0",64),pc=!0}function lc(t,e,r){for(var n,i,s,o,a,c,f,u,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s&o|a&(s^o),n=(i<<5|i>>>27)+f+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var bc=ht((N2,mc)=>{var me=lt();Bt();bn();gc();var xc=mc.exports=me.pkcs1=me.pkcs1||{};xc.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=me.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=c-e.length,g=0;g<l;g++)h+="\0";var d=u.getBytes()+h+""+e;if(!i)i=me.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=s.digestLength,f}var p=_i(i,a-s.digestLength-1,o),y=me.util.xorBytes(d,p,d.length),x=_i(y,s.digestLength,o),v=me.util.xorBytes(i,x,i.length);return"\0"+v+y};xc.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=o,y}if(i===void 0?i=me.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),f=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=_i(u,i.digestLength,s),l=me.util.xorBytes(f,h,f.length),g=_i(l,o-i.digestLength-1,s),d=me.util.xorBytes(u,g,u.length),p=d.substring(0,i.digestLength),y=c!=="\0",x=0;x<i.digestLength;++x)y|=a.charAt(x)!==p.charAt(x);for(var v=1,m=i.digestLength,A=i.digestLength;A<d.length;A++){var S=d.charCodeAt(A),B=S&1^1,R=v?65534:0;y|=S&R,v=v&B,m+=v}if(y||d.charCodeAt(m)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(m+1)};function _i(t,e,r){r||(r=me.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var vc=ht((D2,to)=>{var Ze=lt();Bt();Ti();bn();(function(){if(Ze.prime){to.exports=Ze.prime;return}var t=to.exports=Ze.prime=Ze.prime||{},e=Ze.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,g){typeof l=="function"&&(g=l,l={}),l=l||{};var d=l.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=l.prng||Ze.random,y={nextBytes:function(x){for(var v=p.getBytesSync(x.length),m=0;m<x.length;++m)x[m]=v.charCodeAt(m)}};if(d.name==="PRIMEINC")return s(h,y,d.options,g);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(h,l,g,d){return"workers"in g?c(h,l,g,d):o(h,l,g,d)}function o(h,l,g,d){var p=f(h,l),y=0,x=u(p.bitLength());"millerRabinTests"in g&&(x=g.millerRabinTests);var v=10;"maxBlockTime"in g&&(v=g.maxBlockTime),a(p,h,l,y,x,v,d)}function a(h,l,g,d,p,y,x){var v=+new Date;do{if(h.bitLength()>l&&(h=f(l,g)),h.isProbablePrime(p))return x(null,h);h.dAddOffset(r[d++%8],0)}while(y<0||+new Date-v<y);Ze.util.setImmediate(function(){a(h,l,g,d,p,y,x)})}function c(h,l,g,d){if(typeof Worker>"u")return o(h,l,g,d);var p=f(h,l),y=g.workers,x=g.workLoad||100,v=x*30/8,m=g.workerScript||"forge/prime.worker.js";if(y===-1)return Ze.util.estimateCores(function(S,B){S&&(B=2),y=B-1,A()});A();function A(){y=Math.max(1,y);for(var S=[],B=0;B<y;++B)S[B]=new Worker(m);for(var R=y,B=0;B<y;++B)S[B].addEventListener("message",O);var _=!1;function O(M){if(!_){--R;var U=M.data;if(U.found){for(var q=0;q<S.length;++q)S[q].terminate();return _=!0,d(null,new e(U.prime,16))}p.bitLength()>h&&(p=f(h,l));var z=p.toString(16);M.target.postMessage({hex:z,workLoad:x}),p.dAddOffset(v,0)}}}}function f(h,l){var g=new e(h,l),d=h-1;return g.testBit(d)||g.bitwiseTo(e.ONE.shiftLeft(d),i,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Ri=ht((k2,Ic)=>{var $=lt();mn();Ti();yi();bc();vc();bn();Bt();typeof st>"u"&&(st=$.jsbn.BigInteger);var st,eo=$.util.isNodejs?Ei():null,E=$.asn1,ne=$.util;$.pki=$.pki||{};Ic.exports=$.pki.rsa=$.rsa=$.rsa||{};var Q=$.pki,yp=[6,4,2,4,2,4,6,2],gp={name:"PrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},xp={name:"RSAPrivateKey",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},mp={name:"RSAPublicKey",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},bp=$.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},vp={name:"DigestInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},wp=function(t){var e;if(t.algorithm in Q.oids)e=Q.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=E.oidToDer(e).getBytes(),i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),s=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);s.value.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,n)),s.value.push(E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,""));var o=E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),E.toDer(i).getBytes()},Ac=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(st.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(st.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new st($.util.bytesToHex($.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(st.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};Q.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Cc(t,e,r)):(i=$.util.createBuffer(),i.putBytes(t));for(var o=new st(i.toHex(),16),a=Ac(o,e,n),c=a.toString(16),f=$.util.createBuffer(),u=s-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes($.util.hexToBytes(c)),f.getBytes()};Q.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new st($.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Ac(o,e,r),c=a.toString(16),f=$.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes($.util.hexToBytes(c)),n!==!1?Li(f.getBytes(),e,r):f.getBytes()};Q.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||$.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new st(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};Q.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new st(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new st(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(st.ONE.shiftLeft(f),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(Sp(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(yp[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(st.ONE).gcd(t.e).compareTo(st.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(st.ONE),t.q1=t.q.subtract(st.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(st.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:Q.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:Q.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};Q.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!$.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(wc("generateKeyPair"))return eo.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:Q.privateKeyFromPem(f),publicKey:Q.publicKeyFromPem(c)})});if(Ec("generateKey")&&Ec("exportKey"))return ne.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Bc(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return ne.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=Q.privateKeyFromAsn1(E.fromDer($.util.createBuffer(a)));n(null,{privateKey:c,publicKey:Q.setRsaPublicKey(c.n,c.e)})}});if(Sc("generateKey")&&Sc("exportKey")){var i=ne.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Bc(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,f=ne.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=Q.privateKeyFromAsn1(E.fromDer($.util.createBuffer(h)));n(null,{privateKey:l,publicKey:Q.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(wc("generateKeyPairSync")){var s=eo.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Q.privateKeyFromPem(s.privateKey),publicKey:Q.publicKeyFromPem(s.publicKey)}}}var o=Q.rsa.createKeyPairGenerationState(t,e,r);if(!n)return Q.rsa.stepKeyPairGenerationState(o,0),o.keys;Ep(o,r,n)};Q.setRsaPublicKey=Q.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,f){return Cc(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return $.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return Q.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,f){f=Li(f,r,!0);var u=E.fromDer(f,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!E.validate(u,vp,h,l)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=l,g}var d=E.derToOid(h.algorithmIdentifier);if(!(d===$.oids.md2||d===$.oids.md5||d===$.oids.sha1||d===$.oids.sha224||d===$.oids.sha256||d===$.oids.sha384||d===$.oids.sha512||d===$.oids["sha512-224"]||d===$.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=d,g}if((d===$.oids.md2||d===$.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,f){return f=Li(f,r,!0),c===f}});var a=Q.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};Q.setRsaPrivateKey=Q.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=Q.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Li};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(g,d){return $.pkcs1.decode_rsa_oaep(d,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:wp},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return Q.rsa.encrypt(l,c,h)},c};Q.wrapRsaPrivateKey=function(t){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(0).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Q.oids.rsaEncryption).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")]),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,E.toDer(t).getBytes())])};Q.privateKeyFromAsn1=function(t){var e={},r=[];if(E.validate(t,gp,e,r)&&(t=E.fromDer($.util.createBuffer(e.privateKey))),e={},r=[],!E.validate(t,xp,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,f,u,h;return i=$.util.createBuffer(e.privateKeyModulus).toHex(),s=$.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=$.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=$.util.createBuffer(e.privateKeyPrime1).toHex(),c=$.util.createBuffer(e.privateKeyPrime2).toHex(),f=$.util.createBuffer(e.privateKeyExponent1).toHex(),u=$.util.createBuffer(e.privateKeyExponent2).toHex(),h=$.util.createBuffer(e.privateKeyCoefficient).toHex(),Q.setRsaPrivateKey(new st(i,16),new st(s,16),new st(o,16),new st(a,16),new st(c,16),new st(f,16),new st(u,16),new st(h,16))};Q.privateKeyToAsn1=Q.privateKeyToRSAPrivateKey=function(t){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(0).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.n)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.e)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.d)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.p)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.q)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.dP)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.dQ)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.qInv))])};Q.publicKeyFromAsn1=function(t){var e={},r=[];if(E.validate(t,bp,e,r)){var n=E.derToOid(e.publicKeyOid);if(n!==Q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!E.validate(t,mp,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=$.util.createBuffer(e.publicKeyModulus).toHex(),o=$.util.createBuffer(e.publicKeyExponent).toHex();return Q.setRsaPublicKey(new st(s,16),new st(o,16))};Q.publicKeyToAsn1=Q.publicKeyToSubjectPublicKeyInfo=function(t){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Q.oids.rsaEncryption).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,[Q.publicKeyToRSAPublicKey(t)])])};Q.publicKeyToRSAPublicKey=function(t){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.n)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,be(t.e))])};function Cc(t,e,r){var n=$.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var f=0,u=$.random.getBytes(o),c=0;c<o;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);o=f}return n.putByte(0),n.putBytes(t),n}function Li(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=$.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var f=0;f<c;++f)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var u=s.getByte();if(u!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Ep(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){$.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(st.ONE).gcd(t.e).compareTo(st.ONE)!==0){t.p=null,i();return}if(t.q.subtract(st.ONE).gcd(t.e).compareTo(st.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(st.ONE),t.q1=t.q.subtract(st.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(st.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:Q.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:Q.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function be(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=$.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Sp(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function wc(t){return $.util.isNodejs&&typeof eo[t]=="function"}function Ec(t){return typeof ne.globalScope<"u"&&typeof ne.globalScope.crypto=="object"&&typeof ne.globalScope.crypto.subtle=="object"&&typeof ne.globalScope.crypto.subtle[t]=="function"}function Sc(t){return typeof ne.globalScope<"u"&&typeof ne.globalScope.msCrypto=="object"&&typeof ne.globalScope.msCrypto.subtle=="object"&&typeof ne.globalScope.msCrypto.subtle[t]=="function"}function Bc(t){for(var e=$.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Dc=ht((P2,Nc)=>{var H=lt();$s();mn();K0();cr();yi();H0();G0();bn();nc();Ri();Bt();typeof Tc>"u"&&(Tc=H.jsbn.BigInteger);var Tc,I=H.asn1,tt=H.pki=H.pki||{};Nc.exports=tt.pbe=H.pbe=H.pbe||{};var hr=tt.oids,Bp={name:"EncryptedPrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Ap={name:"PBES2Algorithms",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Cp={name:"pkcs-12PbeParams",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"iterations"}]};tt.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=H.random.getBytesSync(r.saltSize),i=r.count,s=I.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":o=16,f=16,u=hr["aes128-CBC"],h=H.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,u=hr["aes192-CBC"],h=H.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,u=hr["aes256-CBC"],h=H.aes.createEncryptionCipher;break;case"des":o=8,f=8,u=hr.desCBC,h=H.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Rc(g),p=H.pkcs5.pbkdf2(e,n,i,o,d),y=H.random.getBytesSync(f),x=h(p);x.start(y),x.update(I.toDer(t)),x.finish(),c=x.output.getBytes();var v=Ip(n,s,o,g);a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(hr.pkcs5PBES2).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(hr.pkcs5PBKDF2).getBytes()),v]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(u).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var m=new H.util.ByteBuffer(n),p=tt.pbe.generatePkcs12Key(e,m,1,i,o),y=tt.pbe.generatePkcs12Key(e,m,2,i,o),x=H.des.createEncryptionCipher(p);x.start(y),x.update(I.toDer(t)),x.finish(),c=x.output.getBytes(),a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(hr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var A=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[a,I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,c)]);return A};tt.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!I.validate(t,Bp,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=I.derToOid(n.encryptionOid),a=tt.pbe.getCipher(o,n.encryptionParams,e),c=H.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=I.fromDer(a.output)),r};tt.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:I.toDer(t).getBytes()};return H.pem.encode(r,{maxline:e})};tt.encryptedPrivateKeyFromPem=function(t){var e=H.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return I.fromDer(e.body)};tt.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=tt.wrapRsaPrivateKey(tt.privateKeyToAsn1(t));return n=tt.encryptPrivateKeyInfo(n,e,r),tt.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=H.random.getBytesSync(16),a=H.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=H.random.getBytesSync(16),a=H.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=H.random.getBytesSync(16),a=H.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=H.random.getBytesSync(8),a=H.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=H.random.getBytesSync(8),a=H.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=H.pbe.opensslDeriveBytes(e,s.substr(0,8),o),u=a(f);u.start(s),u.update(I.toDer(tt.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:H.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return H.pem.encode(h)};tt.decryptRsaPrivateKey=function(t,e){var r=null,n=H.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=H.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=H.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=H.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=H.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=H.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return H.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return H.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return H.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=H.util.hexToBytes(n.dekInfo.parameters),c=H.pbe.opensslDeriveBytes(e,a.substr(0,8),s),f=o(c);if(f.start(a),f.update(H.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=tt.decryptPrivateKeyInfo(I.fromDer(r),e):r=I.fromDer(r),r!==null&&(r=tt.privateKeyFromAsn1(r)),r};tt.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in H.md))throw new Error('"sha1" hash algorithm unavailable.');s=H.md.sha1.create()}var c=s.digestLength,f=s.blockLength,u=new H.util.ByteBuffer,h=new H.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),g=e.length(),d=new H.util.ByteBuffer;d.fillWithByte(r,f);var p=f*Math.ceil(g/f),y=new H.util.ByteBuffer;for(a=0;a<p;a++)y.putByte(e.at(a%g));var x=f*Math.ceil(l/f),v=new H.util.ByteBuffer;for(a=0;a<x;a++)v.putByte(h.at(a%l));var m=y;m.putBuffer(v);for(var A=Math.ceil(i/c),S=1;S<=A;S++){var B=new H.util.ByteBuffer;B.putBytes(d.bytes()),B.putBytes(m.bytes());for(var R=0;R<n;R++)s.start(),s.update(B.getBytes()),B=s.digest();var _=new H.util.ByteBuffer;for(a=0;a<f;a++)_.putByte(B.at(a%c));var O=Math.ceil(g/f)+Math.ceil(l/f),M=new H.util.ByteBuffer;for(o=0;o<O;o++){var U=new H.util.ByteBuffer(m.getBytes(f)),q=511;for(a=_.length()-1;a>=0;a--)q=q>>8,q+=_.at(a)+U.at(a),U.setAt(a,q&255);M.putBuffer(U)}m=M,u.putBuffer(B)}return u.truncate(u.length()-i),u};tt.pbe.getCipher=function(t,e,r){switch(t){case tt.oids.pkcs5PBES2:return tt.pbe.getCipherForPBES2(t,e,r);case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:return tt.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};tt.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!I.validate(e,Ap,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=I.derToOid(n.kdfOid),t!==tt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=I.derToOid(n.encOid),t!==tt.oids["aes128-CBC"]&&t!==tt.oids["aes192-CBC"]&&t!==tt.oids["aes256-CBC"]&&t!==tt.oids["des-EDE3-CBC"]&&t!==tt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=H.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(tt.oids[t]){case"aes128-CBC":c=16,f=H.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=H.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=H.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=H.des.createDecryptionCipher;break;case"desCBC":c=8,f=H.des.createDecryptionCipher;break}var u=Lc(n.prfOid),h=H.pkcs5.pbkdf2(r,o,a,c,u),l=n.encIv,g=f(h);return g.start(l),g};tt.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!I.validate(e,Cp,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=H.util.createBuffer(n.salt),a=H.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(t){case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=H.des.startDecrypting;break;case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(p,y){var x=H.rc2.createDecryptionCipher(p,40);return x.start(y,null),x};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=Lc(n.prfOid),l=tt.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var g=tt.pbe.generatePkcs12Key(r,o,2,a,f,h);return u(l,g)};tt.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in H.md))throw new Error('"md5" hash algorithm unavailable.');n=H.md.md5.create()}e===null&&(e="");for(var i=[_c(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(_c(n,i[o-1]+t+e));return i.join("").substr(0,r)};function _c(t,e){return t.start().update(e).digest().getBytes()}function Lc(t){var e;if(!t)e="hmacWithSHA1";else if(e=tt.oids[I.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Rc(e)}function Rc(t){var e=H.md;switch(t){case"hmacWithSHA224":e=H.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Ip(t,e,r,n){var i=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,t),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,H.util.hexToBytes(r.toString(16))),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(tt.oids[n]).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])),i}});var Ef=ht((Hb,wf)=>{var mt=lt();cr();Bt();var _n=wf.exports=mt.sha512=mt.sha512||{};mt.md.sha512=mt.md.algorithms.sha512=_n;var bf=mt.sha384=mt.sha512.sha384=mt.sha512.sha384||{};bf.create=function(){return _n.create("SHA-384")};mt.md.sha384=mt.md.algorithms.sha384=bf;mt.sha512.sha256=mt.sha512.sha256||{create:function(){return _n.create("SHA-512/256")}};mt.md["sha512/256"]=mt.md.algorithms["sha512/256"]=mt.sha512.sha256;mt.sha512.sha224=mt.sha512.sha224||{create:function(){return _n.create("SHA-512/224")}};mt.md["sha512/224"]=mt.md.algorithms["sha512/224"]=mt.sha512.sha224;_n.create=function(t){if(vf||Yy(),typeof t>"u"&&(t="SHA-512"),!(t in br))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=br[t],r=null,n=mt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=mt.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=mt.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),mf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=mt.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(Fo.substr(0,a.blockLength-u));for(var h,l,g=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)h=a.fullMessageLength[d+1]*8,l=h/4294967296>>>0,g+=l,c.putInt32(g>>>0),g=h>>>0;c.putInt32(g);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);mf(p,i,c);var y=mt.util.createBuffer(),x;t==="SHA-512"?x=p.length:t==="SHA-384"?x=p.length-2:x=p.length-4;for(var d=0;d<x;++d)y.putInt32(p[d][0]),(d!==x-1||t!=="SHA-512/224")&&y.putInt32(p[d][1]);return y},a};var Fo=null,vf=!1,Vo=null,br=null;function Yy(){Fo="\x80",Fo+=mt.util.fillString("\0",128),Vo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],br={},br["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],br["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],br["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],br["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],vf=!0}function mf(t,e,r){for(var n,i,s,o,a,c,f,u,h,l,g,d,p,y,x,v,m,A,S,B,R,_,O,M,U,q,z,Z,C,N,T,L,w,P,K,V=r.length();V>=128;){for(C=0;C<16;++C)e[C][0]=r.getInt32()>>>0,e[C][1]=r.getInt32()>>>0;for(;C<80;++C)L=e[C-2],N=L[0],T=L[1],n=((N>>>19|T<<13)^(T>>>29|N<<3)^N>>>6)>>>0,i=((N<<13|T>>>19)^(T<<3|N>>>29)^(N<<26|T>>>6))>>>0,P=e[C-15],N=P[0],T=P[1],s=((N>>>1|T<<31)^(N>>>8|T<<24)^N>>>7)>>>0,o=((N<<31|T>>>1)^(N<<24|T>>>8)^(N<<25|T>>>7))>>>0,w=e[C-7],K=e[C-16],T=i+w[1]+o+K[1],e[C][0]=n+w[0]+s+K[0]+(T/4294967296>>>0)>>>0,e[C][1]=T>>>0;for(p=t[0][0],y=t[0][1],x=t[1][0],v=t[1][1],m=t[2][0],A=t[2][1],S=t[3][0],B=t[3][1],R=t[4][0],_=t[4][1],O=t[5][0],M=t[5][1],U=t[6][0],q=t[6][1],z=t[7][0],Z=t[7][1],C=0;C<80;++C)f=((R>>>14|_<<18)^(R>>>18|_<<14)^(_>>>9|R<<23))>>>0,u=((R<<18|_>>>14)^(R<<14|_>>>18)^(_<<23|R>>>9))>>>0,h=(U^R&(O^U))>>>0,l=(q^_&(M^q))>>>0,a=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,c=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,g=(p&x|m&(p^x))>>>0,d=(y&v|A&(y^v))>>>0,T=Z+u+l+Vo[C][1]+e[C][1],n=z+f+h+Vo[C][0]+e[C][0]+(T/4294967296>>>0)>>>0,i=T>>>0,T=c+d,s=a+g+(T/4294967296>>>0)>>>0,o=T>>>0,z=U,Z=q,U=O,q=M,O=R,M=_,T=B+i,R=S+n+(T/4294967296>>>0)>>>0,_=T>>>0,S=m,B=A,m=x,A=v,x=p,v=y,T=i+o,p=n+s+(T/4294967296>>>0)>>>0,y=T>>>0;T=t[0][1]+y,t[0][0]=t[0][0]+p+(T/4294967296>>>0)>>>0,t[0][1]=T>>>0,T=t[1][1]+v,t[1][0]=t[1][0]+x+(T/4294967296>>>0)>>>0,t[1][1]=T>>>0,T=t[2][1]+A,t[2][0]=t[2][0]+m+(T/4294967296>>>0)>>>0,t[2][1]=T>>>0,T=t[3][1]+B,t[3][0]=t[3][0]+S+(T/4294967296>>>0)>>>0,t[3][1]=T>>>0,T=t[4][1]+_,t[4][0]=t[4][0]+R+(T/4294967296>>>0)>>>0,t[4][1]=T>>>0,T=t[5][1]+M,t[5][0]=t[5][0]+O+(T/4294967296>>>0)>>>0,t[5][1]=T>>>0,T=t[6][1]+q,t[6][0]=t[6][0]+U+(T/4294967296>>>0)>>>0,t[6][1]=T>>>0,T=t[7][1]+Z,t[7][0]=t[7][0]+z+(T/4294967296>>>0)>>>0,t[7][1]=T>>>0,V-=128}}});var tu=ht((Cw,jf)=>{var jr=1e3,tn=jr*60,en=tn*60,Sr=en*24,B1=Sr*7,A1=Sr*365.25;jf.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return C1(t);if(r==="number"&&isFinite(t))return e.long?T1(t):I1(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function C1(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*A1;case"weeks":case"week":case"w":return r*B1;case"days":case"day":case"d":return r*Sr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*en;case"minutes":case"minute":case"mins":case"min":case"m":return r*tn;case"seconds":case"second":case"secs":case"sec":case"s":return r*jr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function I1(t){var e=Math.abs(t);return e>=Sr?Math.round(t/Sr)+"d":e>=en?Math.round(t/en)+"h":e>=tn?Math.round(t/tn)+"m":e>=jr?Math.round(t/jr)+"s":t+"ms"}function T1(t){var e=Math.abs(t);return e>=Sr?Vi(t,e,Sr,"day"):e>=en?Vi(t,e,en,"hour"):e>=tn?Vi(t,e,tn,"minute"):e>=jr?Vi(t,e,jr,"second"):t+" ms"}function Vi(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var ru=ht((Iw,eu)=>{function _1(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=tu(),r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,g,d;function p(...y){if(!p.enabled)return;let x=p,v=Number(new Date),m=v-(h||v);x.diff=m,x.prev=h,x.curr=v,h=v,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let A=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(B,R)=>{if(B==="%%")return"%";A++;let _=r.formatters[R];if(typeof _=="function"){let O=y[A];B=_.call(x,O),y.splice(A,1),A--}return B}),r.formatArgs.call(x,y),(x.log||r.log).apply(x,y)}return p.namespace=u,p.useColors=r.useColors(),p.color=r.selectColor(u),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(g!==r.namespaces&&(g=r.namespaces,d=r.enabled(u)),d),set:y=>{l=y}}),typeof r.init=="function"&&r.init(p),p}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),g=l.length;for(h=0;h<g;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}eu.exports=_1});var nu=ht((jt,Hi)=>{jt.formatArgs=R1;jt.save=N1;jt.load=D1;jt.useColors=L1;jt.storage=k1();jt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();jt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function L1(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function R1(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Hi.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}jt.log=console.debug||console.log||(()=>{});function N1(t){try{t?jt.storage.setItem("debug",t):jt.storage.removeItem("debug")}catch{}}function D1(){let t;try{t=jt.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function k1(){try{return localStorage}catch{}}Hi.exports=ru()(jt);var{formatters:P1}=Hi.exports;P1.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var V1={};_t(V1,{noise:()=>F1,pureJsCrypto:()=>di});function Be(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function rt(t=0){return globalThis.Buffer?.alloc!=null?Be(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function It(t=0){return globalThis.Buffer?.allocUnsafe!=null?Be(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var Su=Math.pow(2,7),Bu=Math.pow(2,14),Au=Math.pow(2,21),Zi=Math.pow(2,28),Xi=Math.pow(2,35),Qi=Math.pow(2,42),Ji=Math.pow(2,49),ct=128,Ht=127;function Ae(t){if(t<Su)return 1;if(t<Bu)return 2;if(t<Au)return 3;if(t<Zi)return 4;if(t<Xi)return 5;if(t<Qi)return 6;if(t<Ji)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Cu(t,e,r=0){switch(Ae(t)){case 8:e[r++]=t&255|ct,t/=128;case 7:e[r++]=t&255|ct,t/=128;case 6:e[r++]=t&255|ct,t/=128;case 5:e[r++]=t&255|ct,t/=128;case 4:e[r++]=t&255|ct,t>>>=7;case 3:e[r++]=t&255|ct,t>>>=7;case 2:e[r++]=t&255|ct,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function Iu(t,e,r=0){switch(Ae(t)){case 8:e.set(r++,t&255|ct),t/=128;case 7:e.set(r++,t&255|ct),t/=128;case 6:e.set(r++,t&255|ct),t/=128;case 5:e.set(r++,t&255|ct),t/=128;case 4:e.set(r++,t&255|ct),t>>>=7;case 3:e.set(r++,t&255|ct),t>>>=7;case 2:e.set(r++,t&255|ct),t>>>=7;case 1:{e.set(r++,t&255),t>>>=7;break}default:throw new Error("unreachable")}return e}function Tu(t,e){let r=t[e],n=0;if(n+=r&Ht,r<ct||(r=t[e+1],n+=(r&Ht)<<7,r<ct)||(r=t[e+2],n+=(r&Ht)<<14,r<ct)||(r=t[e+3],n+=(r&Ht)<<21,r<ct)||(r=t[e+4],n+=(r&Ht)*Zi,r<ct)||(r=t[e+5],n+=(r&Ht)*Xi,r<ct)||(r=t[e+6],n+=(r&Ht)*Qi,r<ct)||(r=t[e+7],n+=(r&Ht)*Ji,r<ct))return n;throw new RangeError("Could not decode varint")}function _u(t,e){let r=t.get(e),n=0;if(n+=r&Ht,r<ct||(r=t.get(e+1),n+=(r&Ht)<<7,r<ct)||(r=t.get(e+2),n+=(r&Ht)<<14,r<ct)||(r=t.get(e+3),n+=(r&Ht)<<21,r<ct)||(r=t.get(e+4),n+=(r&Ht)*Zi,r<ct)||(r=t.get(e+5),n+=(r&Ht)*Xi,r<ct)||(r=t.get(e+6),n+=(r&Ht)*Qi,r<ct)||(r=t.get(e+7),n+=(r&Ht)*Ji,r<ct))return n;throw new RangeError("Could not decode varint")}function la(t,e,r=0){return e==null&&(e=It(Ae(t))),e instanceof Uint8Array?Cu(t,e,r):Iu(t,e,r)}function Mn(t,e=0){return t instanceof Uint8Array?Tu(t,e):_u(t,e)}function Gt(t,e){if(globalThis.Buffer!=null)return Be(globalThis.Buffer.concat(t,e));e==null&&(e=t.reduce((i,s)=>i+s.length,0));let r=It(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return Be(r)}function Lt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var pa=Symbol.for("@achingbrain/uint8arraylist");function da(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function Fn(t){return!!t?.[pa]}var Rt=class t{bufs;length;[pa]=!0;constructor(...e){this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Fn(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Fn(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=da(this.bufs,e);return r.buf[r.index]}set(e,r){let n=da(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(Fn(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return Gt(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:Gt(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),s=new t;return s.length=i,s.bufs=[...n],s}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,c=a+o.byteLength;if(i=c,e>=c)continue;let f=e>=a&&e<c,u=r>a&&r<=c;if(f&&u){if(e===a&&r===c){n.push(o);break}let h=e-a;n.push(o.subarray(h,h+(r-e)));break}if(f){if(e===0){n.push(o);continue}n.push(o.subarray(e-a));continue}if(u){if(r===c){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!Fn(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=-1;for(let h=0;h<i;h++)o[n[h]]=h;let a=o,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let h=r;h<=c;h+=u){u=0;for(let l=f;l>=0;l--){let g=this.get(h+l);if(n[l]!==g){u=Math.max(1,l-a[g]);break}}if(u===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=It(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=rt(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=rt(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=rt(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=It(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=rt(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=rt(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=rt(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=rt(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=rt(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof t)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Lt(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new t;return n.bufs=e,r==null&&(r=e.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function Vn(t){return t[Symbol.asyncIterator]!=null}var Hn=t=>{let e=Ae(t),r=It(e);return la(t,r),Hn.bytes=e,r};Hn.bytes=0;function nn(t,e){e=e??{};let r=e.lengthEncoder??Hn;function*n(i){let s=r(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}return Vn(t)?async function*(){for await(let i of t)yield*n(i)}():function*(){for(let i of t)yield*n(i)}()}nn.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??Hn;return new Rt(r(t.byteLength),t)};var Br=zt(xa(),1);var Ru=8,Nu=1024*1024*4,er;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(er||(er={}));var ts=t=>{let e=Mn(t);return ts.bytes=Ae(e),e};ts.bytes=0;function sn(t,e){let r=new Rt,n=er.LENGTH,i=-1,s=e?.lengthDecoder??ts,o=e?.maxLengthLength??Ru,a=e?.maxDataLength??Nu;function*c(){for(;r.byteLength>0;){if(n===er.LENGTH)try{if(i=s(r),i<0)throw(0,Br.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,Br.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let f=s.bytes;r.consume(f),e?.onLength!=null&&e.onLength(i),n=er.DATA}catch(f){if(f instanceof RangeError){if(r.byteLength>o)throw(0,Br.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw f}if(n===er.DATA){if(r.byteLength<i)break;let f=r.sublist(0,i);r.consume(i),e?.onData!=null&&e.onData(f),yield f,n=er.LENGTH}}}return Vn(t)?async function*(){for await(let f of t)r.append(f),yield*c();if(r.byteLength>0)throw(0,Br.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let f of t)r.append(f),yield*c();if(r.byteLength>0)throw(0,Br.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}sn.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await t.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return sn(n,{...e??{},onLength:s=>{r=s}})};function oe(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var qn=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.name="AbortError",this.code=r??"ABORT_ERR"}};async function ma(t,e,r){if(e==null)return t;if(e.aborted)return Promise.reject(new qn(r?.errorMessage,r?.errorCode));let n,i=new qn(r?.errorMessage,r?.errorCode);try{return await Promise.race([t,new Promise((s,o)=>{n=()=>{o(i)},e.addEventListener("abort",n)})])}finally{n!=null&&e.removeEventListener("abort",n)}}var es=class{needNext;haveNext;ended;nextResult;constructor(){this.ended=!1,this.needNext=oe(),this.needNext.resolve(),this.haveNext=oe()}[Symbol.asyncIterator](){return this}async next(){if(this.nextResult==null&&await this.haveNext.promise,this.nextResult==null)throw new Error("Have next but next was undefined");let e=this.nextResult;return this.nextResult=void 0,this.needNext.resolve(),this.needNext=oe(),e}async throw(e){return this.ended=!0,e!=null&&this.haveNext.reject(e),{done:!0,value:void 0}}async return(){let e={done:!0,value:void 0};return await this._push(void 0),e}async push(e,r){await this._push(e,r)}async end(e,r){e!=null?await this.throw(e):await this._push(void 0,r)}async _push(e,r){if(e!=null&&this.ended)throw new Error("Cannot push value onto an ended pushable");this.nextResult!=null&&await this.needNext.promise,e!=null?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=oe(),await ma(this.needNext.promise,r?.signal,r)}};function ba(){return new es}var zn=class extends Error{code;constructor(e,r){super(e),this.code=r}},rs=class extends zn{type;constructor(e){super(e,"ABORT_ERR"),this.type="aborted"}};function va(t,e){let r=ba();t.sink(r).catch(async o=>{await r.end(o)}),t.sink=async o=>{for await(let a of o)await r.push(a);await r.end()};let n=t.source;t.source[Symbol.iterator]!=null?n=t.source[Symbol.iterator]():t.source[Symbol.asyncIterator]!=null&&(n=t.source[Symbol.asyncIterator]());let i=new Rt;return{read:async(o,a)=>{a?.signal?.throwIfAborted();let c,f=new Promise((u,h)=>{c=()=>{h(new rs("Read aborted"))},a?.signal?.addEventListener("abort",c)});try{if(o==null){let{done:h,value:l}=await Promise.race([n.next(),f]);return h===!0?new Rt:l}for(;i.byteLength<o;){let{value:h,done:l}=await Promise.race([n.next(),f]);if(l===!0)throw new zn("unexpected end of input","ERR_UNEXPECTED_EOF");i.append(h)}let u=i.sublist(0,o);return i.consume(o),u}finally{c!=null&&a?.signal?.removeEventListener("abort",c)}},write:async(o,a)=>{a?.signal?.throwIfAborted(),o instanceof Uint8Array?await r.push(o,a):await r.push(o.subarray(),a)},unwrap:()=>{if(i.byteLength>0){let o=t.source;t.source=async function*(){e?.yieldBytes===!1?yield i:yield*i,yield*o}()}return t}}}var Gn=class extends Error{code;constructor(e,r){super(e),this.code=r}},wa=t=>Mn(t);wa.bytes=0;function ns(t,e={}){let r=va(t,e);return e.maxDataLength!=null&&e.maxLengthLength==null&&(e.maxLengthLength=Ae(e.maxDataLength)),{read:async i=>{let s=-1,o=new Rt,a=e?.lengthDecoder??wa;for(;;){o.append(await r.read(1,i));try{s=a(o)}catch(c){if(c instanceof RangeError)continue;throw c}if(e?.maxLengthLength!=null&&o.byteLength>e.maxLengthLength)throw new Gn("message length length too long","ERR_MSG_LENGTH_TOO_LONG");if(s>-1)break}if(e?.maxDataLength!=null&&s>e.maxDataLength)throw new Gn("message length too long","ERR_MSG_DATA_TOO_LONG");return r.read(s,i)},write:async(i,s)=>{await r.write(nn.single(i,e),s)},writeV:async(i,s)=>{let o=new Rt(...i.map(a=>nn.single(a,e)));await r.write(o,s)},unwrap:()=>r.unwrap()}}function is(){let t=oe(),e=!1;return{sink:async r=>{if(e)throw new Error("already piped");e=!0,t.resolve(r)},source:async function*(){yield*await t.promise}()}}function Ea(){let t=is(),e=is();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}var $n=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Ar=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new $n(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new $n(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var ss=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Wn(t={}){return ku(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function ku(t,e){e=e??{};let r=e.onEnd,n=new Ar,i,s,o,a=oe(),c=async()=>{try{return n.isEmpty()?o?{done:!0}:await new Promise((y,x)=>{s=v=>{s=null,n.push(v);try{y(t(n))}catch(m){x(m)}return i}}):t(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=oe()})}},f=y=>s!=null?s(y):(n.push(y),i),u=y=>(n=new Ar,s!=null?s({error:y}):(n.push({error:y}),i)),h=y=>{if(o)return i;if(e?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:y})},l=y=>o?i:(o=!0,y!=null?u(y):f({done:!0})),g=()=>(n=new Ar,l(),{done:!0}),d=y=>(l(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:g,throw:d,push:h,end:l,get readableLength(){return n.size},onEmpty:async y=>{let x=y?.signal;if(x?.throwIfAborted(),n.isEmpty())return;let v,m;x!=null&&(v=new Promise((A,S)=>{m=()=>{S(new ss)},x.addEventListener("abort",m)}));try{await Promise.race([a.promise,v])}finally{m!=null&&x!=null&&x?.removeEventListener("abort",m)}}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(y){return p.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return p.readableLength},onEmpty:y=>p.onEmpty(y)},i}function Pu(t){return t[Symbol.asyncIterator]!=null}function Uu(...t){let e=[];for(let r of t)Pu(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=Wn({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var Sa=Uu;function Ba(t,...e){if(t==null)throw new Error("Empty pipeline");if(os(t)){let n=t;t=()=>n.source}else if(Ca(t)||Aa(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&os(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)os(r[n])&&(r[n]=Ou(r[n]));return Ku(...r)}var Ku=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},Aa=t=>t?.[Symbol.asyncIterator]!=null,Ca=t=>t?.[Symbol.iterator]!=null,os=t=>t==null?!1:t.sink!=null&&t.source!=null,Ou=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=Wn({objectMode:!0});r.then(()=>{n.end()},o=>{n.end(o)});let i,s=t.source;if(Aa(s))i=async function*(){yield*s,n.end()};else if(Ca(s))i=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return Sa(n,i())}return t.source};var Ia=!!globalThis.process?.env?.DUMP_SESSION_KEYS;var Mu=t=>t instanceof Uint8Array;var Ce=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Ta=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Fu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Fu)throw new Error("Non little-endian hardware is not supported");function Yn(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Zn(t){if(typeof t=="string")t=Yn(t);else if(Mu(t))t=t.slice();else throw new Error(`expected Uint8Array, got ${typeof t}`);return t}var Vu=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function _a(t,e){if(e!==void 0&&(typeof e!="object"||!Vu(e)))throw new Error("options must be object or undefined");return Object.assign(t,e)}function rr(t,e){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof e=="number"&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function La(t,e){if(t.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<t.length;n++)r&&(r=t[n]===e[n]);return r}var as=(t,e)=>(Object.assign(e,t),e);function cs(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}function Xn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function fs(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Cr(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function us(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ra(t,e){Cr(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Ot=(t,e)=>t[e++]&255|(t[e++]&255)<<8,hs=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Zn(e),rr(e,32);let r=Ot(e,0),n=Ot(e,2),i=Ot(e,4),s=Ot(e,6),o=Ot(e,8),a=Ot(e,10),c=Ot(e,12),f=Ot(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Ot(e,16+2*u)}process(e,r,n=!1){let i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],f=o[2],u=o[3],h=o[4],l=o[5],g=o[6],d=o[7],p=o[8],y=o[9],x=Ot(e,r+0),v=Ot(e,r+2),m=Ot(e,r+4),A=Ot(e,r+6),S=Ot(e,r+8),B=Ot(e,r+10),R=Ot(e,r+12),_=Ot(e,r+14),O=s[0]+(x&8191),M=s[1]+((x>>>13|v<<3)&8191),U=s[2]+((v>>>10|m<<6)&8191),q=s[3]+((m>>>7|A<<9)&8191),z=s[4]+((A>>>4|S<<12)&8191),Z=s[5]+(S>>>1&8191),C=s[6]+((S>>>14|B<<2)&8191),N=s[7]+((B>>>11|R<<5)&8191),T=s[8]+((R>>>8|_<<8)&8191),L=s[9]+(_>>>5|i),w=0,P=w+O*a+M*(5*y)+U*(5*p)+q*(5*d)+z*(5*g);w=P>>>13,P&=8191,P+=Z*(5*l)+C*(5*h)+N*(5*u)+T*(5*f)+L*(5*c),w+=P>>>13,P&=8191;let K=w+O*c+M*a+U*(5*y)+q*(5*p)+z*(5*d);w=K>>>13,K&=8191,K+=Z*(5*g)+C*(5*l)+N*(5*h)+T*(5*u)+L*(5*f),w+=K>>>13,K&=8191;let V=w+O*f+M*c+U*a+q*(5*y)+z*(5*p);w=V>>>13,V&=8191,V+=Z*(5*d)+C*(5*g)+N*(5*l)+T*(5*h)+L*(5*u),w+=V>>>13,V&=8191;let W=w+O*u+M*f+U*c+q*a+z*(5*y);w=W>>>13,W&=8191,W+=Z*(5*p)+C*(5*d)+N*(5*g)+T*(5*l)+L*(5*h),w+=W>>>13,W&=8191;let Y=w+O*h+M*u+U*f+q*c+z*a;w=Y>>>13,Y&=8191,Y+=Z*(5*y)+C*(5*p)+N*(5*d)+T*(5*g)+L*(5*l),w+=Y>>>13,Y&=8191;let et=w+O*l+M*h+U*u+q*f+z*c;w=et>>>13,et&=8191,et+=Z*a+C*(5*y)+N*(5*p)+T*(5*d)+L*(5*g),w+=et>>>13,et&=8191;let X=w+O*g+M*l+U*h+q*u+z*f;w=X>>>13,X&=8191,X+=Z*c+C*a+N*(5*y)+T*(5*p)+L*(5*d),w+=X>>>13,X&=8191;let J=w+O*d+M*g+U*l+q*h+z*u;w=J>>>13,J&=8191,J+=Z*f+C*c+N*a+T*(5*y)+L*(5*p),w+=J>>>13,J&=8191;let dt=w+O*p+M*d+U*g+q*l+z*h;w=dt>>>13,dt&=8191,dt+=Z*u+C*f+N*c+T*a+L*(5*y),w+=dt>>>13,dt&=8191;let ut=w+O*y+M*p+U*d+q*g+z*l;w=ut>>>13,ut&=8191,ut+=Z*h+C*u+N*f+T*c+L*a,w+=ut>>>13,ut&=8191,w=(w<<2)+w|0,w=w+P|0,P=w&8191,w=w>>>13,K+=w,s[0]=P,s[1]=K,s[2]=V,s[3]=W,s[4]=Y,s[5]=et,s[6]=X,s[7]=J,s[8]=dt,s[9]=ut}finalize(){let{h:e,pad:r}=this,n=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535}update(e){us(this);let{buffer:r,blockLen:n}=this;e=Zn(e);let i=e.length;for(let s=0;s<i;){let o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){us(this),Ra(e,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=n[o]>>>0,e[s++]=n[o]>>>8;return e}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}};function Hu(t){let e=(n,i)=>t(i).update(Zn(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}var Na=Hu(t=>new hs(t));var qu=Yn("expand 16-byte k"),zu=Yn("expand 32-byte k"),Gu=Ce(qu),$u=Ce(zu);function G(t,e){return t<<e|t>>>32-e}function ls(t){return t.byteOffset%4===0}var Qn=64,Wu=16,ka=2**32-1,Da=new Uint32Array;function Yu(t,e,r,n,i,s,o,a){let c=i.length,f=new Uint8Array(Qn),u=Ce(f),h=ls(i)&&ls(s),l=h?Ce(i):Da,g=h?Ce(s):Da;for(let d=0;d<c;o++){if(t(e,r,n,u,o,a),o>=ka)throw new Error("arx: counter overflow");let p=Math.min(Qn,c-d);if(h&&p===Qn){let y=d/4;if(d%4!==0)throw new Error("arx: invalid block position");for(let x=0,v;x<Wu;x++)v=y+x,g[v]=l[v]^u[x];d+=Qn;continue}for(let y=0,x;y<p;y++)x=d+y,s[x]=i[x]^f[y];d+=p}}function ds(t,e){let{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=_a({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Xn(i),Xn(o),fs(s),fs(r),(a,c,f,u,h=0)=>{Cr(a),Cr(c),Cr(f);let l=f.length;if(u||(u=new Uint8Array(l)),Cr(u),Xn(h),h<0||h>=ka)throw new Error("arx: counter overflow");if(u.length<l)throw new Error(`arx: output (${u.length}) is shorter than data (${l})`);let g=[],d=a.length,p,y;if(d===32)p=a.slice(),g.push(p),y=$u;else if(d===16&&r)p=new Uint8Array(32),p.set(a),p.set(a,16),y=Gu,g.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${d}`);ls(c)||(c=c.slice(),g.push(c));let x=Ce(p);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(y,x,Ce(c.subarray(0,16)),x),c=c.subarray(16)}let v=16-i;if(v!==c.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(v!==12){let A=new Uint8Array(12);A.set(c,s?0:12-c.length),c=A,g.push(c)}let m=Ce(c);for(Yu(t,y,x,m,f,u,h,o);g.length>0;)g.pop().fill(0);return u}}function Ka(t,e,r,n,i,s=20){let o=t[0],a=t[1],c=t[2],f=t[3],u=e[0],h=e[1],l=e[2],g=e[3],d=e[4],p=e[5],y=e[6],x=e[7],v=i,m=r[0],A=r[1],S=r[2],B=o,R=a,_=c,O=f,M=u,U=h,q=l,z=g,Z=d,C=p,N=y,T=x,L=v,w=m,P=A,K=S;for(let W=0;W<s;W+=2)B=B+M|0,L=G(L^B,16),Z=Z+L|0,M=G(M^Z,12),B=B+M|0,L=G(L^B,8),Z=Z+L|0,M=G(M^Z,7),R=R+U|0,w=G(w^R,16),C=C+w|0,U=G(U^C,12),R=R+U|0,w=G(w^R,8),C=C+w|0,U=G(U^C,7),_=_+q|0,P=G(P^_,16),N=N+P|0,q=G(q^N,12),_=_+q|0,P=G(P^_,8),N=N+P|0,q=G(q^N,7),O=O+z|0,K=G(K^O,16),T=T+K|0,z=G(z^T,12),O=O+z|0,K=G(K^O,8),T=T+K|0,z=G(z^T,7),B=B+U|0,K=G(K^B,16),N=N+K|0,U=G(U^N,12),B=B+U|0,K=G(K^B,8),N=N+K|0,U=G(U^N,7),R=R+q|0,L=G(L^R,16),T=T+L|0,q=G(q^T,12),R=R+q|0,L=G(L^R,8),T=T+L|0,q=G(q^T,7),_=_+z|0,w=G(w^_,16),Z=Z+w|0,z=G(z^Z,12),_=_+z|0,w=G(w^_,8),Z=Z+w|0,z=G(z^Z,7),O=O+M|0,P=G(P^O,16),C=C+P|0,M=G(M^C,12),O=O+M|0,P=G(P^O,8),C=C+P|0,M=G(M^C,7);let V=0;n[V++]=o+B|0,n[V++]=a+R|0,n[V++]=c+_|0,n[V++]=f+O|0,n[V++]=u+M|0,n[V++]=h+U|0,n[V++]=l+q|0,n[V++]=g+z|0,n[V++]=d+Z|0,n[V++]=p+C|0,n[V++]=y+N|0,n[V++]=x+T|0,n[V++]=v+L|0,n[V++]=m+w|0,n[V++]=A+P|0,n[V++]=S+K|0}function Zu(t,e,r,n){let i=t[0],s=t[1],o=t[2],a=t[3],c=e[0],f=e[1],u=e[2],h=e[3],l=e[4],g=e[5],d=e[6],p=e[7],y=r[0],x=r[1],v=r[2],m=r[3];for(let S=0;S<20;S+=2)i=i+c|0,y=G(y^i,16),l=l+y|0,c=G(c^l,12),i=i+c|0,y=G(y^i,8),l=l+y|0,c=G(c^l,7),s=s+f|0,x=G(x^s,16),g=g+x|0,f=G(f^g,12),s=s+f|0,x=G(x^s,8),g=g+x|0,f=G(f^g,7),o=o+u|0,v=G(v^o,16),d=d+v|0,u=G(u^d,12),o=o+u|0,v=G(v^o,8),d=d+v|0,u=G(u^d,7),a=a+h|0,m=G(m^a,16),p=p+m|0,h=G(h^p,12),a=a+h|0,m=G(m^a,8),p=p+m|0,h=G(h^p,7),i=i+f|0,m=G(m^i,16),d=d+m|0,f=G(f^d,12),i=i+f|0,m=G(m^i,8),d=d+m|0,f=G(f^d,7),s=s+u|0,y=G(y^s,16),p=p+y|0,u=G(u^p,12),s=s+u|0,y=G(y^s,8),p=p+y|0,u=G(u^p,7),o=o+h|0,x=G(x^o,16),l=l+x|0,h=G(h^l,12),o=o+h|0,x=G(x^o,8),l=l+x|0,h=G(h^l,7),a=a+c|0,v=G(v^a,16),g=g+v|0,c=G(c^g,12),a=a+c|0,v=G(v^a,8),g=g+v|0,c=G(c^g,7);let A=0;n[A++]=i,n[A++]=s,n[A++]=o,n[A++]=a,n[A++]=y,n[A++]=x,n[A++]=v,n[A++]=m}var Xu=ds(Ka,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Qu=ds(Ka,{counterRight:!1,counterLength:8,extendNonceFn:Zu,allowShortKeys:!1});var Ju=new Uint8Array(16),Pa=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(Ju.subarray(r))},ju=new Uint8Array(32);function Ua(t,e,r,n,i){let s=t(e,r,ju),o=Na.create(s);i&&Pa(o,i),Pa(o,n);let a=new Uint8Array(16),c=Ta(a);cs(c,0,BigInt(i?i.length:0),!0),cs(c,8,BigInt(n.length),!0),o.update(a);let f=o.digest();return s.fill(0),f}var Oa=t=>(e,r,n)=>(rr(e,32),rr(r),{encrypt:(s,o)=>{let a=s.length,c=a+16;o?rr(o,c):o=new Uint8Array(c),t(e,r,s,o,1);let f=Ua(t,e,r,o.subarray(0,-16),n);return o.set(f,a),o},decrypt:(s,o)=>{let a=s.length,c=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");o?rr(o,c):o=new Uint8Array(c);let f=s.subarray(0,-16),u=s.subarray(-16),h=Ua(t,e,r,f,n);if(!La(u,h))throw new Error("invalid tag");return t(e,r,f,o,1),o}}),ps=as({blockSize:64,nonceLength:12,tagLength:16},Oa(Xu)),Zg=as({blockSize:64,nonceLength:24,tagLength:16},Oa(Qu));function Jn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function ys(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function on(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Jn(t.outputLen),Jn(t.blockLen)}function Ir(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ma(t,e){ys(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var jn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Fa=t=>t instanceof Uint8Array;var ti=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ae=(t,e)=>t<<32-e|t>>>e,th=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!th)throw new Error("Non little-endian hardware is not supported");function gs(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Fe(t){if(typeof t=="string"&&(t=gs(t)),!Fa(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function ei(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!Fa(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var Tr=class{clone(){return this._cloneInto()}},tx={}.toString;function ri(t){let e=n=>t().update(Fe(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function nr(t=32){if(jn&&typeof jn.getRandomValues=="function")return jn.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function eh(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}var _r=class extends Tr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ti(this.buffer)}update(e){Ir(this);let{view:r,buffer:n,blockLen:i}=this;e=Fe(e);let s=e.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=ti(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ir(this),Ma(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;eh(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=ti(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<f;h++)a.setUint32(4*h,u[h],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}};var ni=BigInt(4294967295),xs=BigInt(32);function Va(t,e=!1){return e?{h:Number(t&ni),l:Number(t>>xs&ni)}:{h:Number(t>>xs&ni)|0,l:Number(t&ni)|0}}function rh(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:s,l:o}=Va(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}var nh=(t,e)=>BigInt(t>>>0)<<xs|BigInt(e>>>0),ih=(t,e,r)=>t>>>r,sh=(t,e,r)=>t<<32-r|e>>>r,oh=(t,e,r)=>t>>>r|e<<32-r,ah=(t,e,r)=>t<<32-r|e>>>r,ch=(t,e,r)=>t<<64-r|e>>>r-32,fh=(t,e,r)=>t>>>r-32|e<<64-r,uh=(t,e)=>e,hh=(t,e)=>t,lh=(t,e,r)=>t<<r|e>>>32-r,dh=(t,e,r)=>e<<r|t>>>32-r,ph=(t,e,r)=>e<<r-32|t>>>64-r,yh=(t,e,r)=>t<<r-32|e>>>64-r;function gh(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var xh=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),mh=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,bh=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),vh=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,wh=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Eh=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0;var Sh={fromBig:Va,split:rh,toBig:nh,shrSH:ih,shrSL:sh,rotrSH:oh,rotrSL:ah,rotrBH:ch,rotrBL:fh,rotr32H:uh,rotr32L:hh,rotlSH:lh,rotlSL:dh,rotlBH:ph,rotlBL:yh,add:gh,add3L:xh,add3H:mh,add4L:bh,add4H:vh,add5H:Eh,add5L:wh},j=Sh;var[Bh,Ah]=j.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ve=new Uint32Array(80),He=new Uint32Array(80),ms=class extends _r{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:f,El:u,Fh:h,Fl:l,Gh:g,Gl:d,Hh:p,Hl:y}=this;return[e,r,n,i,s,o,a,c,f,u,h,l,g,d,p,y]}set(e,r,n,i,s,o,a,c,f,u,h,l,g,d,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=g|0,this.Gl=d|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let m=0;m<16;m++,r+=4)Ve[m]=e.getUint32(r),He[m]=e.getUint32(r+=4);for(let m=16;m<80;m++){let A=Ve[m-15]|0,S=He[m-15]|0,B=j.rotrSH(A,S,1)^j.rotrSH(A,S,8)^j.shrSH(A,S,7),R=j.rotrSL(A,S,1)^j.rotrSL(A,S,8)^j.shrSL(A,S,7),_=Ve[m-2]|0,O=He[m-2]|0,M=j.rotrSH(_,O,19)^j.rotrBH(_,O,61)^j.shrSH(_,O,6),U=j.rotrSL(_,O,19)^j.rotrBL(_,O,61)^j.shrSL(_,O,6),q=j.add4L(R,U,He[m-7],He[m-16]),z=j.add4H(q,B,M,Ve[m-7],Ve[m-16]);Ve[m]=z|0,He[m]=q|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:h,El:l,Fh:g,Fl:d,Gh:p,Gl:y,Hh:x,Hl:v}=this;for(let m=0;m<80;m++){let A=j.rotrSH(h,l,14)^j.rotrSH(h,l,18)^j.rotrBH(h,l,41),S=j.rotrSL(h,l,14)^j.rotrSL(h,l,18)^j.rotrBL(h,l,41),B=h&g^~h&p,R=l&d^~l&y,_=j.add5L(v,S,R,Ah[m],He[m]),O=j.add5H(_,x,A,B,Bh[m],Ve[m]),M=_|0,U=j.rotrSH(n,i,28)^j.rotrBH(n,i,34)^j.rotrBH(n,i,39),q=j.rotrSL(n,i,28)^j.rotrBL(n,i,34)^j.rotrBL(n,i,39),z=n&s^n&a^s&a,Z=i&o^i&c^o&c;x=p|0,v=y|0,p=g|0,y=d|0,g=h|0,d=l|0,{h,l}=j.add(f|0,u|0,O|0,M|0),f=a|0,u=c|0,a=s|0,c=o|0,s=n|0,o=i|0;let C=j.add3L(M,q,Z);n=j.add3H(C,O,U,z),i=C|0}({h:n,l:i}=j.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=j.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=j.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=j.add(this.Dh|0,this.Dl|0,f|0,u|0),{h,l}=j.add(this.Eh|0,this.El|0,h|0,l|0),{h:g,l:d}=j.add(this.Fh|0,this.Fl|0,g|0,d|0),{h:p,l:y}=j.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:x,l:v}=j.add(this.Hh|0,this.Hl|0,x|0,v|0),this.set(n,i,s,o,a,c,f,u,h,l,g,d,p,y,x,v)}roundClean(){Ve.fill(0),He.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var bs=ri(()=>new ms);var oi={};_t(oi,{bitGet:()=>Nh,bitLen:()=>Rh,bitMask:()=>an,bitSet:()=>Dh,bytesToHex:()=>Ie,bytesToNumberBE:()=>Te,bytesToNumberLE:()=>ce,concatBytes:()=>Le,createHmacDrbg:()=>Es,ensureBytes:()=>yt,equalBytes:()=>_h,hexToBytes:()=>ir,hexToNumber:()=>ws,numberToBytesBE:()=>qe,numberToBytesLE:()=>_e,numberToHexUnpadded:()=>za,numberToVarBytesBE:()=>Th,utf8ToBytes:()=>Lh,validateObject:()=>ee});var qa=BigInt(0),ii=BigInt(1),Ch=BigInt(2),si=t=>t instanceof Uint8Array,Ih=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ie(t){if(!si(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Ih[t[r]];return e}function za(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ws(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function ir(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,s=t.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function Te(t){return ws(Ie(t))}function ce(t){if(!si(t))throw new Error("Uint8Array expected");return ws(Ie(Uint8Array.from(t).reverse()))}function qe(t,e){return ir(t.toString(16).padStart(e*2,"0"))}function _e(t,e){return qe(t,e).reverse()}function Th(t){return ir(za(t))}function yt(t,e,r){let n;if(typeof e=="string")try{n=ir(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(si(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Le(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!si(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function _h(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Lh(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Rh(t){let e;for(e=0;t>qa;t>>=ii,e+=1);return e}function Nh(t,e){return t>>BigInt(e)&ii}var Dh=(t,e,r)=>t|(r?ii:qa)<<BigInt(e),an=t=>(Ch<<BigInt(t-1))-ii,vs=t=>new Uint8Array(t),Ha=t=>Uint8Array.from(t);function Es(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=vs(t),i=vs(t),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...h)=>r(i,n,...h),c=(h=vs())=>{i=a(Ha([0]),h),n=a(),h.length!==0&&(i=a(Ha([1]),h),n=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=a();let g=n.slice();l.push(g),h+=n.length}return Le(...l)};return(h,l)=>{o(),c(h);let g;for(;!(g=l(f()));)c();return o(),g}}var kh={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ee(t,e,r={}){let n=(i,s,o)=>{let a=kh[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(e))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return t}var Tt=BigInt(0),bt=BigInt(1),sr=BigInt(2),Ph=BigInt(3),Ss=BigInt(4),Ga=BigInt(5),$a=BigInt(8),Uh=BigInt(9),Kh=BigInt(16);function at(t,e){let r=t%e;return r>=Tt?r:e+r}function Bs(t,e,r){if(r<=Tt||e<Tt)throw new Error("Expected power/modulo > 0");if(r===bt)return Tt;let n=bt;for(;e>Tt;)e&bt&&(n=n*t%r),t=t*t%r,e>>=bt;return n}function gt(t,e,r){let n=t;for(;e-- >Tt;)n*=n,n%=r;return n}function ai(t,e){if(t===Tt||e<=Tt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=at(t,e),n=e,i=Tt,s=bt,o=bt,a=Tt;for(;r!==Tt;){let f=n/r,u=n%r,h=i-o*f,l=s-a*f;n=r,r=u,i=o,s=a,o=h,a=l}if(n!==bt)throw new Error("invert: does not exist");return at(i,e)}function Oh(t){let e=(t-bt)/sr,r,n,i;for(r=t-bt,n=0;r%sr===Tt;r/=sr,n++);for(i=sr;i<t&&Bs(i,e,t)!==t-bt;i++);if(n===1){let o=(t+bt)/Ss;return function(c,f){let u=c.pow(f,o);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(r+bt)/sr;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(c,s),l=a.pow(c,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let g=1;for(let p=a.sqr(l);g<f&&!a.eql(p,a.ONE);g++)p=a.sqr(p);let d=a.pow(u,bt<<BigInt(f-g-1));u=a.sqr(d),h=a.mul(h,d),l=a.mul(l,u),f=g}return h}}function Mh(t){if(t%Ss===Ph){let e=(t+bt)/Ss;return function(n,i){let s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%$a===Ga){let e=(t-Ga)/$a;return function(n,i){let s=n.mul(i,sr),o=n.pow(s,e),a=n.mul(i,o),c=n.mul(n.mul(a,sr),o),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return t%Kh,Oh(t)}var Wa=(t,e)=>(at(t,e)&bt)===bt,Fh=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function As(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Fh.reduce((n,i)=>(n[i]="function",n),e);return ee(t,r)}function Vh(t,e,r){if(r<Tt)throw new Error("Expected power > 0");if(r===Tt)return t.ONE;if(r===bt)return e;let n=t.ONE,i=e;for(;r>Tt;)r&bt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=bt;return n}function Hh(t,e){let r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function Cs(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ci(t,e,r=!1,n={}){if(t<=Tt)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:s}=Cs(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Mh(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:an(i),ZERO:Tt,ONE:bt,create:c=>at(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Tt<=c&&c<t},is0:c=>c===Tt,isOdd:c=>(c&bt)===bt,neg:c=>at(-c,t),eql:(c,f)=>c===f,sqr:c=>at(c*c,t),add:(c,f)=>at(c+f,t),sub:(c,f)=>at(c-f,t),mul:(c,f)=>at(c*f,t),pow:(c,f)=>Vh(a,c,f),div:(c,f)=>at(c*ai(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>ai(c,t),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Hh(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?_e(c,s):qe(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?ce(c):Te(c)}});return Object.freeze(a)}function Ya(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function Za(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function Is(t){let e=Za(t);return e+Math.ceil(e/2)}function Xa(t,e,r=!1){let n=t.length,i=Za(e),s=Is(e);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);let o=r?Te(t):ce(t),a=at(o,e-bt)+bt;return r?_e(a,i):qe(a,i)}var zh=BigInt(0),Ts=BigInt(1);function fi(t,e){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=t.ZERO,a=i;for(;s>zh;)s&Ts&&(o=o.add(a)),a=a.double(),s>>=Ts;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),c=[],f=i,u=f;for(let h=0;h<o;h++){u=f,c.push(u);for(let l=1;l<a;l++)u=u.add(f),c.push(u);f=u.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=n(i),f=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,g=BigInt(i);for(let d=0;d<a;d++){let p=d*c,y=Number(o&h);o>>=g,y>c&&(y-=l,o+=Ts);let x=p,v=p+Math.abs(y)-1,m=d%2!==0,A=y<0;y===0?u=u.add(r(m,s[x])):f=f.add(r(A,s[v]))}return{p:f,f:u}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,f=s.get(i);return f||(f=this.precomputeWindow(i,c),c!==1&&s.set(i,a(f))),this.wNAF(c,f,o)}}}function cn(t){return As(t.Fp),ee(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Cs(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var fe=BigInt(0),Qt=BigInt(1),ui=BigInt(2),Gh=BigInt(8),$h={zip215:!0};function Wh(t){let e=cn(t);return ee(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function hi(t){let e=Wh(t),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,f=ui<<BigInt(a*8)-Qt,u=r.create,h=e.uvRatio||((L,w)=>{try{return{isValid:!0,value:r.sqrt(L*r.inv(w))}}catch{return{isValid:!1,value:fe}}}),l=e.adjustScalarBytes||(L=>L),g=e.domain||((L,w,P)=>{if(w.length||P)throw new Error("Contexts/pre-hash are not supported");return L}),d=L=>typeof L=="bigint"&&fe<L,p=(L,w)=>d(L)&&d(w)&&L<w,y=L=>L===fe||p(L,f);function x(L,w){if(p(L,w))return L;throw new Error(`Expected valid scalar < ${w}, got ${typeof L} ${L}`)}function v(L){return L===fe?L:x(L,n)}let m=new Map;function A(L){if(!(L instanceof S))throw new Error("ExtendedPoint expected")}class S{constructor(w,P,K,V){if(this.ex=w,this.ey=P,this.ez=K,this.et=V,!y(w))throw new Error("x required");if(!y(P))throw new Error("y required");if(!y(K))throw new Error("z required");if(!y(V))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(w){if(w instanceof S)throw new Error("extended point not allowed");let{x:P,y:K}=w||{};if(!y(P)||!y(K))throw new Error("invalid affine point");return new S(P,K,Qt,u(P*K))}static normalizeZ(w){let P=r.invertBatch(w.map(K=>K.ez));return w.map((K,V)=>K.toAffine(P[V])).map(S.fromAffine)}_setWindowSize(w){this._WINDOW_SIZE=w,m.delete(this)}assertValidity(){let{a:w,d:P}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:K,ey:V,ez:W,et:Y}=this,et=u(K*K),X=u(V*V),J=u(W*W),dt=u(J*J),ut=u(et*w),Ut=u(J*u(ut+X)),Kt=u(dt+u(P*u(et*X)));if(Ut!==Kt)throw new Error("bad point: equation left != right (1)");let Ct=u(K*V),Vt=u(W*Y);if(Ct!==Vt)throw new Error("bad point: equation left != right (2)")}equals(w){A(w);let{ex:P,ey:K,ez:V}=this,{ex:W,ey:Y,ez:et}=w,X=u(P*et),J=u(W*V),dt=u(K*et),ut=u(Y*V);return X===J&&dt===ut}is0(){return this.equals(S.ZERO)}negate(){return new S(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:w}=e,{ex:P,ey:K,ez:V}=this,W=u(P*P),Y=u(K*K),et=u(ui*u(V*V)),X=u(w*W),J=P+K,dt=u(u(J*J)-W-Y),ut=X+Y,Ut=ut-et,Kt=X-Y,Ct=u(dt*Ut),Vt=u(ut*Kt),Se=u(dt*Kt),tr=u(Ut*ut);return new S(Ct,Vt,tr,Se)}add(w){A(w);let{a:P,d:K}=e,{ex:V,ey:W,ez:Y,et}=this,{ex:X,ey:J,ez:dt,et:ut}=w;if(P===BigInt(-1)){let ia=u((W-V)*(J+X)),sa=u((W+V)*(J-X)),Yi=u(sa-ia);if(Yi===fe)return this.double();let oa=u(Y*ui*ut),aa=u(et*ui*dt),ca=aa+oa,fa=sa+ia,ua=aa-oa,du=u(ca*Yi),pu=u(fa*ua),yu=u(ca*ua),gu=u(Yi*fa);return new S(du,pu,gu,yu)}let Ut=u(V*X),Kt=u(W*J),Ct=u(et*K*ut),Vt=u(Y*dt),Se=u((V+W)*(X+J)-Ut-Kt),tr=Vt-Ct,rn=Vt+Ct,na=u(Kt-P*Ut),fu=u(Se*tr),uu=u(rn*na),hu=u(Se*na),lu=u(tr*rn);return new S(fu,uu,lu,hu)}subtract(w){return this.add(w.negate())}wNAF(w){return _.wNAFCached(this,m,w,S.normalizeZ)}multiply(w){let{p:P,f:K}=this.wNAF(x(w,n));return S.normalizeZ([P,K])[0]}multiplyUnsafe(w){let P=v(w);return P===fe?R:this.equals(R)||P===Qt?this:this.equals(B)?this.wNAF(P).p:_.unsafeLadder(this,P)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(w){let{ex:P,ey:K,ez:V}=this,W=this.is0();w==null&&(w=W?Gh:r.inv(V));let Y=u(P*w),et=u(K*w),X=u(V*w);if(W)return{x:fe,y:Qt};if(X!==Qt)throw new Error("invZ was invalid");return{x:Y,y:et}}clearCofactor(){let{h:w}=e;return w===Qt?this:this.multiplyUnsafe(w)}static fromHex(w,P=!1){let{d:K,a:V}=e,W=r.BYTES;w=yt("pointHex",w,W);let Y=w.slice(),et=w[W-1];Y[W-1]=et&-129;let X=ce(Y);X===fe||(P?x(X,f):x(X,r.ORDER));let J=u(X*X),dt=u(J-Qt),ut=u(K*J-V),{isValid:Ut,value:Kt}=h(dt,ut);if(!Ut)throw new Error("Point.fromHex: invalid y coordinate");let Ct=(Kt&Qt)===Qt,Vt=(et&128)!==0;if(!P&&Kt===fe&&Vt)throw new Error("Point.fromHex: x=0 and x_0=1");return Vt!==Ct&&(Kt=u(-Kt)),S.fromAffine({x:Kt,y:X})}static fromPrivateKey(w){return U(w).point}toRawBytes(){let{x:w,y:P}=this.toAffine(),K=_e(P,r.BYTES);return K[K.length-1]|=w&Qt?128:0,K}toHex(){return Ie(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,Qt,u(e.Gx*e.Gy)),S.ZERO=new S(fe,Qt,Qt,fe);let{BASE:B,ZERO:R}=S,_=fi(S,a*8);function O(L){return at(L,n)}function M(L){return O(ce(L))}function U(L){let w=a;L=yt("private key",L,w);let P=yt("hashed private key",s(L),2*w),K=l(P.slice(0,w)),V=P.slice(w,2*w),W=M(K),Y=B.multiply(W),et=Y.toRawBytes();return{head:K,prefix:V,scalar:W,point:Y,pointBytes:et}}function q(L){return U(L).pointBytes}function z(L=new Uint8Array,...w){let P=Le(...w);return M(s(g(P,yt("context",L),!!i)))}function Z(L,w,P={}){L=yt("message",L),i&&(L=i(L));let{prefix:K,scalar:V,pointBytes:W}=U(w),Y=z(P.context,K,L),et=B.multiply(Y).toRawBytes(),X=z(P.context,et,W,L),J=O(Y+X*V);v(J);let dt=Le(et,_e(J,r.BYTES));return yt("result",dt,a*2)}let C=$h;function N(L,w,P,K=C){let{context:V,zip215:W}=K,Y=r.BYTES;L=yt("signature",L,2*Y),w=yt("message",w),i&&(w=i(w));let et=ce(L.slice(Y,2*Y)),X,J,dt;try{X=S.fromHex(P,W),J=S.fromHex(L.slice(0,Y),W),dt=B.multiplyUnsafe(et)}catch{return!1}if(!W&&X.isSmallOrder())return!1;let ut=z(V,J.toRawBytes(),X.toRawBytes(),w);return J.add(X.multiplyUnsafe(ut)).subtract(dt).clearCofactor().equals(S.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:q,sign:Z,verify:N,ExtendedPoint:S,utils:{getExtendedPublicKey:U,randomPrivateKey:()=>o(r.BYTES),precompute(L=8,w=S.BASE){return w._setWindowSize(L),w.multiply(BigInt(3)),w}}}}var fn=BigInt(0),_s=BigInt(1);function Yh(t){return ee(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Qa(t){let e=Yh(t),{P:r}=e,n=m=>at(m,r),i=e.montgomeryBits,s=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(m=>m),c=e.powPminus2||(m=>Bs(m,r-BigInt(2),r));function f(m,A,S){let B=n(m*(A-S));return A=n(A-B),S=n(S+B),[A,S]}function u(m){if(typeof m=="bigint"&&fn<=m&&m<r)return m;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function l(m,A){let S=u(m),B=u(A),R=S,_=_s,O=fn,M=S,U=_s,q=fn,z;for(let C=BigInt(i-1);C>=fn;C--){let N=B>>C&_s;q^=N,z=f(q,_,M),_=z[0],M=z[1],z=f(q,O,U),O=z[0],U=z[1],q=N;let T=_+O,L=n(T*T),w=_-O,P=n(w*w),K=L-P,V=M+U,W=M-U,Y=n(W*T),et=n(V*w),X=Y+et,J=Y-et;M=n(X*X),U=n(R*n(J*J)),_=n(L*P),O=n(K*(L+n(h*K)))}z=f(q,_,M),_=z[0],M=z[1],z=f(q,O,U),O=z[0],U=z[1];let Z=c(O);return n(_*Z)}function g(m){return _e(n(m),s)}function d(m){let A=yt("u coordinate",m,s);return o===s&&(A[o-1]&=127),ce(A)}function p(m){let A=yt("scalar",m);if(A.length!==s&&A.length!==o)throw new Error(`Expected ${s} or ${o} bytes, got ${A.length}`);return ce(a(A))}function y(m,A){let S=d(A),B=p(m),R=l(S,B);if(R===fn)throw new Error("Invalid private or public key received");return g(R)}let x=g(e.Gu);function v(m){return y(m,x)}return{scalarMult:y,scalarMultBase:v,getSharedSecret:(m,A)=>y(m,A),getPublicKey:m=>v(m),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:x}}var un=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ja=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Cx=BigInt(0),Zh=BigInt(1),Ls=BigInt(2),Xh=BigInt(5),ja=BigInt(10),Qh=BigInt(20),Jh=BigInt(40),t0=BigInt(80);function e0(t){let e=un,n=t*t%e*t%e,i=gt(n,Ls,e)*n%e,s=gt(i,Zh,e)*t%e,o=gt(s,Xh,e)*s%e,a=gt(o,ja,e)*o%e,c=gt(a,Qh,e)*a%e,f=gt(c,Jh,e)*c%e,u=gt(f,t0,e)*f%e,h=gt(u,t0,e)*f%e,l=gt(h,ja,e)*o%e;return{pow_p_5_8:gt(l,Ls,e)*t%e,b2:n}}function r0(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function jh(t,e){let r=un,n=at(e*e*e,r),i=at(n*n*e,r),s=e0(t*i).pow_p_5_8,o=at(t*n*s,r),a=at(e*o*o,r),c=o,f=at(o*Ja,r),u=a===t,h=a===at(-t,r),l=a===at(-t*Ja,r);return u&&(o=c),(h||l)&&(o=f),Wa(o,r)&&(o=at(-o,r)),{isValid:u||h,value:o}}var Re=ci(un,void 0,!0),Rs={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Re,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:bs,randomBytes:nr,adjustScalarBytes:r0,uvRatio:jh},Lr=hi(Rs);function n0(t,e,r){if(e.length>255)throw new Error("Context is too big");return ei(gs("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var Ix=hi({...Rs,domain:n0}),Tx=hi({...Rs,domain:n0,prehash:bs}),hn=Qa({P:un,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=un,{pow_p_5_8:r,b2:n}=e0(t);return at(gt(r,BigInt(3),e)*n,e)},adjustScalarBytes:r0,randomBytes:nr});var tl=(Re.ORDER+BigInt(3))/BigInt(8),_x=Re.pow(Ls,tl),Lx=Re.sqrt(Re.neg(Re.ONE)),Rx=(Re.ORDER-BigInt(5))/BigInt(8),Nx=BigInt(486662);var Dx=Ya(Re,Re.neg(BigInt(486664)));var kx=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Px=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Ux=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Kx=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Ox=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var li=class extends Tr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,on(e);let n=Fe(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Ir(this),this.iHash.update(e),this}digestInto(e){Ir(this),ys(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Rr=(t,e,r)=>new li(t,e).update(r).digest();Rr.create=(t,e)=>new li(t,e);function s0(t,e,r){return on(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Rr(t,Fe(r),Fe(e))}var Ns=new Uint8Array([0]),i0=new Uint8Array;function o0(t,e,r,n=32){if(on(t),Jn(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/t.outputLen);r===void 0&&(r=i0);let s=new Uint8Array(i*t.outputLen),o=Rr.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let f=0;f<i;f++)Ns[0]=f+1,a.update(f===0?i0:c).update(r).update(Ns).digestInto(c),s.set(c,t.outputLen*f),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Ns.fill(0),s.slice(0,n)}var el=(t,e,r)=>t&e^~t&r,rl=(t,e,r)=>t&e^t&r^e&r,nl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ze=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ge=new Uint32Array(64),Ds=class extends _r{constructor(){super(64,32,8,!1),this.A=ze[0]|0,this.B=ze[1]|0,this.C=ze[2]|0,this.D=ze[3]|0,this.E=ze[4]|0,this.F=ze[5]|0,this.G=ze[6]|0,this.H=ze[7]|0}get(){let{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)Ge[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=Ge[h-15],g=Ge[h-2],d=ae(l,7)^ae(l,18)^l>>>3,p=ae(g,17)^ae(g,19)^g>>>10;Ge[h]=p+Ge[h-7]+d+Ge[h-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:f,H:u}=this;for(let h=0;h<64;h++){let l=ae(a,6)^ae(a,11)^ae(a,25),g=u+l+el(a,c,f)+nl[h]+Ge[h]|0,p=(ae(n,2)^ae(n,13)^ae(n,22))+rl(n,i,s)|0;u=f,f=c,c=a,a=o+g|0,o=s,s=i,i=n,n=g+p|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,i,s,o,a,c,f,u)}roundClean(){Ge.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Nr=ri(()=>new Ds);var di={hashSHA256(t){return Nr(t)},getHKDF(t,e){let r=s0(Nr,e,t),i=o0(Nr,r,void 0,96),s=i.subarray(0,32),o=i.subarray(32,64),a=i.subarray(64,96);return[s,o,a]},generateX25519KeyPair(){let t=hn.utils.randomPrivateKey();return{publicKey:hn.getPublicKey(t),privateKey:t}},generateX25519KeyPairFromSeed(t){return{publicKey:hn.getPublicKey(t),privateKey:t}},generateX25519SharedKey(t,e){return hn.getSharedSecret(t,e)},chaCha20Poly1305Encrypt(t,e,r,n){return ps(n,e,r).encrypt(t)},chaCha20Poly1305Decrypt(t,e,r,n,i){return ps(n,e,r).decrypt(t,i)}};var a0=di;var Dr=t=>{let e=It(2);return new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(0,t,!1),e};Dr.bytes=2;var ln=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t instanceof Uint8Array?new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0,!1):t.getUint16(0)};ln.bytes=2;function c0(t){return new Rt(t.ne,t.ciphertext)}function f0(t){return new Rt(t.ne,t.ns,t.ciphertext)}function u0(t){return new Rt(t.ns,t.ciphertext)}function h0(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.subarray(0,32),ciphertext:t.subarray(32,t.length),ns:rt(0)}}function l0(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.subarray(0,32),ns:t.subarray(32,80),ciphertext:t.subarray(80,t.length)}}function d0(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:rt(0),ns:t.subarray(0,48),ciphertext:t.subarray(48,t.length)}}var y0=16;function g0(t,e){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let s=i+65519;s>n.length&&(s=n.length);let o;i===0&&s===n.byteLength&&n instanceof Uint8Array?o=t.encrypt(n,t.session):o=t.encrypt(n.subarray(i,s),t.session),e?.encryptedPackets.increment(),yield new Rt(Dr(o.byteLength),o)}}}function x0(t,e){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let s=i+65535;if(s>n.length&&(s=n.length),s-y0<i)throw new Error("Invalid chunk");let o=n.subarray(i,s),a=n.subarray(i,s-y0),{plaintext:c,valid:f}=t.decrypt(o,t.session,a);if(!f)throw e?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");e?.decryptedPackets.increment(),yield c}}}var it=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}},pn=class t extends Error{code;constructor(e="Unexpected Peer"){super(e),this.code=t.code}static code="ERR_UNEXPECTED_PEER"},or=class t extends Error{code;constructor(e="Invalid crypto exchange"){super(e),this.code=t.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"};var Fv=zt(mn(),1),Vv=zt(Dc(),1);var x1=zt(lt(),1);var oo={};_t(oo,{base10:()=>Dp});function Tp(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,y=0,x=0,v=d.length;x!==v&&d[x]===0;)x++,p++;for(var m=(v-x)*u+1>>>0,A=new Uint8Array(m);x!==v;){for(var S=d[x],B=0,R=m-1;(S!==0||B<y)&&R!==-1;R--,B++)S+=256*A[R]>>>0,A[R]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");y=B,x++}for(var _=m-y;_!==m&&A[_]===0;)_++;for(var O=c.repeat(p);_<m;++_)O+=t.charAt(A[_]);return O}function l(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var y=0,x=0;d[p]===c;)y++,p++;for(var v=(d.length-p)*f+1>>>0,m=new Uint8Array(v);d[p];){var A=r[d.charCodeAt(p)];if(A===255)return;for(var S=0,B=v-1;(A!==0||S<x)&&B!==-1;B--,S++)A+=a*m[B]>>>0,m[B]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");x=S,p++}if(d[p]!==" "){for(var R=v-x;R!==v&&m[R]===0;)R++;for(var _=new Uint8Array(y+(v-R)),O=y;R!==v;)_[O++]=m[R++];return _}}}function g(d){var p=l(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var _p=Tp,Lp=_p,kc=Lp;var K2=new Uint8Array(0);var Pc=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Pe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Uc=t=>new TextEncoder().encode(t),Kc=t=>new TextDecoder().decode(t);var ro=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},no=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Mc(this,e)}},io=class{constructor(e){this.decoders=e}or(e){return Mc(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Mc=(t,e)=>new io({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),so=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ro(e,r,n),this.decoder=new no(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Or=({name:t,prefix:e,encode:r,decode:n})=>new so(t,e,r,n),Xe=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=kc(r,e);return Or({prefix:t,name:e,encode:n,decode:s=>Pe(i(s))})},Rp=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,f=0;for(let u=0;u<s;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Np=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},St=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Or({prefix:e,name:t,encode(i){return Np(i,n,r)},decode(i){return Rp(i,n,r,t)}});var Dp=Xe({prefix:"9",name:"base10",alphabet:"0123456789"});var ao={};_t(ao,{base16:()=>kp,base16upper:()=>Pp});var kp=St({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Pp=St({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var co={};_t(co,{base2:()=>Up});var Up=St({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fo={};_t(fo,{base256emoji:()=>Vp});var Fc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Kp=Fc.reduce((t,e,r)=>(t[r]=e,t),[]),Op=Fc.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Mp(t){return t.reduce((e,r)=>(e+=Kp[r],e),"")}function Fp(t){let e=[];for(let r of t){let n=Op[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Vp=Or({prefix:"\u{1F680}",name:"base256emoji",encode:Mp,decode:Fp});var uo={};_t(uo,{base32:()=>Qe,base32hex:()=>Gp,base32hexpad:()=>Wp,base32hexpadupper:()=>Yp,base32hexupper:()=>$p,base32pad:()=>qp,base32padupper:()=>zp,base32upper:()=>Hp,base32z:()=>Zp});var Qe=St({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hp=St({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qp=St({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zp=St({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Gp=St({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$p=St({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wp=St({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yp=St({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zp=St({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ho={};_t(ho,{base36:()=>Xp,base36upper:()=>Qp});var Xp=Xe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Qp=Xe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var lo={};_t(lo,{base58btc:()=>Mt,base58flickr:()=>Jp});var Mt=Xe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Jp=Xe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var po={};_t(po,{base64:()=>Mr,base64pad:()=>jp,base64url:()=>ty,base64urlpad:()=>ey});var Mr=St({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jp=St({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ty=St({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ey=St({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var yo={};_t(yo,{base8:()=>ry});var ry=St({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var go={};_t(go,{identity:()=>ny});var ny=Or({prefix:"\0",name:"identity",encode:t=>Kc(t),decode:t=>Uc(t)});var J2=new TextEncoder,j2=new TextDecoder;var mo={};_t(mo,{identity:()=>Je});var oy=qc,Vc=128,ay=127,cy=~ay,fy=Math.pow(2,31);function qc(t,e,r){e=e||[],r=r||0;for(var n=r;t>=fy;)e[r++]=t&255|Vc,t/=128;for(;t&cy;)e[r++]=t&255|Vc,t>>>=7;return e[r]=t|0,qc.bytes=r-n+1,e}var uy=xo,hy=128,Hc=127;function xo(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw xo.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Hc)<<i:(o&Hc)*Math.pow(2,i),i+=7}while(o>=hy);return xo.bytes=s-n,r}var ly=Math.pow(2,7),dy=Math.pow(2,14),py=Math.pow(2,21),yy=Math.pow(2,28),gy=Math.pow(2,35),xy=Math.pow(2,42),my=Math.pow(2,49),by=Math.pow(2,56),vy=Math.pow(2,63),wy=function(t){return t<ly?1:t<dy?2:t<py?3:t<yy?4:t<gy?5:t<xy?6:t<my?7:t<by?8:t<vy?9:10},Ey={encode:oy,decode:uy,encodingLength:wy},Sy=Ey,wn=Sy;var En=(t,e=0)=>[wn.decode(t,e),wn.decode.bytes],Fr=(t,e,r=0)=>(wn.encode(t,e,r),e),Vr=t=>wn.encodingLength(t);var ve=(t,e)=>{let r=e.byteLength,n=Vr(t),i=n+Vr(r),s=new Uint8Array(i+r);return Fr(t,s,0),Fr(r,s,n),s.set(e,i),new Hr(t,r,e,s)},Sn=t=>{let e=Pe(t),[r,n]=En(e),[i,s]=En(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Hr(r,i,o,e)},zc=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Pc(t.bytes,r.bytes)}},Hr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Gc=0,By="identity",$c=Pe,Ay=t=>ve(Gc,$c(t)),Je={code:Gc,name:By,encode:$c,digest:Ay};var wo={};_t(wo,{sha256:()=>Ft,sha512:()=>Cy});var vo=({name:t,code:e,encode:r})=>new bo(t,e,r),bo=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ve(this.code,r):r.then(n=>ve(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Yc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Ft=vo({name:"sha2-256",code:18,encode:Yc("SHA-256")}),Cy=vo({name:"sha2-512",code:19,encode:Yc("SHA-512")});var Zc=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Ty(r,Eo(t),e||Mt.encoder);default:return _y(r,Eo(t),e||Qe.encoder)}};var Xc=new WeakMap,Eo=t=>{let e=Xc.get(t);if(e==null){let r=new Map;return Xc.set(t,r),r}return e},lr=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Bn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ly)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ve(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&zc(e.multihash,n.multihash)}toString(e){return Zc(this,e)}toJSON(){return{"/":Zc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:o}=r;return new t(n,i,s,o||Qc(n,i,s.bytes))}else if(r[Ry]===!0){let{version:n,multihash:i,code:s}=r,o=Sn(i);return t.create(n,s,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Bn)throw new Error(`Version 0 CID must use dag-pb (code: ${Bn}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=Qc(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Bn,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Pe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new Hr(r.multihashCode,r.digestSize,s,i);return[r.version===0?t.createV0(o):t.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=En(e.subarray(r));return r+=l,h},i=n(),s=Bn;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=Iy(e,r),s=t.decode(i);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Eo(s).set(n,e),s}},Iy=(t,e)=>{switch(t[0]){case"Q":{let r=e||Mt;return[Mt.prefix,r.decode(`${Mt.prefix}${t}`)]}case Mt.prefix:{let r=e||Mt;return[Mt.prefix,r.decode(t)]}case Qe.prefix:{let r=e||Qe;return[Qe.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Ty=(t,e,r)=>{let{prefix:n}=r;if(n!==Mt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},_y=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},Bn=112,Ly=18,Qc=(t,e,r)=>{let n=Vr(t),i=n+Vr(e),s=new Uint8Array(i+r.byteLength);return Fr(t,s,0),Fr(e,s,n),s.set(r,i),s},Ry=Symbol.for("@ipld/js-cid/CID");var zr={...go,...co,...yo,...oo,...ao,...uo,...ho,...lo,...po,...fo},ym={...wo,...mo};function jc(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Jc=jc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),So=jc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=It(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ny={utf8:Jc,"utf-8":Jc,hex:zr.base16,latin1:So,ascii:So,binary:So,...zr},Di=Ny;function At(t,e="utf8"){let r=Di[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Be(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var Mo={};_t(Mo,{Ed25519PrivateKey:()=>mr,Ed25519PublicKey:()=>Tn,generateKeyPair:()=>zy,generateKeyPairFromSeed:()=>yf,unmarshalEd25519PrivateKey:()=>Hy,unmarshalEd25519PublicKey:()=>qy});var Gr=32,Ue=64,ki=32;async function tf(){let t=Lr.utils.randomPrivateKey(),e=Lr.getPublicKey(t);return{privateKey:sf(t,e),publicKey:e}}async function ef(t){if(t.length!==ki)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Lr.getPublicKey(e);return{privateKey:sf(e,r),publicKey:r}}async function rf(t,e){let r=t.subarray(0,ki);return Lr.sign(e instanceof Uint8Array?e:e.subarray(),r)}async function nf(t,e,r){return Lr.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}function sf(t,e){let r=new Uint8Array(Ue);for(let n=0;n<ki;n++)r[n]=t[n],r[ki+n]=e[n];return r}var Zt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Bo={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Ao(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",s=t?.saltLength??16,o=t?.iterations??32767,a=Zt.get();r*=8;async function c(h,l){let g=a.getRandomValues(new Uint8Array(s)),d=a.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof l=="string"&&(l=At(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",Bo,{name:"AES-GCM"},!0,["encrypt"]);try{let v={name:"PBKDF2",salt:g,iterations:o,hash:{name:i}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(v,m,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",Bo,{name:"AES-GCM"},!0,["encrypt"])}}else{let v={name:"PBKDF2",salt:g,iterations:o,hash:{name:i}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(v,m,{name:e,length:r},!0,["encrypt"])}let x=await a.subtle.encrypt(p,y,h);return Gt([g,p.iv,new Uint8Array(x)])}async function f(h,l){let g=h.subarray(0,s),d=h.subarray(s,s+n),p=h.subarray(s+n),y={name:e,iv:d};typeof l=="string"&&(l=At(l));let x;if(l.length===0)try{let m={name:"PBKDF2",salt:g,iterations:o,hash:{name:i}},A=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(m,A,{name:e,length:r},!0,["decrypt"])}catch{x=await a.subtle.importKey("jwk",Bo,{name:"AES-GCM"},!0,["decrypt"])}else{let m={name:"PBKDF2",salt:g,iterations:o,hash:{name:i}},A=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(m,A,{name:e,length:r},!0,["decrypt"])}let v=await a.subtle.decrypt(y,x,p);return new Uint8Array(v)}return{encrypt:c,decrypt:f}}async function $r(t,e){let n=await Ao().encrypt(t,e);return Mr.encode(n)}var Co=new Float32Array([-0]),je=new Uint8Array(Co.buffer);function af(t,e,r){Co[0]=t,e[r]=je[0],e[r+1]=je[1],e[r+2]=je[2],e[r+3]=je[3]}function cf(t,e){return je[0]=t[e],je[1]=t[e+1],je[2]=t[e+2],je[3]=t[e+3],Co[0]}var Io=new Float64Array([-0]),qt=new Uint8Array(Io.buffer);function ff(t,e,r){Io[0]=t,e[r]=qt[0],e[r+1]=qt[1],e[r+2]=qt[2],e[r+3]=qt[3],e[r+4]=qt[4],e[r+5]=qt[5],e[r+6]=qt[6],e[r+7]=qt[7]}function uf(t,e){return qt[0]=t[e],qt[1]=t[e+1],qt[2]=t[e+2],qt[3]=t[e+3],qt[4]=t[e+4],qt[5]=t[e+5],qt[6]=t[e+6],qt[7]=t[e+7],Io[0]}var ky=BigInt(Number.MAX_SAFE_INTEGER),Py=BigInt(Number.MIN_SAFE_INTEGER),Xt=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return dr;if(e<ky&&e>Py)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,i=e-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>hf&&(i=0n,++n>hf&&(n=0n))),new t(Number(i),Number(n))}static fromNumber(e){if(e===0)return dr;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(n,i)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):dr}},dr=new Xt(0,0);dr.toBigInt=function(){return 0n};dr.zzEncode=dr.zzDecode=function(){return this};dr.length=function(){return 1};var hf=4294967296n;function lf(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function df(t,e,r){if(r-e<1)return"";let i,s=[],o=0,a;for(;e<r;)a=t[e++],a<128?s[o++]=a:a>191&&a<224?s[o++]=(a&31)<<6|t[e++]&63:a>239&&a<365?(a=((a&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,s[o++]=55296+(a>>10),s[o++]=56320+(a&1023)):s[o++]=(a&15)<<12|(t[e++]&63)<<6|t[e++]&63,o>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,s)),o=0);return i!=null?(o>0&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))}function To(t,e,r){let n=r,i,s;for(let o=0;o<t.length;++o)i=t.charCodeAt(o),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&((s=t.charCodeAt(o+1))&64512)===56320?(i=65536+((i&1023)<<10)+(s&1023),++o,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128);return r-n}function le(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function Pi(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var _o=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,le(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw le(this,4);return Pi(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw le(this,4);return Pi(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw le(this,4);let e=cf(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw le(this,4);let e=uf(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw le(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return df(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw le(this,e);this.pos+=e}else do if(this.pos>=this.len)throw le(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new Xt(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw le(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw le(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw le(this,8);let e=Pi(this.buf,this.pos+=4),r=Pi(this.buf,this.pos+=4);return new Xt(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function Lo(t){return new _o(t instanceof Uint8Array?t:t.subarray())}function pr(t,e){let r=Lo(t);return e.decode(r)}function Ro(t){let e=t??8192,r=e>>>1,n,i=e;return function(o){if(o<1||o>r)return It(o);i+o>e&&(n=It(e),i=0);let a=n.subarray(i,i+=o);return i&7&&(i=(i|7)+1),a}}var yr=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function No(){}var ko=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},Uy=Ro();function Ky(t){return globalThis.Buffer!=null?It(t):Uy(t)}var In=class{len;head;tail;states;constructor(){this.len=0,this.head=new yr(No,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new yr(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new Po((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(An,10,Xt.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=Xt.fromBigInt(e);return this._push(An,r.length(),r)}uint64Number(e){let r=Xt.fromNumber(e);return this._push(An,r.length(),r)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=Xt.fromBigInt(e).zzEncode();return this._push(An,r.length(),r)}sint64Number(e){let r=Xt.fromNumber(e).zzEncode();return this._push(An,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(Do,1,e?1:0)}fixed32(e){return this._push(Cn,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=Xt.fromBigInt(e);return this._push(Cn,4,r.lo)._push(Cn,4,r.hi)}fixed64Number(e){let r=Xt.fromNumber(e);return this._push(Cn,4,r.lo)._push(Cn,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(af,4,e)}double(e){return this._push(ff,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(Do,1,0):this.uint32(r)._push(My,r,e)}string(e){let r=lf(e);return r!==0?this.uint32(r)._push(To,r,e):this._push(Do,1,0)}fork(){return this.states=new ko(this),this.head=this.tail=new yr(No,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new yr(No,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=Ky(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function Do(t,e,r){e[r]=t&255}function Oy(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var Po=class extends yr{next;constructor(e,r){super(Oy,e,r),this.next=void 0}};function An(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Cn(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function My(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(In.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push(Fy,e,t),this},In.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(Vy,e,t),this});function Fy(t,e,r){e.set(t,r)}function Vy(t,e,r){t.length<40?To(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(At(t),r)}function Uo(){return new In}function gr(t,e){let r=Uo();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Wr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Wr||(Wr={}));function Ui(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Ko(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(s,o){let a=e(s);o.int32(a)},n=function(s){let o=s.int32();return e(o)};return Ui("enum",Wr.VARINT,r,n)}function xr(t,e){return Ui("message",Wr.LENGTH_DELIMITED,t,e)}var wt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(wt||(wt={}));var Oo;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Oo||(Oo={}));(function(t){t.codec=()=>Ko(Oo)})(wt||(wt={}));var we;(function(t){let e;t.codec=()=>(e==null&&(e=xr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>gr(r,t.codec()),t.decode=r=>pr(r,t.codec())})(we||(we={}));var Ee;(function(t){let e;t.codec=()=>(e==null&&(e=xr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>gr(r,t.codec()),t.decode=r=>pr(r,t.codec())})(Ee||(Ee={}));var Tn=class{_key;constructor(e){this._key=Yr(e,Gr)}async verify(e,r){return nf(this._key,r,e)}marshal(){return this._key}get bytes(){return we.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Lt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ft.digest(this.bytes);return e}},mr=class{_key;_publicKey;constructor(e,r){this._key=Yr(e,Ue),this._publicKey=Yr(r,Gr)}async sign(e){return rf(this._key,e)}get public(){return new Tn(this._publicKey)}marshal(){return this._key}get bytes(){return Ee.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Lt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ft.digest(this.bytes);return e}async id(){let e=Je.digest(this.public.bytes);return Mt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return $r(this.bytes,e);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Hy(t){if(t.length>Ue){t=Yr(t,Ue+Gr);let n=t.subarray(0,Ue),i=t.subarray(Ue,t.length);return new mr(n,i)}t=Yr(t,Ue);let e=t.subarray(0,Ue),r=t.subarray(Gr);return new mr(e,r)}function qy(t){return t=Yr(t,Gr),new Tn(t)}async function zy(){let{privateKey:t,publicKey:e}=await tf();return new mr(t,e)}async function yf(t){let{privateKey:e,publicKey:r}=await ef(t);return new mr(e,r)}function Yr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new it(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function Et(t,e="utf8"){let r=Di[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var pb=zt(Bt(),1),yb=zt(Ti(),1),gf=zt(lt(),1);function de(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Gt([new Uint8Array(e-r.length),r])}return Et(r,"base64url")}function Jt(t){let e=xf(t);return new gf.default.jsbn.BigInteger(Et(e,"base16"),16)}function xf(t,e){let r=At(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Gt([new Uint8Array(e-r.length),r])}return r}var Gy={"P-256":256,"P-384":384,"P-521":521},$y=Object.keys(Gy),Cb=$y.join(" / ");var zo={};_t(zo,{MAX_KEY_SIZE:()=>Nn,RsaPrivateKey:()=>Zr,RsaPublicKey:()=>Rn,fromJwk:()=>n1,generateKeyPair:()=>i1,unmarshalRsaPrivateKey:()=>e1,unmarshalRsaPublicKey:()=>r1});var Ln=zt(lt(),1);var uv=zt(Ef(),1);function Oi(t){if(isNaN(t)||t<=0)throw new it("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return nr(t)}var $b=zt(Ri(),1),Ho=zt(lt(),1);function Sf(t,e){return e.map(r=>Jt(t[r]))}function Bf(t){return Ho.default.pki.setRsaPrivateKey(...Sf(t,["n","e","d","p","q","dp","dq","qi"]))}function Af(t){return Ho.default.pki.setRsaPublicKey(...Sf(t,["n","e"]))}var vr={};_t(vr,{jwkToPkcs1:()=>Xy,jwkToPkix:()=>Jy,pkcs1ToJwk:()=>Zy,pkixToJwk:()=>Qy});var Zb=zt(mn(),1),Xb=zt(Ri(),1);var Ke=zt(lt(),1);function Zy(t){let e=Ke.default.asn1.fromDer(Et(t,"ascii")),r=Ke.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:de(r.n),e:de(r.e),d:de(r.d),p:de(r.p),q:de(r.q),dp:de(r.dP),dq:de(r.dQ),qi:de(r.qInv),alg:"RS256"}}function Xy(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new it("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ke.default.pki.privateKeyToAsn1({n:Jt(t.n),e:Jt(t.e),d:Jt(t.d),p:Jt(t.p),q:Jt(t.q),dP:Jt(t.dp),dQ:Jt(t.dq),qInv:Jt(t.qi)});return At(Ke.default.asn1.toDer(e).getBytes(),"ascii")}function Qy(t){let e=Ke.default.asn1.fromDer(Et(t,"ascii")),r=Ke.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:de(r.n),e:de(r.e)}}function Jy(t){if(t.n==null||t.e==null)throw new it("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ke.default.pki.publicKeyToAsn1({n:Jt(t.n),e:Jt(t.e)});return At(Ke.default.asn1.toDer(e).getBytes(),"ascii")}async function Cf(t){let e=await Zt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await _f(e);return{privateKey:r[0],publicKey:r[1]}}async function qo(t){let r=[await Zt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await jy(t)],n=await _f({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function If(t,e){let r=await Zt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Zt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}async function Tf(t,e,r){let n=await Zt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Zt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}async function _f(t){if(t.privateKey==null||t.publicKey==null)throw new it("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Zt.get().subtle.exportKey("jwk",t.privateKey),Zt.get().subtle.exportKey("jwk",t.publicKey)])}async function jy(t){return Zt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Lf(t,e,r,n){let i=e?Af(t):Bf(t),s=Et(r instanceof Uint8Array?r:r.subarray(),"ascii"),o=n(s,i);return At(o,"ascii")}function Rf(t,e){return Lf(t,!0,e,(r,n)=>n.encrypt(r))}function Nf(t,e){return Lf(t,!1,e,(r,n)=>n.decrypt(r))}function Mi(t){if(t.kty!=="RSA")throw new it("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new it("invalid key modulus","ERR_INVALID_KEY_MODULUS");return At(t.n,"base64url").length*8}var Nn=8192,Rn=class{_key;constructor(e){this._key=e}async verify(e,r){return Tf(this._key,r,e)}marshal(){return vr.jwkToPkix(this._key)}get bytes(){return we.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Rf(this._key,e)}equals(e){return Lt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ft.digest(this.bytes);return e}},Zr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Oi(16)}async sign(e){return If(this._key,e)}get public(){if(this._publicKey==null)throw new it("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Rn(this._publicKey)}decrypt(e){return Nf(this._key,e)}marshal(){return vr.jwkToPkcs1(this._key)}get bytes(){return Ee.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}equals(e){return Lt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ft.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Et(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Ln.default.util.ByteBuffer(this.marshal()),i=Ln.default.asn1.fromDer(n),s=Ln.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Ln.default.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return $r(this.bytes,e);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function e1(t){let e=vr.pkcs1ToJwk(t);if(Mi(e)>Nn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await qo(e);return new Zr(r.privateKey,r.publicKey)}function r1(t){let e=vr.pkixToJwk(t);if(Mi(e)>Nn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Rn(e)}async function n1(t){if(Mi(t)>Nn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await qo(t);return new Zr(e.privateKey,e.publicKey)}async function i1(t){if(t>Nn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Cf(t);return new Zr(e.privateKey,e.publicKey)}var Yo={};_t(Yo,{Secp256k1PrivateKey:()=>kn,Secp256k1PublicKey:()=>Dn,generateKeyPair:()=>g1,unmarshalSecp256k1PrivateKey:()=>p1,unmarshalSecp256k1PublicKey:()=>y1});function s1(t){let e=cn(t);ee(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:o1,hexToBytes:a1}=oi,wr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=wr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:o1(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=wr,r=typeof t=="string"?a1(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:s}=wr._parseInt(r.subarray(2)),{d:o,l:a}=wr._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(t){let e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,r=f=>{let u=f.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),s=n.length/2,o=i.length/2,a=r(s),c=r(o);return`30${r(o+s+4)}02${c}${i}02${a}${n}`}},Oe=BigInt(0),ie=BigInt(1),gv=BigInt(2),Df=BigInt(3),xv=BigInt(4);function c1(t){let e=s1(t),{Fp:r}=e,n=e.toBytes||((d,p,y)=>{let x=p.toAffine();return Le(Uint8Array.from([4]),r.toBytes(x.x),r.toBytes(x.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),x=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:x}});function s(d){let{a:p,b:y}=e,x=r.sqr(d),v=r.mul(x,d);return r.add(r.add(v,r.mul(d,p)),y)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(d){return typeof d=="bigint"&&Oe<d&&d<e.n}function a(d){if(!o(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(d){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:x,n:v}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=Ie(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(y*2,"0")}let m;try{m=typeof d=="bigint"?d:Te(yt("private key",d,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof d}`)}return x&&(m=at(m,v)),a(m),m}let f=new Map;function u(d){if(!(d instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,y,x){if(this.px=p,this.py=y,this.pz=x,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(x==null||!r.isValid(x))throw new Error("z required")}static fromAffine(p){let{x:y,y:x}=p||{};if(!p||!r.isValid(y)||!r.isValid(x))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let v=m=>r.eql(m,r.ZERO);return v(y)&&v(x)?h.ZERO:new h(y,x,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(x=>x.pz));return p.map((x,v)=>x.toAffine(y[v])).map(h.fromAffine)}static fromHex(p){let y=h.fromAffine(i(yt("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let x=r.sqr(y),v=s(p);if(!r.eql(x,v))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:x,pz:v}=this,{px:m,py:A,pz:S}=p,B=r.eql(r.mul(y,S),r.mul(m,v)),R=r.eql(r.mul(x,S),r.mul(A,v));return B&&R}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,x=r.mul(y,Df),{px:v,py:m,pz:A}=this,S=r.ZERO,B=r.ZERO,R=r.ZERO,_=r.mul(v,v),O=r.mul(m,m),M=r.mul(A,A),U=r.mul(v,m);return U=r.add(U,U),R=r.mul(v,A),R=r.add(R,R),S=r.mul(p,R),B=r.mul(x,M),B=r.add(S,B),S=r.sub(O,B),B=r.add(O,B),B=r.mul(S,B),S=r.mul(U,S),R=r.mul(x,R),M=r.mul(p,M),U=r.sub(_,M),U=r.mul(p,U),U=r.add(U,R),R=r.add(_,_),_=r.add(R,_),_=r.add(_,M),_=r.mul(_,U),B=r.add(B,_),M=r.mul(m,A),M=r.add(M,M),_=r.mul(M,U),S=r.sub(S,_),R=r.mul(M,O),R=r.add(R,R),R=r.add(R,R),new h(S,B,R)}add(p){u(p);let{px:y,py:x,pz:v}=this,{px:m,py:A,pz:S}=p,B=r.ZERO,R=r.ZERO,_=r.ZERO,O=e.a,M=r.mul(e.b,Df),U=r.mul(y,m),q=r.mul(x,A),z=r.mul(v,S),Z=r.add(y,x),C=r.add(m,A);Z=r.mul(Z,C),C=r.add(U,q),Z=r.sub(Z,C),C=r.add(y,v);let N=r.add(m,S);return C=r.mul(C,N),N=r.add(U,z),C=r.sub(C,N),N=r.add(x,v),B=r.add(A,S),N=r.mul(N,B),B=r.add(q,z),N=r.sub(N,B),_=r.mul(O,C),B=r.mul(M,z),_=r.add(B,_),B=r.sub(q,_),_=r.add(q,_),R=r.mul(B,_),q=r.add(U,U),q=r.add(q,U),z=r.mul(O,z),C=r.mul(M,C),q=r.add(q,z),z=r.sub(U,z),z=r.mul(O,z),C=r.add(C,z),U=r.mul(q,C),R=r.add(R,U),U=r.mul(N,C),B=r.mul(Z,B),B=r.sub(B,U),U=r.mul(Z,q),_=r.mul(N,_),_=r.add(_,U),new h(B,R,_)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return g.wNAFCached(this,f,p,y=>{let x=r.invertBatch(y.map(v=>v.pz));return y.map((v,m)=>v.toAffine(x[m])).map(h.fromAffine)})}multiplyUnsafe(p){let y=h.ZERO;if(p===Oe)return y;if(a(p),p===ie)return this;let{endo:x}=e;if(!x)return g.unsafeLadder(this,p);let{k1neg:v,k1:m,k2neg:A,k2:S}=x.splitScalar(p),B=y,R=y,_=this;for(;m>Oe||S>Oe;)m&ie&&(B=B.add(_)),S&ie&&(R=R.add(_)),_=_.double(),m>>=ie,S>>=ie;return v&&(B=B.negate()),A&&(R=R.negate()),R=new h(r.mul(R.px,x.beta),R.py,R.pz),B.add(R)}multiply(p){a(p);let y=p,x,v,{endo:m}=e;if(m){let{k1neg:A,k1:S,k2neg:B,k2:R}=m.splitScalar(y),{p:_,f:O}=this.wNAF(S),{p:M,f:U}=this.wNAF(R);_=g.constTimeNegate(A,_),M=g.constTimeNegate(B,M),M=new h(r.mul(M.px,m.beta),M.py,M.pz),x=_.add(M),v=O.add(U)}else{let{p:A,f:S}=this.wNAF(y);x=A,v=S}return h.normalizeZ([x,v])[0]}multiplyAndAddUnsafe(p,y,x){let v=h.BASE,m=(S,B)=>B===Oe||B===ie||!S.equals(v)?S.multiplyUnsafe(B):S.multiply(B),A=m(this,y).add(m(p,x));return A.is0()?void 0:A}toAffine(p){let{px:y,py:x,pz:v}=this,m=this.is0();p==null&&(p=m?r.ONE:r.inv(v));let A=r.mul(y,p),S=r.mul(x,p),B=r.mul(v,p);if(m)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:A,y:S}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===ie)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===ie?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return Ie(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,g=fi(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}function f1(t){let e=cn(t);return ee(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function kf(t){let e=f1(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(C){return Oe<C&&C<r.ORDER}function a(C){return at(C,n)}function c(C){return ai(C,n)}let{ProjectivePoint:f,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=c1({...e,toBytes(C,N,T){let L=N.toAffine(),w=r.toBytes(L.x),P=Le;return T?P(Uint8Array.from([N.hasEvenY()?2:3]),w):P(Uint8Array.from([4]),w,r.toBytes(L.y))},fromBytes(C){let N=C.length,T=C[0],L=C.subarray(1);if(N===i&&(T===2||T===3)){let w=Te(L);if(!o(w))throw new Error("Point is not on curve");let P=h(w),K=r.sqrt(P),V=(K&ie)===ie;return(T&1)===1!==V&&(K=r.neg(K)),{x:w,y:K}}else if(N===s&&T===4){let w=r.fromBytes(L.subarray(0,r.BYTES)),P=r.fromBytes(L.subarray(r.BYTES,2*r.BYTES));return{x:w,y:P}}else throw new Error(`Point of length ${N} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),g=C=>Ie(qe(C,e.nByteLength));function d(C){let N=n>>ie;return C>N}function p(C){return d(C)?a(-C):C}let y=(C,N,T)=>Te(C.slice(N,T));class x{constructor(N,T,L){this.r=N,this.s=T,this.recovery=L,this.assertValidity()}static fromCompact(N){let T=e.nByteLength;return N=yt("compactSignature",N,T*2),new x(y(N,0,T),y(N,T,2*T))}static fromDER(N){let{r:T,s:L}=wr.toSig(yt("DER",N));return new x(T,L)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(N){return new x(this.r,this.s,N)}recoverPublicKey(N){let{r:T,s:L,recovery:w}=this,P=R(yt("msgHash",N));if(w==null||![0,1,2,3].includes(w))throw new Error("recovery id invalid");let K=w===2||w===3?T+e.n:T;if(K>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let V=w&1?"03":"02",W=f.fromHex(V+g(K)),Y=c(K),et=a(-P*Y),X=a(L*Y),J=f.BASE.multiplyAndAddUnsafe(W,et,X);if(!J)throw new Error("point at infinify");return J.assertValidity(),J}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return ir(this.toDERHex())}toDERHex(){return wr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ir(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}let v={isValidPrivateKey(C){try{return u(C),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let C=Is(e.n);return Xa(e.randomBytes(C),e.n)},precompute(C=8,N=f.BASE){return N._setWindowSize(C),N.multiply(BigInt(3)),N}};function m(C,N=!0){return f.fromPrivateKey(C).toRawBytes(N)}function A(C){let N=C instanceof Uint8Array,T=typeof C=="string",L=(N||T)&&C.length;return N?L===i||L===s:T?L===2*i||L===2*s:C instanceof f}function S(C,N,T=!0){if(A(C))throw new Error("first arg must be private key");if(!A(N))throw new Error("second arg must be public key");return f.fromHex(N).multiply(u(C)).toRawBytes(T)}let B=e.bits2int||function(C){let N=Te(C),T=C.length*8-e.nBitLength;return T>0?N>>BigInt(T):N},R=e.bits2int_modN||function(C){return a(B(C))},_=an(e.nBitLength);function O(C){if(typeof C!="bigint")throw new Error("bigint expected");if(!(Oe<=C&&C<_))throw new Error(`bigint expected < 2^${e.nBitLength}`);return qe(C,e.nByteLength)}function M(C,N,T=U){if(["recovered","canonical"].some(ut=>ut in T))throw new Error("sign() legacy options not supported");let{hash:L,randomBytes:w}=e,{lowS:P,prehash:K,extraEntropy:V}=T;P==null&&(P=!0),C=yt("msgHash",C),K&&(C=yt("prehashed msgHash",L(C)));let W=R(C),Y=u(N),et=[O(Y),O(W)];if(V!=null){let ut=V===!0?w(r.BYTES):V;et.push(yt("extraEntropy",ut))}let X=Le(...et),J=W;function dt(ut){let Ut=B(ut);if(!l(Ut))return;let Kt=c(Ut),Ct=f.BASE.multiply(Ut).toAffine(),Vt=a(Ct.x);if(Vt===Oe)return;let Se=a(Kt*a(J+Vt*Y));if(Se===Oe)return;let tr=(Ct.x===Vt?0:2)|Number(Ct.y&ie),rn=Se;return P&&d(Se)&&(rn=p(Se),tr^=1),new x(Vt,rn,tr)}return{seed:X,k2sig:dt}}let U={lowS:e.lowS,prehash:!1},q={lowS:e.lowS,prehash:!1};function z(C,N,T=U){let{seed:L,k2sig:w}=M(C,N,T),P=e;return Es(P.hash.outputLen,P.nByteLength,P.hmac)(L,w)}f.BASE._setWindowSize(8);function Z(C,N,T,L=q){let w=C;if(N=yt("msgHash",N),T=yt("publicKey",T),"strict"in L)throw new Error("options.strict was renamed to lowS");let{lowS:P,prehash:K}=L,V,W;try{if(typeof w=="string"||w instanceof Uint8Array)try{V=x.fromDER(w)}catch(Ct){if(!(Ct instanceof wr.Err))throw Ct;V=x.fromCompact(w)}else if(typeof w=="object"&&typeof w.r=="bigint"&&typeof w.s=="bigint"){let{r:Ct,s:Vt}=w;V=new x(Ct,Vt)}else throw new Error("PARSE");W=f.fromHex(T)}catch(Ct){if(Ct.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(P&&V.hasHighS())return!1;K&&(N=e.hash(N));let{r:Y,s:et}=V,X=R(N),J=c(et),dt=a(X*J),ut=a(Y*J),Ut=f.BASE.multiplyAndAddUnsafe(W,dt,ut)?.toAffine();return Ut?a(Ut.x)===Y:!1}return{CURVE:e,getPublicKey:m,getSharedSecret:S,sign:z,verify:Z,ProjectivePoint:f,Signature:x,utils:v}}function u1(t){return{hash:t,hmac:(e,...r)=>Rr(t,e,ei(...r)),randomBytes:nr}}function Pf(t,e){let r=n=>kf({...t,...u1(n)});return Object.freeze({...r(e),create:r})}var Of=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Uf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h1=BigInt(1),Go=BigInt(2),Kf=(t,e)=>(t+e/Go)/e;function l1(t){let e=Of,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),f=t*t*t%e,u=f*f*t%e,h=gt(u,r,e)*u%e,l=gt(h,r,e)*u%e,g=gt(l,Go,e)*f%e,d=gt(g,i,e)*g%e,p=gt(d,s,e)*d%e,y=gt(p,a,e)*p%e,x=gt(y,c,e)*y%e,v=gt(x,a,e)*p%e,m=gt(v,r,e)*u%e,A=gt(m,o,e)*d%e,S=gt(A,n,e)*f%e,B=gt(S,Go,e);if(!$o.eql($o.sqr(B),t))throw new Error("Cannot find square root");return B}var $o=ci(Of,void 0,void 0,{sqrt:l1}),Me=Pf({a:BigInt(0),b:BigInt(7),Fp:$o,n:Uf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Uf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-h1*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Kf(s*t,e),c=Kf(-n*t,e),f=at(t-a*r-c*i,e),u=at(-a*n-c*s,e),h=f>o,l=u>o;if(h&&(f=e-f),l&&(u=e-u),f>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:f,k2neg:l,k2:u}}}},Nr),Cv=BigInt(0);var Iv=Me.ProjectivePoint;function Mf(){return Me.utils.randomPrivateKey()}async function Ff(t,e){let{digest:r}=await Ft.digest(e instanceof Uint8Array?e:e.subarray());try{return Me.sign(r,t).toDERRawBytes()}catch(n){throw new it(String(n),"ERR_INVALID_INPUT")}}async function Vf(t,e,r){try{let{digest:n}=await Ft.digest(r instanceof Uint8Array?r:r.subarray());return Me.verify(e,n,t)}catch(n){throw new it(String(n),"ERR_INVALID_INPUT")}}function Hf(t){return Me.ProjectivePoint.fromHex(t).toRawBytes(!0)}function qf(t){try{Me.getPublicKey(t,!0)}catch(e){throw new it(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Wo(t){try{Me.ProjectivePoint.fromHex(t)}catch(e){throw new it(String(e),"ERR_INVALID_PUBLIC_KEY")}}function zf(t){try{return Me.getPublicKey(t,!0)}catch(e){throw new it(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Dn=class{_key;constructor(e){Wo(e),this._key=e}async verify(e,r){return Vf(this._key,r,e)}marshal(){return Hf(this._key)}get bytes(){return we.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Lt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ft.digest(this.bytes);return e}},kn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??zf(e),qf(this._key),Wo(this._publicKey)}async sign(e){return Ff(this._key,e)}get public(){return new Dn(this._publicKey)}marshal(){return this._key}get bytes(){return Ee.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Lt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ft.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Et(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return $r(this.bytes,e);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function p1(t){return new kn(t)}function y1(t){return new Dn(t)}async function g1(){let t=Mf();return new kn(t)}var Er={rsa:zo,ed25519:Mo,secp256k1:Yo};function Gf(t){let e=Object.keys(Er).join(" / ");return new it(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function $f(t){let e=we.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case wt.RSA:return Er.rsa.unmarshalRsaPublicKey(r);case wt.Ed25519:return Er.ed25519.unmarshalEd25519PublicKey(r);case wt.Secp256k1:return Er.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Gf(e.Type??"unknown")}}async function Wf(t){let e=Ee.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case wt.RSA:return Er.rsa.unmarshalRsaPrivateKey(r);case wt.Ed25519:return Er.ed25519.unmarshalEd25519PrivateKey(r);case wt.Secp256k1:return Er.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Gf(e.Type??"RSA")}}var Yf=Symbol.for("@libp2p/peer-id");var m1=Symbol.for("nodejs.util.inspect.custom"),Zf=Object.values(zr).map(t=>t.decoder).reduce((t,e)=>t.or(e),zr.identity.decoder),Xf=114,Zo=36,Xo=37,Pn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Yf]=!0;toString(){return this.string==null&&(this.string=Mt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return lr.createV1(Xf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Lt(this.multihash.bytes,e);if(typeof e=="string")return b1(e).equals(this);if(e?.multihash?.bytes!=null)return Lt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[m1](){return`PeerId(${this.toString()})`}},Xr=class extends Pn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Qr=class extends Pn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Jr=class extends Pn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function b1(t,e){if(e=e??Zf,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Sn(Mt.decode(`z${t}`));return t.startsWith("12D")?new Qr({multihash:r}):t.startsWith("16U")?new Jr({multihash:r}):new Xr({multihash:r})}return v1(Zf.decode(t))}function v1(t){try{let e=Sn(t);if(e.code===Je.code){if(e.digest.length===Zo)return new Qr({multihash:e});if(e.digest.length===Xo)return new Jr({multihash:e})}if(e.code===Ft.code)return new Xr({multihash:e})}catch{return w1(lr.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function w1(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==Xf)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Ft.code)return new Xr({multihash:t.multihash});if(e.code===Je.code){if(e.digest.length===Zo)return new Qr({multihash:t.multihash});if(e.digest.length===Xo)return new Jr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Qo(t,e){return t.length===Zo?new Qr({multihash:ve(Je.code,t),privateKey:e}):t.length===Xo?new Jr({multihash:ve(Je.code,t),privateKey:e}):new Xr({multihash:await Ft.digest(t),publicKey:t,privateKey:e})}var Fi;(function(t){let e;t.codec=()=>(e==null&&(e=xr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let s of r.webtransportCerthashes)n.uint32(10),n.bytes(s);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:{i.webtransportCerthashes.push(r.bytes());break}default:{r.skipType(o&7);break}}}return i})),e),t.encode=r=>gr(r,t.codec()),t.decode=r=>pr(r,t.codec())})(Fi||(Fi={}));var Un;(function(t){let e;t.codec=()=>(e==null&&(e=xr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.identityKey!=null&&r.identityKey.byteLength>0&&(n.uint32(10),n.bytes(r.identityKey)),r.identitySig!=null&&r.identitySig.byteLength>0&&(n.uint32(18),n.bytes(r.identitySig)),r.extensions!=null&&(n.uint32(34),Fi.codec().encode(r.extensions,n)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:rt(0),identitySig:rt(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:{i.identityKey=r.bytes();break}case 2:{i.identitySig=r.bytes();break}case 4:{i.extensions=Fi.codec().decode(r,r.uint32());break}default:{r.skipType(o&7);break}}}return i})),e),t.encode=r=>gr(r,t.codec()),t.decode=r=>pr(r,t.codec())})(Un||(Un={}));async function Qf(t,e,r){let n=await S1(t,Jf(e));if(t.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return E1(t.publicKey,n,r)}function E1(t,e,r){return Un.encode({identityKey:t,identitySig:e,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function S1(t,e){if(t.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await Wf(t.privateKey)).sign(e)}async function Jo(t){return Qo(t.identityKey)}function jo(t){return Un.decode(t)}function Jf(t){let e=At("noise-libp2p-static-key:");return Gt([e,t],e.length+t.length)}async function ta(t,e,r){let n=await Qo(e.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=Jf(t);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(e.identitySig==null)throw new Error("Signature was missing from message");if(!await $f(n.publicKey).verify(i,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function Kn(t){return!(!(t instanceof Uint8Array)||t.length!==32)}var te=zt(nu(),1);te.default.formatters.b=t=>t==null?"undefined":Mt.baseEncode(t);te.default.formatters.t=t=>t==null?"undefined":Qe.baseEncode(t);te.default.formatters.m=t=>t==null?"undefined":Mr.baseEncode(t);te.default.formatters.p=t=>t==null?"undefined":t.toString();te.default.formatters.c=t=>t==null?"undefined":t.toString();te.default.formatters.k=t=>t==null?"undefined":t.toString();te.default.formatters.a=t=>t==null?"undefined":t.toString();function U1(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function iu(t){let e=U1(`${t}:trace`);return te.default.enabled(`${t}:trace`)&&te.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,te.default)(`${t}:trace`)),Object.assign((0,te.default)(t),{error:(0,te.default)(`${t}:error`),trace:e})}var Pt=iu("libp2p:noise");var se;Ia?se=Pt:se=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function su(t){se(`LOCAL_STATIC_PUBLIC_KEY ${Et(t.publicKey,"hex")}`),se(`LOCAL_STATIC_PRIVATE_KEY ${Et(t.privateKey,"hex")}`)}function ea(t){t?(se(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Et(t.publicKey,"hex")}`),se(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Et(t.privateKey,"hex")}`)):se("Missing local ephemeral keys.")}function ou(t){se(`REMOTE_STATIC_PUBLIC_KEY ${Et(t,"hex")}`)}function ra(t){se(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Et(t,"hex")}`)}function au(t){t.cs1&&t.cs2?(se(`CIPHER_STATE_1 ${t.cs1.n.getUint64()} ${Et(t.cs1.k,"hex")}`),se(`CIPHER_STATE_2 ${t.cs2.n.getUint64()} ${Et(t.cs2.k,"hex")}`)):se("Missing cipher state.")}var K1=0,O1=4294967295,M1="Cipherstate has reached maximum n, a new handshake must be performed",qi=class{n;bytes;view;constructor(e=K1){this.n=e,this.bytes=rt(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>O1)throw new Error(M1)}};var zi=class{crypto;constructor(e){this.crypto=e}encryptWithAd(e,r,n){let i=this.encrypt(e.k,e.n,r,n);return e.n.increment(),i}decryptWithAd(e,r,n,i){let{plaintext:s,valid:o}=this.decrypt(e.k,e.n,r,n,i);return o&&e.n.increment(),{plaintext:s,valid:o}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return rt(32)}isEmptyKey(e){let r=this.createEmptyKey();return Lt(r,e)}encrypt(e,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,e)}encryptAndHash(e,r){let n;return this.hasKey(e.cs)?n=this.encryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,n),n}decrypt(e,r,n,i,s){r.assertValue();let o=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,e,s);return o?{plaintext:o,valid:!0}:{plaintext:rt(0),valid:!1}}decryptAndHash(e,r){let n,i=!0;return this.hasKey(e.cs)?{plaintext:n,valid:i}=this.decryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,r),{plaintext:n,valid:i}}dh(e,r){try{let n=this.crypto.generateX25519SharedKey(e,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return Pt.error(i),rt(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){return this.crypto.hashSHA256(Gt([e,r],e.length+r.length))}mixKey(e,r){let[n,i]=this.crypto.getHKDF(e.ck,r);e.cs=this.initializeKey(i),e.ck=n}initializeKey(e){return{k:e,n:new qi}}initializeSymmetric(e){let r=At(e,"utf-8"),n=this.hashProtocolName(r),i=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:i,h:n}}hashProtocolName(e){if(e.length<=32){let r=rt(32);return r.set(e),r}else return this.getHash(e,rt(0))}split(e){let[r,n]=this.crypto.getHKDF(e.ck,rt(0)),i=this.initializeKey(r),s=this.initializeKey(n);return{cs1:i,cs2:s}}writeMessageRegular(e,r){let n=this.encryptWithAd(e,rt(0),r),i=this.createEmptyKey(),s=rt(0);return{ne:i,ns:s,ciphertext:n}}readMessageRegular(e,r){return this.decryptWithAd(e,rt(0),r.ciphertext)}};var Gi=class extends zi{initializeInitiator(e,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=rt(32);return{ss:o,s:r,rs:n,psk:i,re:a}}initializeResponder(e,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=rt(32);return{ss:o,s:r,rs:n,psk:i,re:a}}writeMessageA(e,r,n){let i=rt(0);n!==void 0?e.e=n:e.e=this.crypto.generateX25519KeyPair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,r);return{ne:s,ns:i,ciphertext:o}}writeMessageB(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let i=e.s.publicKey,s=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r);return{ne:n,ns:s,ciphertext:o}}writeMessageC(e,r){let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:s},{cs1:c,cs2:f}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:f}}readMessageA(e,r){return Kn(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(Kn(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&Kn(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:i&&o}}readMessageC(e,r){let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);if(i&&Kn(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:i&&o,cs1:a,cs2:c}}initSession(e,r,n){let i=this.createEmptyKey(),s=rt(32),o;return e?o=this.initializeInitiator(r,n,s,i):o=this.initializeResponder(r,n,s,i),{hs:o,i:e,mc:0}}sendMessage(e,r,n){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r,n);else if(e.mc===1)i=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);i=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let n=rt(0),i=!1;if(e.mc===0)({plaintext:n,valid:i}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:n,valid:i}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:f}=this.readMessageC(e.hs,r);n=o,i=a,e.h=s,e.cs1=c,e.cs2=f}return e.mc++,{plaintext:n,valid:i}}};var $i=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(e,r,n,i,s,o,a,c){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=s,this.connection=o,a&&(this.remotePeer=a),this.xx=c??new Gi(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(su(this.session.hs.s),this.isInitiator){Pt.trace("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,rt(0));await this.connection.write(c0(e)),Pt.trace("Stage 0 - Initiator finished sending first message."),ea(this.session.hs.e)}else{Pt.trace("Stage 0 - Responder waiting to receive first message...");let e=h0((await this.connection.read()).subarray()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new or("xx handshake stage 0 validation fail");Pt.trace("Stage 0 - Responder received first message."),ra(this.session.hs.re)}}async exchange(){if(this.isInitiator){Pt.trace("Stage 1 - Initiator waiting to receive first message from responder...");let e=l0((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new or("xx handshake stage 1 validation fail");Pt.trace("Stage 1 - Initiator received the message."),ra(this.session.hs.re),ou(this.session.hs.rs),Pt.trace("Initiator going to check remote's signature...");try{let i=jo(r);this.remotePeer=this.remotePeer||await Jo(i),await ta(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new pn(`Error occurred while verifying signed payload: ${s.message}`)}Pt.trace("All good with the signature!")}else{Pt.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(f0(e)),Pt.trace("Stage 1 - Responder sent the second handshake message with signed payload."),ea(this.session.hs.e)}}async finish(){if(this.isInitiator){Pt.trace("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(u0(e)),Pt.trace("Stage 2 - Initiator sent message with signed payload.")}else{Pt.trace("Stage 2 - Responder waiting for third handshake message...");let e=d0((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new or("xx handshake stage 2 validation fail");Pt.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=jo(r);this.remotePeer=this.remotePeer||await Jo(i),await ta(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new pn(`Error occurred while verifying signed payload: ${s.message}`)}}au(this.session)}encrypt(e,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,rt(0),e)}decrypt(e,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,rt(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new or("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}};function cu(t){return{xxHandshakeSuccesses:t.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:t.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:t.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:t.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:t.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var Wi=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(e={}){let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:s,metrics:o}=e;this.crypto=i??a0,this.extensions=n,this.metrics=o?cu(o):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=s??rt(0)}async secureOutbound(e,r,n){let i=ns(r,{lengthEncoder:Dr,lengthDecoder:ln,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!0,localPeer:e,remotePeer:n}),o=await this.createSecureConnection(i,s);return r.source=o.source,r.sink=o.sink,{conn:r,remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(e,r,n){let i=ns(r,{lengthEncoder:Dr,lengthDecoder:ln,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!1,localPeer:e,remotePeer:n}),o=await this.createSecureConnection(i,s);return r.source=o.source,r.sink=o.sink,{conn:r,remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(e){let r=await Qf(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,r)}async performXXHandshake(e,r){let{isInitiator:n,remotePeer:i,connection:s}=e,o=new $i(n,r,this.prologue,this.crypto,this.staticKeys,s,i);try{await o.propose(),await o.exchange(),await o.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return o}async createSecureConnection(e,r){let[n,i]=Ea(),s=e.unwrap();return await Ba(n,g0(r,this.metrics),s,o=>sn(o,{lengthDecoder:ln}),x0(r,this.metrics),n),i}};function F1(t={}){return()=>new Wi(t)}return Eu(V1);})();
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
