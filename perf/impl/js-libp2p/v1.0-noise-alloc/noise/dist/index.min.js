(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var su=Object.create;var Nn=Object.defineProperty;var ou=Object.getOwnPropertyDescriptor;var au=Object.getOwnPropertyNames;var cu=Object.getPrototypeOf,fu=Object.prototype.hasOwnProperty;var pt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Lt=(e,t)=>{for(var r in t)Nn(e,r,{get:t[r],enumerable:!0})},ia=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of au(t))!fu.call(e,i)&&i!==r&&Nn(e,i,{get:()=>t[i],enumerable:!(n=ou(t,i))||n.enumerable});return e};var Gt=(e,t,r)=>(r=e!=null?su(cu(e)):{},ia(t||!e||!e.__esModule?Nn(r,"default",{value:e,enumerable:!0}):r,e)),uu=e=>ia(Nn({},"__esModule",{value:!0}),e);var ua=pt((k1,fa)=>{"use strict";function ca(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function mu(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return ca(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),ca(new i,r)}}fa.exports=mu});var ht=pt((Fg,u0)=>{u0.exports={options:{usePureJavaScript:!1}}});var p0=pt((Hg,l0)=>{var Cs={};l0.exports=Cs;var h0={};Cs.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=Yh(e,t);else{var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,f=e[i];c<a.length;++c)f+=a[c]<<8,a[c]=f%s,f=f/s|0;for(;f>0;)a.push(f%s),f=f/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Cs.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=h0[t];if(!r){r=h0[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),o=[0],n=0;n<e.length;n++){var a=r[e.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<o.length;++c)f+=o[c]*i,o[c]=f&255,f>>=8;for(;f>0;)o.push(f&255),f>>=8}for(var u=0;e[u]===s&&u<e.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function Yh(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}});var Ct=pt((qg,g0)=>{var d0=ht(),y0=p0(),b=g0.exports=d0.util=d0.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){b.nextTick=process.nextTick,typeof setImmediate=="function"?b.setImmediate=setImmediate:b.setImmediate=b.nextTick;return}if(typeof setImmediate=="function"){b.setImmediate=function(){return setImmediate.apply(void 0,arguments)},b.nextTick=function(a){return setImmediate(a)};return}if(b.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===e){c.stopPropagation();var f=t.slice();t.length=0,f.forEach(function(u){u()})}};var o=a,e="forge.setImmediate",t=[];b.setImmediate=function(c){t.push(c),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var c=t.slice();t.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var s=b.setImmediate;b.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(t.push(c),t.length===1&&i.setAttribute("a",n=!n))}}b.nextTick=b.setImmediate})();b.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;b.globalScope=function(){return b.isNodejs?globalThis:typeof self>"u"?window:self}();b.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};b.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};b.isArrayBufferView=function(e){return e&&b.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function fn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}b.ByteBuffer=Is;function Is(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(b.isArrayBuffer(e)||b.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Is||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}b.ByteStringBuffer=Is;var Wh=4096;b.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>Wh&&(this.data.substr(0,1),this._constructedStringLength=0)};b.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};b.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};b.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};b.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};b.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};b.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(b.encodeUtf8(e))};b.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};b.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};b.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};b.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};b.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};b.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};b.ByteStringBuffer.prototype.putInt=function(e,t){fn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};b.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};b.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};b.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};b.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};b.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};b.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};b.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};b.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};b.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};b.ByteStringBuffer.prototype.getInt=function(e){fn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};b.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};b.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};b.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};b.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};b.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};b.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};b.ByteStringBuffer.prototype.copy=function(){var e=b.createBuffer(this.data);return e.read=this.read,e};b.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};b.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};b.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};b.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};b.ByteStringBuffer.prototype.toString=function(){return b.decodeUtf8(this.bytes())};function $h(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=b.isArrayBuffer(e),n=b.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}b.DataBuffer=$h;b.DataBuffer.prototype.length=function(){return this.write-this.read};b.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};b.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};b.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};b.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};b.DataBuffer.prototype.putBytes=function(e,t){if(b.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(b.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof b.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&b.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof b.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=b.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=b.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};b.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};b.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};b.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};b.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};b.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};b.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};b.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};b.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};b.DataBuffer.prototype.putInt=function(e,t){fn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};b.DataBuffer.prototype.putSignedInt=function(e,t){return fn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};b.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};b.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};b.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};b.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};b.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};b.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};b.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};b.DataBuffer.prototype.getInt=function(e){fn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};b.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};b.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};b.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};b.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};b.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};b.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};b.DataBuffer.prototype.copy=function(){return new b.DataBuffer(this)};b.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};b.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};b.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};b.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};b.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return b.binary.raw.encode(t);if(e==="hex")return b.binary.hex.encode(t);if(e==="base64")return b.binary.base64.encode(t);if(e==="utf8")return b.text.utf8.decode(t);if(e==="utf16")return b.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};b.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=b.encodeUtf8(e)),new b.ByteBuffer(e)};b.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};b.xorBytes=function(e,t,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};b.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};b.bytesToHex=function(e){return b.createBuffer(e).toHex()};b.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ze=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],x0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";b.encode64=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.length;)i=e.charCodeAt(a++),s=e.charCodeAt(a++),o=e.charCodeAt(a++),r+=qe.charAt(i>>2),r+=qe.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=qe.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":qe.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};b.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,o=0;o<e.length;)r=ze[e.charCodeAt(o++)-43],n=ze[e.charCodeAt(o++)-43],i=ze[e.charCodeAt(o++)-43],s=ze[e.charCodeAt(o++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};b.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};b.decodeUtf8=function(e){return decodeURIComponent(escape(e))};b.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:y0.encode,decode:y0.decode}};b.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};b.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};b.binary.hex.encode=b.bytesToHex;b.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};b.binary.base64.encode=function(e,t){for(var r="",n="",i,s,o,a=0;a<e.byteLength;)i=e[a++],s=e[a++],o=e[a++],r+=qe.charAt(i>>2),r+=qe.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=qe.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":qe.charAt(o&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};b.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,f=r;c<e.length;)i=ze[e.charCodeAt(c++)-43],s=ze[e.charCodeAt(c++)-43],o=ze[e.charCodeAt(c++)-43],a=ze[e.charCodeAt(c++)-43],n[f++]=i<<2|s>>4,o!==64&&(n[f++]=(s&15)<<4|o>>2,a!==64&&(n[f++]=(o&3)<<6|a));return t?f-r:n.subarray(0,f)};b.binary.base58.encode=function(e,t){return b.binary.baseN.encode(e,x0,t)};b.binary.base58.decode=function(e,t){return b.binary.baseN.decode(e,x0,t)};b.text={utf8:{},utf16:{}};b.text.utf8.encode=function(e,t,r){e=b.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};b.text.utf8.decode=function(e){return b.decodeUtf8(String.fromCharCode.apply(null,e))};b.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a),s+=2;return t?s-r:n};b.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};b.deflate=function(e,t,r){if(t=b.decode64(e.deflate(b.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};b.inflate=function(e,t,r){var n=e.inflate(b.encode64(t)).rval;return n===null?null:b.decode64(n)};var Ts=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=b.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},_s=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(b.decode64(r))),r},Zh=function(e,t,r,n){var i=_s(e,t);i===null&&(i={}),i[r]=n,Ts(e,t,i)},Xh=function(e,t,r){var n=_s(e,t);return n!==null&&(n=r in n?n[r]:null),n},Qh=function(e,t,r){var n=_s(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Ts(e,t,n)}},Jh=function(e,t){Ts(e,t,null)},ai=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};b.setItem=function(e,t,r,n,i){ai(Zh,arguments,i)};b.getItem=function(e,t,r,n){return ai(Xh,arguments,n)};b.removeItem=function(e,t,r,n){ai(Qh,arguments,n)};b.clearItems=function(e,t,r){ai(Jh,arguments,r)};b.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};b.format=function(e){for(var t=/%./g,r,n,i=0,s=[],o=0;r=t.exec(e);){n=e.substring(o,t.lastIndex-2),n.length>0&&s.push(n),o=t.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(e.substring(o)),s.join("")};b.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-f).toFixed(s).slice(2):"")};b.formatSize=function(e){return e>=1073741824?e=b.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=b.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=b.formatNumber(e/1024,0)+" KiB":e=b.formatNumber(e,0)+" bytes",e};b.bytesFromIP=function(e){return e.indexOf(".")!==-1?b.bytesFromIPv4(e):e.indexOf(":")!==-1?b.bytesFromIPv6(e):null};b.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=b.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};b.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(o){return o.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=b.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=b.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};b.bytesToIP=function(e){return e.length===4?b.bytesToIPv4(e):e.length===16?b.bytesToIPv6(e):null};b.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};b.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=b.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=t.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),c.start===0&&t.unshift(""),c.end===7&&t.push(""))}return t.join(":")};b.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in b&&!e.update)return t(null,b.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return b.cores=navigator.hardwareConcurrency,t(null,b.cores);if(typeof Worker>"u")return b.cores=1,t(null,b.cores);if(typeof Blob>"u")return b.cores=2,t(null,b.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var f=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return b.cores=Math.max(1,f),URL.revokeObjectURL(r),t(null,b.cores)}i(c,function(u,h){o.push(s(c,h)),n(o,a-1,c)})}function i(o,a){for(var c=[],f=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===o){for(var x=0;x<o;++x)c[x].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<o;++u)c[u].postMessage(u)}function s(o,a){for(var c=[],f=0;f<o;++f)for(var u=a[f],h=c[f]=[],l=0;l<o;++l)if(f!==l){var x=a[l];(u.st>x.st&&u.st<x.et||x.st>u.st&&x.st<u.et)&&h.push(l)}return c.reduce(function(p,d){return Math.max(p,d.length)},0)}}});var ci=pt((zg,m0)=>{var un=ht();un.pki=un.pki||{};var Ls=m0.exports=un.pki.oids=un.oids=un.oids||{};function P(e,t){Ls[e]=t,Ls[t]=e}function ft(e,t){Ls[e]=t}P("1.2.840.113549.1.1.1","rsaEncryption");P("1.2.840.113549.1.1.4","md5WithRSAEncryption");P("1.2.840.113549.1.1.5","sha1WithRSAEncryption");P("1.2.840.113549.1.1.7","RSAES-OAEP");P("1.2.840.113549.1.1.8","mgf1");P("1.2.840.113549.1.1.9","pSpecified");P("1.2.840.113549.1.1.10","RSASSA-PSS");P("1.2.840.113549.1.1.11","sha256WithRSAEncryption");P("1.2.840.113549.1.1.12","sha384WithRSAEncryption");P("1.2.840.113549.1.1.13","sha512WithRSAEncryption");P("1.3.101.112","EdDSA25519");P("1.2.840.10040.4.3","dsa-with-sha1");P("1.3.14.3.2.7","desCBC");P("1.3.14.3.2.26","sha1");P("1.3.14.3.2.29","sha1WithRSASignature");P("2.16.840.1.101.3.4.2.1","sha256");P("2.16.840.1.101.3.4.2.2","sha384");P("2.16.840.1.101.3.4.2.3","sha512");P("2.16.840.1.101.3.4.2.4","sha224");P("2.16.840.1.101.3.4.2.5","sha512-224");P("2.16.840.1.101.3.4.2.6","sha512-256");P("1.2.840.113549.2.2","md2");P("1.2.840.113549.2.5","md5");P("1.2.840.113549.1.7.1","data");P("1.2.840.113549.1.7.2","signedData");P("1.2.840.113549.1.7.3","envelopedData");P("1.2.840.113549.1.7.4","signedAndEnvelopedData");P("1.2.840.113549.1.7.5","digestedData");P("1.2.840.113549.1.7.6","encryptedData");P("1.2.840.113549.1.9.1","emailAddress");P("1.2.840.113549.1.9.2","unstructuredName");P("1.2.840.113549.1.9.3","contentType");P("1.2.840.113549.1.9.4","messageDigest");P("1.2.840.113549.1.9.5","signingTime");P("1.2.840.113549.1.9.6","counterSignature");P("1.2.840.113549.1.9.7","challengePassword");P("1.2.840.113549.1.9.8","unstructuredAddress");P("1.2.840.113549.1.9.14","extensionRequest");P("1.2.840.113549.1.9.20","friendlyName");P("1.2.840.113549.1.9.21","localKeyId");P("1.2.840.113549.1.9.22.1","x509Certificate");P("1.2.840.113549.1.12.10.1.1","keyBag");P("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");P("1.2.840.113549.1.12.10.1.3","certBag");P("1.2.840.113549.1.12.10.1.4","crlBag");P("1.2.840.113549.1.12.10.1.5","secretBag");P("1.2.840.113549.1.12.10.1.6","safeContentsBag");P("1.2.840.113549.1.5.13","pkcs5PBES2");P("1.2.840.113549.1.5.12","pkcs5PBKDF2");P("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");P("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");P("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");P("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");P("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");P("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");P("1.2.840.113549.2.7","hmacWithSHA1");P("1.2.840.113549.2.8","hmacWithSHA224");P("1.2.840.113549.2.9","hmacWithSHA256");P("1.2.840.113549.2.10","hmacWithSHA384");P("1.2.840.113549.2.11","hmacWithSHA512");P("1.2.840.113549.3.7","des-EDE3-CBC");P("2.16.840.1.101.3.4.1.2","aes128-CBC");P("2.16.840.1.101.3.4.1.22","aes192-CBC");P("2.16.840.1.101.3.4.1.42","aes256-CBC");P("2.5.4.3","commonName");P("2.5.4.4","surname");P("2.5.4.5","serialNumber");P("2.5.4.6","countryName");P("2.5.4.7","localityName");P("2.5.4.8","stateOrProvinceName");P("2.5.4.9","streetAddress");P("2.5.4.10","organizationName");P("2.5.4.11","organizationalUnitName");P("2.5.4.12","title");P("2.5.4.13","description");P("2.5.4.15","businessCategory");P("2.5.4.17","postalCode");P("2.5.4.42","givenName");P("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");P("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");P("2.16.840.1.113730.1.1","nsCertType");P("2.16.840.1.113730.1.13","nsComment");ft("2.5.29.1","authorityKeyIdentifier");ft("2.5.29.2","keyAttributes");ft("2.5.29.3","certificatePolicies");ft("2.5.29.4","keyUsageRestriction");ft("2.5.29.5","policyMapping");ft("2.5.29.6","subtreesConstraint");ft("2.5.29.7","subjectAltName");ft("2.5.29.8","issuerAltName");ft("2.5.29.9","subjectDirectoryAttributes");ft("2.5.29.10","basicConstraints");ft("2.5.29.11","nameConstraints");ft("2.5.29.12","policyConstraints");ft("2.5.29.13","basicConstraints");P("2.5.29.14","subjectKeyIdentifier");P("2.5.29.15","keyUsage");ft("2.5.29.16","privateKeyUsagePeriod");P("2.5.29.17","subjectAltName");P("2.5.29.18","issuerAltName");P("2.5.29.19","basicConstraints");ft("2.5.29.20","cRLNumber");ft("2.5.29.21","cRLReason");ft("2.5.29.22","expirationDate");ft("2.5.29.23","instructionCode");ft("2.5.29.24","invalidityDate");ft("2.5.29.25","cRLDistributionPoints");ft("2.5.29.26","issuingDistributionPoint");ft("2.5.29.27","deltaCRLIndicator");ft("2.5.29.28","issuingDistributionPoint");ft("2.5.29.29","certificateIssuer");ft("2.5.29.30","nameConstraints");P("2.5.29.31","cRLDistributionPoints");P("2.5.29.32","certificatePolicies");ft("2.5.29.33","policyMappings");ft("2.5.29.34","policyConstraints");P("2.5.29.35","authorityKeyIdentifier");ft("2.5.29.36","policyConstraints");P("2.5.29.37","extKeyUsage");ft("2.5.29.46","freshestCRL");ft("2.5.29.54","inhibitAnyPolicy");P("1.3.6.1.4.1.11129.2.4.2","timestampList");P("1.3.6.1.5.5.7.1.1","authorityInfoAccess");P("1.3.6.1.5.5.7.3.1","serverAuth");P("1.3.6.1.5.5.7.3.2","clientAuth");P("1.3.6.1.5.5.7.3.3","codeSigning");P("1.3.6.1.5.5.7.3.4","emailProtection");P("1.3.6.1.5.5.7.3.8","timeStamping")});var ln=pt((Gg,v0)=>{var gt=ht();Ct();ci();var V=v0.exports=gt.asn1=gt.asn1||{};V.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};V.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};V.create=function(e,t,r,n,i){if(gt.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:e,type:t,constructed:r,composed:r||gt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=V.copy(a)),a};V.copy=function(e,t){var r;if(gt.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(V.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:V.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};V.equals=function(e,t,r){if(gt.util.isArray(e)){if(!gt.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!V.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&V.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};V.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function hn(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var jh=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;hn(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};V.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=gt.util.createBuffer(e));var r=e.length(),n=fi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function fi(e,t,r,n){var i;hn(e,t,2);var s=e.getByte();t--;var o=s&192,a=s&31;i=e.length();var c=jh(e,t);if(t-=i-e.length(),c!==void 0&&c>t){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=e.length(),f.remaining=t,f.requested=c,f}c=t}var u,h,l=(s&32)===32;if(l)if(u=[],c===void 0)for(;;){if(hn(e,t,2),e.bytes(2)==="\0\0"){e.getBytes(2),t-=2;break}i=e.length(),u.push(fi(e,t,r+1,n)),t-=i-e.length()}else for(;c>0;)i=e.length(),u.push(fi(e,c,r+1,n)),t-=i-e.length(),c-=i-e.length();if(u===void 0&&o===V.Class.UNIVERSAL&&a===V.Type.BITSTRING&&(h=e.bytes(c)),u===void 0&&n.decodeBitStrings&&o===V.Class.UNIVERSAL&&a===V.Type.BITSTRING&&c>1){var x=e.read,p=t,d=0;if(a===V.Type.BITSTRING&&(hn(e,t,1),d=e.getByte(),t--),d===0)try{i=e.length();var y={strict:!0,decodeBitStrings:!0},g=fi(e,t,r+1,y),v=i-e.length();t-=v,a==V.Type.BITSTRING&&v++;var m=g.tagClass;v===c&&(m===V.Class.UNIVERSAL||m===V.Class.CONTEXT_SPECIFIC)&&(u=[g])}catch{}u===void 0&&(e.read=x,t=p)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=t}if(a===V.Type.BMPSTRING)for(u="";c>0;c-=2)hn(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(c),t-=c}var C=h===void 0?null:{bitStringContents:h};return V.create(o,a,l,u,C)}V.toDer=function(e){var t=gt.util.createBuffer(),r=e.tagClass|e.type,n=gt.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=V.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(V.toDer(e.value[s]))}else if(e.type===V.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===V.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);t.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)t.putByte(a.charCodeAt(s))}return t.putBuffer(n),t};V.oidToDer=function(e){var t=e.split("."),r=gt.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,o,a=2;a<t.length;++a){n=!0,i=[],s=parseInt(t[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};V.derToOid=function(e){var t;typeof e=="string"&&(e=gt.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};V.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(e.substr(10,2),10),f+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),f&&(c=e.charAt(f),c==="+"||c==="-")){var u=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};V.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,f=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var x=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);f=x*60+p,f*=6e4,l==="+"&&(f*=-1),u=!0}return e.charAt(14)==="."&&(c=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,c),t.setTime(+t+f)):(t.setFullYear(r,n,i),t.setHours(s,o,a,c)),t};V.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};V.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};V.integerToDer=function(e){var t=gt.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};V.derToInteger=function(e){typeof e=="string"&&(e=gt.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};V.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&gt.util.isArray(t.value))for(var s=0,o=0;i&&o<t.value.length;++o)i=t.value[o].optional||!1,e.value[s]&&(i=V.validate(e.value[s],t.value[o],r,n),i?++s:t.value[o].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var a;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var c=e.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var b0=/[^\\u0000-\\u00ff]/;V.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case V.Class.UNIVERSAL:n+="Universal:";break;case V.Class.APPLICATION:n+="Application:";break;case V.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case V.Class.PRIVATE:n+="Private:";break}if(e.tagClass===V.Class.UNIVERSAL)switch(n+=e.type,e.type){case V.Type.NONE:n+=" (None)";break;case V.Type.BOOLEAN:n+=" (Boolean)";break;case V.Type.INTEGER:n+=" (Integer)";break;case V.Type.BITSTRING:n+=" (Bit string)";break;case V.Type.OCTETSTRING:n+=" (Octet string)";break;case V.Type.NULL:n+=" (Null)";break;case V.Type.OID:n+=" (Object Identifier)";break;case V.Type.ODESC:n+=" (Object Descriptor)";break;case V.Type.EXTERNAL:n+=" (External or Instance of)";break;case V.Type.REAL:n+=" (Real)";break;case V.Type.ENUMERATED:n+=" (Enumerated)";break;case V.Type.EMBEDDED:n+=" (Embedded PDV)";break;case V.Type.UTF8:n+=" (UTF8)";break;case V.Type.ROID:n+=" (Relative Object Identifier)";break;case V.Type.SEQUENCE:n+=" (Sequence)";break;case V.Type.SET:n+=" (Set)";break;case V.Type.PRINTABLESTRING:n+=" (Printable String)";break;case V.Type.IA5String:n+=" (IA5String (ASCII))";break;case V.Type.UTCTIME:n+=" (UTC time)";break;case V.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case V.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var o=0,a="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(o+=1,a+=V.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",e.type===V.Type.OID){var c=V.derToOid(e.value);n+=c,gt.pki&&gt.pki.oids&&c in gt.pki.oids&&(n+=" ("+gt.pki.oids[c]+") ")}if(e.type===V.Type.INTEGER)try{n+=V.derToInteger(e.value)}catch{n+="0x"+gt.util.bytesToHex(e.value)}else if(e.type===V.Type.BITSTRING){if(e.value.length>1?n+="0x"+gt.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(e.type===V.Type.OCTETSTRING)b0.test(e.value)||(n+="("+e.value+") "),n+="0x"+gt.util.bytesToHex(e.value);else if(e.type===V.Type.UTF8)try{n+=gt.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")n+="0x"+gt.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===V.Type.PRINTABLESTRING||e.type===V.Type.IA5String?n+=e.value:b0.test(e.value)?n+="0x"+gt.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var Ns=pt((Yg,w0)=>{var Nt=ht();Ct();w0.exports=Nt.cipher=Nt.cipher||{};Nt.cipher.algorithms=Nt.cipher.algorithms||{};Nt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Nt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Nt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Nt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Nt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Nt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Nt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Nt.cipher.algorithms[e]=t};Nt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Nt.cipher.algorithms?Nt.cipher.algorithms[e]:null};var Rs=Nt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Rs.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Nt.util.createBuffer(),this.output=e.output||Nt.util.createBuffer(),this.mode.start(t)};Rs.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Rs.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var Ps=pt((Wg,E0)=>{var Dt=ht();Ct();Dt.cipher=Dt.cipher||{};var nt=E0.exports=Dt.cipher.modes=Dt.cipher.modes||{};nt.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};nt.ecb.prototype.start=function(e){};nt.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};nt.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};nt.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};nt.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};nt.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};nt.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=ui(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};nt.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};nt.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};nt.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};nt.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};nt.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};nt.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ui(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};nt.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ui(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.ofb.prototype.decrypt=nt.ofb.prototype.encrypt;nt.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};nt.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ui(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}hi(this._inBlock)};nt.ctr.prototype.decrypt=nt.ctr.prototype.encrypt;nt.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};nt.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Dt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Dt.util.createBuffer(e.additionalData):r=Dt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Dt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ds(n*8)))}this._inBlock=this._j0.slice(0),hi(this._inBlock),this._partialBytes=0,r=Dt.util.createBuffer(r),this._aDataLength=Ds(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};nt.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),hi(this._inBlock)};nt.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),hi(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};nt.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Dt.util.createBuffer();var n=this._aDataLength.concat(Ds(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};nt.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};nt.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};nt.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};nt.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};nt.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,f=(n-1-o%n)*t;a[c]=1<<t-1<<f,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s};nt.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var f=i[s^n];i[s]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return i};function ui(e,t){if(typeof e=="string"&&(e=Dt.util.createBuffer(e)),Dt.util.isArray(e)&&e.length>4){var r=e;e=Dt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Dt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function hi(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Ds(e){return[e/4294967296|0,e&4294967295]}});var Os=pt(($g,C0)=>{var dt=ht();Ns();Ps();Ct();C0.exports=dt.aes=dt.aes||{};dt.aes.startEncrypting=function(e,t,r,n){var i=li({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};dt.aes.createEncryptionCipher=function(e,t){return li({key:e,output:null,decrypt:!1,mode:t})};dt.aes.startDecrypting=function(e,t,r,n){var i=li({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};dt.aes.createDecryptionCipher=function(e,t){return li({key:e,output:null,decrypt:!0,mode:t})};dt.aes.Algorithm=function(e,t){Ks||B0();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return Us(r._w,n,i,!1)},decrypt:function(n,i){return Us(r._w,n,i,!0)}}}),r._init=!1};dt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=dt.util.createBuffer(t);else if(dt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=dt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!dt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!dt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=A0(t,e.decrypt&&!o),this._init=!0}};dt.aes._expandKey=function(e,t){return Ks||B0(),A0(e,t)};dt.aes._updateBlock=Us;Nr("AES-ECB",dt.cipher.modes.ecb);Nr("AES-CBC",dt.cipher.modes.cbc);Nr("AES-CFB",dt.cipher.modes.cfb);Nr("AES-OFB",dt.cipher.modes.ofb);Nr("AES-CTR",dt.cipher.modes.ctr);Nr("AES-GCM",dt.cipher.modes.gcm);function Nr(e,t){var r=function(){return new dt.aes.Algorithm(e,t)};dt.cipher.registerAlgorithm(e,r)}var Ks=!1,Rr=4,Ht,ks,S0,nr,ae;function B0(){Ks=!0,S0=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Ht=new Array(256),ks=new Array(256),nr=new Array(4),ae=new Array(4);for(var t=0;t<4;++t)nr[t]=new Array(256),ae[t]=new Array(256);for(var r=0,n=0,i,s,o,a,c,f,u,t=0;t<256;++t){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Ht[r]=a,ks[a]=r,c=e[a],i=e[r],s=e[i],o=e[s],f=c<<24^a<<16^a<<8^(a^c),u=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)nr[h][r]=f,ae[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^e[e[e[i^o]]],n^=e[e[n]])}}function A0(e,t){for(var r=e.slice(0),n,i=1,s=r.length,o=s+6+1,a=Rr*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=Ht[n>>>16&255]<<24^Ht[n>>>8&255]<<16^Ht[n&255]<<8^Ht[n>>>24]^S0[i]<<24,i++):s>6&&c%s===4&&(n=Ht[n>>>24]<<24^Ht[n>>>16&255]<<16^Ht[n>>>8&255]<<8^Ht[n&255]),r[c]=r[c-s]^n;if(t){var f,u=ae[0],h=ae[1],l=ae[2],x=ae[3],p=r.slice(0);a=r.length;for(var c=0,d=a-Rr;c<a;c+=Rr,d-=Rr)if(c===0||c===a-Rr)p[c]=r[d],p[c+1]=r[d+3],p[c+2]=r[d+2],p[c+3]=r[d+1];else for(var y=0;y<Rr;++y)f=r[d+y],p[c+(3&-y)]=u[Ht[f>>>24]]^h[Ht[f>>>16&255]]^l[Ht[f>>>8&255]]^x[Ht[f&255]];r=p}return r}function Us(e,t,r,n){var i=e.length/4-1,s,o,a,c,f;n?(s=ae[0],o=ae[1],a=ae[2],c=ae[3],f=ks):(s=nr[0],o=nr[1],a=nr[2],c=nr[3],f=Ht);var u,h,l,x,p,d,y;u=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],x=t[n?1:3]^e[3];for(var g=3,v=1;v<i;++v)p=s[u>>>24]^o[h>>>16&255]^a[l>>>8&255]^c[x&255]^e[++g],d=s[h>>>24]^o[l>>>16&255]^a[x>>>8&255]^c[u&255]^e[++g],y=s[l>>>24]^o[x>>>16&255]^a[u>>>8&255]^c[h&255]^e[++g],x=s[x>>>24]^o[u>>>16&255]^a[h>>>8&255]^c[l&255]^e[++g],u=p,h=d,l=y;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[x&255]^e[++g],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[x>>>8&255]<<8^f[u&255]^e[++g],r[2]=f[l>>>24]<<24^f[x>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^e[++g],r[n?1:3]=f[x>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^e[++g]}function li(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=dt.cipher.createDecipher(r,e.key):n=dt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof dt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var _0=pt((Zg,T0)=>{var vt=ht();Ns();Ps();Ct();T0.exports=vt.des=vt.des||{};vt.des.startEncrypting=function(e,t,r,n){var i=pi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};vt.des.createEncryptionCipher=function(e,t){return pi({key:e,output:null,decrypt:!1,mode:t})};vt.des.startDecrypting=function(e,t,r,n){var i=pi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};vt.des.createDecryptionCipher=function(e,t){return pi({key:e,output:null,decrypt:!0,mode:t})};vt.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return I0(r._keys,n,i,!1)},decrypt:function(n,i){return I0(r._keys,n,i,!0)}}}),r._init=!1};vt.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=vt.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=cl(t),this._init=!0}};le("DES-ECB",vt.cipher.modes.ecb);le("DES-CBC",vt.cipher.modes.cbc);le("DES-CFB",vt.cipher.modes.cfb);le("DES-OFB",vt.cipher.modes.ofb);le("DES-CTR",vt.cipher.modes.ctr);le("3DES-ECB",vt.cipher.modes.ecb);le("3DES-CBC",vt.cipher.modes.cbc);le("3DES-CFB",vt.cipher.modes.cfb);le("3DES-OFB",vt.cipher.modes.ofb);le("3DES-CTR",vt.cipher.modes.ctr);function le(e,t){var r=function(){return new vt.des.Algorithm(e,t)};vt.cipher.registerAlgorithm(e,r)}var tl=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],el=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],rl=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],nl=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],il=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],sl=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],ol=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],al=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function cl(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],x=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=e.length()>8?3:1,y=[],g=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],v=0,m,C=0;C<d;C++){var S=e.getInt32(),B=e.getInt32();m=(S>>>4^B)&252645135,B^=m,S^=m<<4,m=(B>>>-16^S)&65535,S^=m,B^=m<<-16,m=(S>>>2^B)&858993459,B^=m,S^=m<<2,m=(B>>>-16^S)&65535,S^=m,B^=m<<-16,m=(S>>>1^B)&1431655765,B^=m,S^=m<<1,m=(B>>>8^S)&16711935,S^=m,B^=m<<8,m=(S>>>1^B)&1431655765,B^=m,S^=m<<1,m=S<<8|B>>>20&240,S=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=m;for(var R=0;R<g.length;++R){g[R]?(S=S<<2|S>>>26,B=B<<2|B>>>26):(S=S<<1|S>>>27,B=B<<1|B>>>27),S&=-15,B&=-15;var L=t[S>>>28]|r[S>>>24&15]|n[S>>>20&15]|i[S>>>16&15]|s[S>>>12&15]|o[S>>>8&15]|a[S>>>4&15],O=c[B>>>28]|f[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|x[B>>>8&15]|p[B>>>4&15];m=(O>>>16^L)&65535,y[v++]=L^m,y[v++]=O^m<<16}}return y}function I0(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=t[0],c=t[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=s[f+1],h=s[f+2],l=s[f];l!=u;l+=h){var x=c^e[l],p=(c>>>4|c<<28)^e[l+1];o=a,a=c,c=o^(el[x>>>24&63]|nl[x>>>16&63]|sl[x>>>8&63]|al[x&63]|tl[p>>>24&63]|rl[p>>>16&63]|il[p>>>8&63]|ol[p&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function pi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=vt.cipher.createDecipher(r,e.key):n=vt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof vt.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var ir=pt((Xg,L0)=>{var di=ht();L0.exports=di.md=di.md||{};di.md.algorithms=di.md.algorithms||{}});var N0=pt((Qg,R0)=>{var Le=ht();ir();Ct();var fl=R0.exports=Le.hmac=Le.hmac||{};fl.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Le.md.algorithms)t=Le.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(o===null)o=e;else{if(typeof o=="string")o=Le.util.createBuffer(o);else if(Le.util.isArray(o)){var a=o;o=Le.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var f=o.length();f>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=Le.util.createBuffer(),n=Le.util.createBuffer(),f=o.length();for(var c=0;c<f;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<t.blockLength)for(var a=t.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var yi=pt(()=>{});var P0=pt((t2,D0)=>{var qt=ht();N0();ir();Ct();var ul=qt.pkcs5=qt.pkcs5||{},Re;qt.util.isNodejs&&!qt.options.usePureJavaScript&&(Re=yi());D0.exports=qt.pbkdf2=ul.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),qt.util.isNodejs&&!qt.options.usePureJavaScript&&Re.pbkdf2&&(i===null||typeof i!="object")&&(Re.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?Re.pbkdf2Sync.length===4?Re.pbkdf2(e,t,r,n,function(m,C){if(m)return s(m);s(null,C.toString("binary"))}):Re.pbkdf2(e,t,r,n,i,function(m,C){if(m)return s(m);s(null,C.toString("binary"))}):Re.pbkdf2Sync.length===4?Re.pbkdf2Sync(e,t,r,n).toString("binary"):Re.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in qt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=qt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),f=n-(c-1)*o,u=qt.hmac.create();u.start(i,e);var h="",l,x,p;if(!s){for(var d=1;d<=c;++d){u.start(null,null),u.update(t),u.update(qt.util.int32ToBytes(d)),l=p=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(p),x=u.digest().getBytes(),l=qt.util.xorBytes(l,x,o),p=x;h+=d<c?l:l.substr(0,f)}return h}var d=1,y;function g(){if(d>c)return s(null,h);u.start(null,null),u.update(t),u.update(qt.util.int32ToBytes(d)),l=p=u.digest().getBytes(),y=2,v()}function v(){if(y<=r)return u.start(null,null),u.update(p),x=u.digest().getBytes(),l=qt.util.xorBytes(l,x,o),p=x,++y,qt.util.setImmediate(v);h+=d<c?l:l.substr(0,f),++d,g()}g()}});var K0=pt((e2,U0)=>{var gi=ht();Ct();var k0=U0.exports=gi.pem=gi.pem||{};k0.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=xi(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=xi(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=xi(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=xi(e.headers[i]);return e.procType&&(r+=`\r
`),r+=gi.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};k0.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:gi.util.decode64(s[3])};if(t.push(a),!!s[2]){for(var c=s[2].split(i),f=0;s&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(s=u.match(n),s){for(var x={name:s[1],values:[]},p=s[2].split(","),d=0;d<p.length;++d)x.values.push(hl(p[d]));if(a.procType)if(!a.contentDomain&&x.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&x.name==="DEK-Info"){if(x.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(x);else{if(x.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(x.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function xi(e){for(var t=e.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<t.length;++i,++s)if(s>65&&o!==-1){var a=t[o];a===","?(++o,t=t.substr(0,o)+`\r
 `+t.substr(o)):t=t.substr(0,o)+`\r
`+a+t.substr(o+1),s=i-o-1,o=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(o=i);return t}function hl(e){return e.replace(/^\s+/,"")}});var q0=pt((r2,H0)=>{var pe=ht();ir();Ct();var M0=H0.exports=pe.sha256=pe.sha256||{};pe.md.sha256=pe.md.algorithms.sha256=M0;M0.create=function(){V0||ll();var e=null,t=pe.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=pe.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=pe.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),O0(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=pe.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Ms.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};O0(h,r,i);var l=pe.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Ms=null,V0=!1,F0=null;function ll(){Ms="\x80",Ms+=pe.util.fillString("\0",64),F0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],V0=!0}function O0(e,t,r){for(var n,i,s,o,a,c,f,u,h,l,x,p,d,y,g,v=r.length();v>=64;){for(f=0;f<16;++f)t[f]=r.getInt32();for(;f<64;++f)n=t[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[f]=n+t[f-7]+i+t[f-16]|0;for(u=e.h0,h=e.h1,l=e.h2,x=e.h3,p=e.h4,d=e.h5,y=e.h6,g=e.h7,f=0;f<64;++f)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=y^p&(d^y),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=g+o+a+F0[f]+t[f],i=s+c,g=y,y=d,d=p,p=x+n>>>0,x=l,l=h,h=u,u=n+i>>>0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+x|0,e.h4=e.h4+p|0,e.h5=e.h5+d|0,e.h6=e.h6+y|0,e.h7=e.h7+g|0,v-=64}}});var G0=pt((n2,z0)=>{var de=ht();Ct();var mi=null;de.util.isNodejs&&!de.options.usePureJavaScript&&!process.versions["node-webkit"]&&(mi=yi());var pl=z0.exports=de.prng=de.prng||{};pl.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(f,u){if(!u)return t.generateSync(f);var h=t.plugin.cipher,l=t.plugin.increment,x=t.plugin.formatKey,p=t.plugin.formatSeed,d=de.util.createBuffer();t.key=null,y();function y(g){if(g)return u(g);if(d.length()>=f)return u(null,d.getBytes(f));if(t.generated>1048575&&(t.key=null),t.key===null)return de.util.nextTick(function(){s(y)});var v=h(t.key,t.seed);t.generated+=v.length,d.putBytes(v),t.key=x(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),de.util.setImmediate(y)}},t.generateSync=function(f){var u=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,x=t.plugin.formatSeed;t.key=null;for(var p=de.util.createBuffer();p.length()<f;){t.generated>1048575&&(t.key=null),t.key===null&&o();var d=u(t.key,t.seed);t.generated+=d.length,p.putBytes(d),t.key=l(u(t.key,h(t.seed))),t.seed=x(u(t.key,t.seed))}return p.getBytes(f)};function s(f){if(t.pools[0].messageLength>=32)return a(),f();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(h,l){if(h)return f(h);t.collect(l),a(),f()})}function o(){if(t.pools[0].messageLength>=32)return a();var f=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(f)),a()}function a(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var f=t.plugin.md.create();f.update(t.keyBytes);for(var u=1,h=0;h<32;++h)t.reseeds%u===0&&(f.update(t.pools[h].digest().getBytes()),t.pools[h].start()),u=u<<1;t.keyBytes=f.digest().getBytes(),f.start(),f.update(t.keyBytes);var l=f.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function c(f){var u=null,h=de.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(S){return l.getRandomValues(S)});var x=de.util.createBuffer();if(u)for(;x.length()<f;){var p=Math.max(1,Math.min(f-x.length(),65536)/4),d=new Uint32Array(Math.floor(p));try{u(d);for(var y=0;y<d.length;++y)x.putInt32(d[y])}catch(S){if(!(typeof QuotaExceededError<"u"&&S instanceof QuotaExceededError))throw S}}if(x.length()<f)for(var g,v,m,C=Math.floor(Math.random()*65536);x.length()<f;){v=16807*(C&65535),g=16807*(C>>16),v+=(g&32767)<<16,v+=g>>15,v=(v&2147483647)+(v>>31),C=v&4294967295;for(var y=0;y<3;++y)m=C>>>(y<<3),m^=Math.floor(Math.random()*256),x.putByte(m&255)}return x.getBytes(f)}return mi?(t.seedFile=function(f,u){mi.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},t.seedFileSync=function(f){return mi.randomBytes(f).toString()}):(t.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},t.seedFileSync=c),t.collect=function(f){for(var u=f.length,h=0;h<u;++h)t.pools[t.pool].update(f.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);t.collect(h)},t.registerWorker=function(f){if(f===self)t.seedFile=function(h,l){function x(p){var d=p.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",x),l(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",x),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(x,p){f.postMessage({forge:{prng:{err:x,bytes:p}}})})};f.addEventListener("message",u)}},t}});var pn=pt((i2,Vs)=>{var Pt=ht();Os();q0();G0();Ct();(function(){if(Pt.random&&Pt.random.getBytes){Vs.exports=Pt.random;return}(function(e){var t={},r=new Array(4),n=Pt.util.createBuffer();t.formatKey=function(h){var l=Pt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Pt.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=Pt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return Pt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Pt.md.sha256;function i(){var h=Pt.prng.create(t);return h.getBytes=function(l,x){return h.generate(l,x)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=Pt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),Pt.options.usePureJavaScript||!Pt.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}s.collect(f),f=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Pt.random)Pt.random=s;else for(var u in s)Pt.random[u]=s[u];Pt.random.createInstance=i,Vs.exports=Pt.random})(typeof jQuery<"u"?jQuery:null)})()});var Z0=pt((s2,$0)=>{var Yt=ht();Ct();var Fs=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Y0=[1,2,3,5],dl=function(e,t){return e<<t&65535|(e&65535)>>16-t},yl=function(e,t){return(e&65535)>>t|e<<16-t&65535};$0.exports=Yt.rc2=Yt.rc2||{};Yt.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Yt.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Fs[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Fs[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Fs[r.at(a+1)^r.at(a+s)]);return r};var W0=function(e,t,r){var n=!1,i=null,s=null,o=null,a,c,f,u,h=[];for(e=Yt.rc2.expandKey(e,t),f=0;f<64;f++)h.push(e.getInt16Le());r?(a=function(p){for(f=0;f<4;f++)p[f]+=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=dl(p[f],Y0[f]),u++},c=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(a=function(p){for(f=3;f>=0;f--)p[f]=yl(p[f],Y0[f]),p[f]-=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),u--},c=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var d=[];for(f=0;f<4;f++){var y=i.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),d.push(y&65535)}u=r?0:63;for(var g=0;g<p.length;g++)for(var v=0;v<p[g][0];v++)p[g][1](d);for(f=0;f<4;f++)o!==null&&(r?o.putInt16Le(d[f]):d[f]^=o.getInt16Le()),s.putInt16Le(d[f])},x=null;return x={start:function(p,d){p&&typeof p=="string"&&(p=Yt.util.createBuffer(p)),n=!1,i=Yt.util.createBuffer(),s=d||new Yt.util.createBuffer,o=p,x.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var d=!0;if(r)if(p)d=p(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(d&&(n=!0,x.update()),!r&&(d=i.length()===0,d))if(p)d=p(8,s,!r);else{var g=s.length(),v=s.at(g-1);v>g?d=!1:s.truncate(v)}return d}},x};Yt.rc2.startEncrypting=function(e,t,r){var n=Yt.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Yt.rc2.createEncryptionCipher=function(e,t){return W0(e,t,!0)};Yt.rc2.startDecrypting=function(e,t,r){var n=Yt.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Yt.rc2.createDecryptionCipher=function(e,t){return W0(e,t,!1)}});var wi=pt((o2,nc)=>{var Hs=ht();nc.exports=Hs.jsbn=Hs.jsbn||{};var Ne,xl=0xdeadbeefcafe,X0=(xl&16777215)==15715070;function D(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Hs.jsbn.BigInteger=D;function ot(){return new D(null)}function gl(e,t,r,n,i,s){for(;--s>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function ml(e,t,r,n,i,s){for(var o=t&32767,a=t>>15;--s>=0;){var c=this.data[e]&32767,f=this.data[e++]>>15,u=a*c+f*o;c=o*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+a*f+(i>>>30),r.data[n++]=c&1073741823}return i}function Q0(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var c=this.data[e]&16383,f=this.data[e++]>>14,u=a*c+f*o;c=o*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(D.prototype.am=Q0,Ne=28):X0&&navigator.appName=="Microsoft Internet Explorer"?(D.prototype.am=ml,Ne=30):X0&&navigator.appName!="Netscape"?(D.prototype.am=gl,Ne=26):(D.prototype.am=Q0,Ne=28);D.prototype.DB=Ne;D.prototype.DM=(1<<Ne)-1;D.prototype.DV=1<<Ne;var qs=52;D.prototype.FV=Math.pow(2,qs);D.prototype.F1=qs-Ne;D.prototype.F2=2*Ne-qs;var bl="0123456789abcdefghijklmnopqrstuvwxyz",bi=new Array,Dr,jt;Dr=48;for(jt=0;jt<=9;++jt)bi[Dr++]=jt;Dr=97;for(jt=10;jt<36;++jt)bi[Dr++]=jt;Dr=65;for(jt=10;jt<36;++jt)bi[Dr++]=jt;function J0(e){return bl.charAt(e)}function j0(e,t){var r=bi[e.charCodeAt(t)];return r??-1}function vl(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function wl(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function Ge(e){var t=ot();return t.fromInt(e),t}function El(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=r==8?e[n]&255:j0(e,n);if(o<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&D.ZERO.subTo(this,this)}function Sl(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Bl(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=J0(n));o>=0;)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=J0(n));return i?s:"0"}function Al(){var e=ot();return D.ZERO.subTo(this,e),e}function Cl(){return this.s<0?this.negate():this}function Il(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function vi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Tl(){return this.t<=0?0:this.DB*(this.t-1)+vi(this.data[this.t-1]^this.s&this.DM)}function _l(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function Ll(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function Rl(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)t.data[a]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Nl(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function Dl(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function Pl(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&D.ZERO.subTo(t,t)}function kl(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function Ul(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ot());var s=ot(),o=this.s,a=e.s,c=this.DB-vi(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var f=s.t,u=s.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?s.data[f-2]>>this.F2:0),l=this.FV/h,x=(1<<this.F1)/h,p=1<<this.F2,d=r.t,y=d-f,g=t??ot();for(s.dlShiftTo(y,g),r.compareTo(g)>=0&&(r.data[r.t++]=1,r.subTo(g,r)),D.ONE.dlShiftTo(f,g),g.subTo(s,s);s.t<f;)s.data[s.t++]=0;for(;--y>=0;){var v=r.data[--d]==u?this.DM:Math.floor(r.data[d]*l+(r.data[d-1]+p)*x);if((r.data[d]+=s.am(0,v,r,y,0,f))<v)for(s.dlShiftTo(y,g),r.subTo(g,r);r.data[d]<--v;)r.subTo(g,r)}t!=null&&(r.drShiftTo(f,t),o!=a&&D.ZERO.subTo(t,t)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&D.ZERO.subTo(r,r)}}}function Kl(e){var t=ot();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(D.ZERO)>0&&e.subTo(t,t),t}function sr(e){this.m=e}function Ol(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function Ml(e){return e}function Vl(e){e.divRemTo(this.m,null,e)}function Fl(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Hl(e,t){e.squareTo(t),this.reduce(t)}sr.prototype.convert=Ol;sr.prototype.revert=Ml;sr.prototype.reduce=Vl;sr.prototype.mulTo=Fl;sr.prototype.sqrTo=Hl;function ql(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function or(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function zl(e){var t=ot();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(D.ZERO)>0&&this.m.subTo(t,t),t}function Gl(e){var t=ot();return e.copyTo(t),this.reduce(t),t}function Yl(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Wl(e,t){e.squareTo(t),this.reduce(t)}function $l(e,t,r){e.multiplyTo(t,r),this.reduce(r)}or.prototype.convert=zl;or.prototype.revert=Gl;or.prototype.reduce=Yl;or.prototype.mulTo=$l;or.prototype.sqrTo=Wl;function Zl(){return(this.t>0?this.data[0]&1:this.s)==0}function Xl(e,t){if(e>4294967295||e<1)return D.ONE;var r=ot(),n=ot(),i=t.convert(this),s=vi(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}function Ql(e,t){var r;return e<256||t.isEven()?r=new sr(t):r=new or(t),this.exp(e,r)}D.prototype.copyTo=vl;D.prototype.fromInt=wl;D.prototype.fromString=El;D.prototype.clamp=Sl;D.prototype.dlShiftTo=_l;D.prototype.drShiftTo=Ll;D.prototype.lShiftTo=Rl;D.prototype.rShiftTo=Nl;D.prototype.subTo=Dl;D.prototype.multiplyTo=Pl;D.prototype.squareTo=kl;D.prototype.divRemTo=Ul;D.prototype.invDigit=ql;D.prototype.isEven=Zl;D.prototype.exp=Xl;D.prototype.toString=Bl;D.prototype.negate=Al;D.prototype.abs=Cl;D.prototype.compareTo=Il;D.prototype.bitLength=Tl;D.prototype.mod=Kl;D.prototype.modPowInt=Ql;D.ZERO=Ge(0);D.ONE=Ge(1);function Jl(){var e=ot();return this.copyTo(e),e}function jl(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function tp(){return this.t==0?this.s:this.data[0]<<24>>24}function ep(){return this.t==0?this.s:this.data[0]<<16>>16}function rp(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function np(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function ip(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=Ge(r),i=ot(),s=ot(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}function sp(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var c=j0(e,a);if(c<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&D.ZERO.subTo(this,this)}function op(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(D.ONE.shiftLeft(e-1),zs,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(D.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ap(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function cp(e){return this.compareTo(e)==0}function fp(e){return this.compareTo(e)<0?this:e}function up(e){return this.compareTo(e)>0?this:e}function hp(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function lp(e,t){return e&t}function pp(e){var t=ot();return this.bitwiseTo(e,lp,t),t}function zs(e,t){return e|t}function dp(e){var t=ot();return this.bitwiseTo(e,zs,t),t}function tc(e,t){return e^t}function yp(e){var t=ot();return this.bitwiseTo(e,tc,t),t}function ec(e,t){return e&~t}function xp(e){var t=ot();return this.bitwiseTo(e,ec,t),t}function gp(){for(var e=ot(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function mp(e){var t=ot();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function bp(e){var t=ot();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function vp(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function wp(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+vp(this.data[e]);return this.s<0?this.t*this.DB:-1}function Ep(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Sp(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Ep(this.data[r]^t);return e}function Bp(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Ap(e,t){var r=D.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Cp(e){return this.changeBit(e,zs)}function Ip(e){return this.changeBit(e,ec)}function Tp(e){return this.changeBit(e,tc)}function _p(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function Lp(e){var t=ot();return this.addTo(e,t),t}function Rp(e){var t=ot();return this.subTo(e,t),t}function Np(e){var t=ot();return this.multiplyTo(e,t),t}function Dp(e){var t=ot();return this.divRemTo(e,t,null),t}function Pp(e){var t=ot();return this.divRemTo(e,null,t),t}function kp(e){var t=ot(),r=ot();return this.divRemTo(e,t,r),new Array(t,r)}function Up(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Kp(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function dn(){}function rc(e){return e}function Op(e,t,r){e.multiplyTo(t,r)}function Mp(e,t){e.squareTo(t)}dn.prototype.convert=rc;dn.prototype.revert=rc;dn.prototype.mulTo=Op;dn.prototype.sqrTo=Mp;function Vp(e){return this.exp(e,new dn)}function Fp(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function Hp(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Pr(e){this.r2=ot(),this.q3=ot(),D.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function qp(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ot();return e.copyTo(t),this.reduce(t),t}function zp(e){return e}function Gp(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Yp(e,t){e.squareTo(t),this.reduce(t)}function Wp(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Pr.prototype.convert=qp;Pr.prototype.revert=zp;Pr.prototype.reduce=Gp;Pr.prototype.mulTo=Wp;Pr.prototype.sqrTo=Yp;function $p(e,t){var r=e.bitLength(),n,i=Ge(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new sr(t):t.isEven()?s=new Pr(t):s=new or(t);var o=new Array,a=3,c=n-1,f=(1<<n)-1;if(o[1]=s.convert(this),n>1){var u=ot();for(s.sqrTo(o[1],u);a<=f;)o[a]=ot(),s.mulTo(u,o[a-2],o[a]),a+=2}var h=e.t-1,l,x=!0,p=ot(),d;for(r=vi(e.data[h])-1;h>=0;){for(r>=c?l=e.data[h]>>r-c&f:(l=(e.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=e.data[h-1]>>this.DB+r-c)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),x)o[l].copyTo(i),x=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(d=i,i=p,p=d),s.mulTo(p,o[l],i)}for(;h>=0&&!(e.data[h]&1<<r);)s.sqrTo(i,p),d=i,i=p,p=d,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function Zp(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Xp(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function Qp(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return D.ZERO;for(var r=e.clone(),n=this.clone(),i=Ge(1),s=Ge(0),o=Ge(0),a=Ge(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(D.ONE)!=0)return D.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var ce=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Jp=(1<<26)/ce[ce.length-1];function jp(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=ce[ce.length-1]){for(t=0;t<ce.length;++t)if(r.data[0]==ce[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<ce.length;){for(var n=ce[t],i=t+1;i<ce.length&&n<Jp;)n*=ce[i++];for(n=r.modInt(n);t<i;)if(n%ce[t++]==0)return!1}return r.millerRabin(e)}function td(e){var t=this.subtract(D.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=ed(),s,o=0;o<e;++o){do s=new D(this.bitLength(),i);while(s.compareTo(D.ONE)<=0||s.compareTo(t)>=0);var a=s.modPow(n,this);if(a.compareTo(D.ONE)!=0&&a.compareTo(t)!=0){for(var c=1;c++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(D.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}function ed(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}D.prototype.chunkSize=rp;D.prototype.toRadix=ip;D.prototype.fromRadix=sp;D.prototype.fromNumber=op;D.prototype.bitwiseTo=hp;D.prototype.changeBit=Ap;D.prototype.addTo=_p;D.prototype.dMultiply=Up;D.prototype.dAddOffset=Kp;D.prototype.multiplyLowerTo=Fp;D.prototype.multiplyUpperTo=Hp;D.prototype.modInt=Xp;D.prototype.millerRabin=td;D.prototype.clone=Jl;D.prototype.intValue=jl;D.prototype.byteValue=tp;D.prototype.shortValue=ep;D.prototype.signum=np;D.prototype.toByteArray=ap;D.prototype.equals=cp;D.prototype.min=fp;D.prototype.max=up;D.prototype.and=pp;D.prototype.or=dp;D.prototype.xor=yp;D.prototype.andNot=xp;D.prototype.not=gp;D.prototype.shiftLeft=mp;D.prototype.shiftRight=bp;D.prototype.getLowestSetBit=wp;D.prototype.bitCount=Sp;D.prototype.testBit=Bp;D.prototype.setBit=Cp;D.prototype.clearBit=Ip;D.prototype.flipBit=Tp;D.prototype.add=Lp;D.prototype.subtract=Rp;D.prototype.multiply=Np;D.prototype.divide=Dp;D.prototype.remainder=Pp;D.prototype.divideAndRemainder=kp;D.prototype.modPow=$p;D.prototype.modInverse=Qp;D.prototype.pow=Vp;D.prototype.gcd=Zp;D.prototype.isProbablePrime=jp});var cc=pt((a2,ac)=>{var ye=ht();ir();Ct();var sc=ac.exports=ye.sha1=ye.sha1||{};ye.md.sha1=ye.md.algorithms.sha1=sc;sc.create=function(){oc||rd();var e=null,t=ye.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=ye.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ye.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(i),ic(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=ye.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Gs.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};ic(h,r,i);var l=ye.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Gs=null,oc=!1;function rd(){Gs="\x80",Gs+=ye.util.fillString("\0",64),oc=!0}function ic(e,t,r){for(var n,i,s,o,a,c,f,u,h=r.length();h>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,f=a^s&(o^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,f=s&o|a&(s^o),n=(i<<5|i>>>27)+f+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,f=s^o^a,n=(i<<5|i>>>27)+f+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,h-=64}}});var hc=pt((c2,uc)=>{var xe=ht();Ct();pn();cc();var fc=uc.exports=xe.pkcs1=xe.pkcs1||{};fc.encode_rsa_oaep=function(e,t,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=xe.md.sha1.create(),o||(o=s);var a=Math.ceil(e.n.bitLength()/8),c=a-2*s.digestLength-2;if(t.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=t.length,f.maxLength=c,f}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=c-t.length,x=0;x<l;x++)h+="\0";var p=u.getBytes()+h+""+t;if(!i)i=xe.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=s.digestLength,f}var d=Ei(i,a-s.digestLength-1,o),y=xe.util.xorBytes(p,d,p.length),g=Ei(y,s.digestLength,o),v=xe.util.xorBytes(i,g,i.length);return"\0"+v+y};fc.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=t.length,y.expectedLength=o,y}if(i===void 0?i=xe.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=t.charAt(0),f=t.substring(1,i.digestLength+1),u=t.substring(1+i.digestLength),h=Ei(u,i.digestLength,s),l=xe.util.xorBytes(f,h,f.length),x=Ei(l,o-i.digestLength-1,s),p=xe.util.xorBytes(u,x,u.length),d=p.substring(0,i.digestLength),y=c!=="\0",g=0;g<i.digestLength;++g)y|=a.charAt(g)!==d.charAt(g);for(var v=1,m=i.digestLength,C=i.digestLength;C<p.length;C++){var S=p.charCodeAt(C),B=S&1^1,R=v?65534:0;y|=S&R,v=v&B,m+=v}if(y||p.charCodeAt(m)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(m+1)};function Ei(e,t,r){r||(r=xe.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+o),n+=r.digest().getBytes()}return n.substring(0,t)}});var lc=pt((f2,Ys)=>{var Ye=ht();Ct();wi();pn();(function(){if(Ye.prime){Ys.exports=Ye.prime;return}var e=Ys.exports=Ye.prime=Ye.prime||{},t=Ye.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,x){typeof l=="function"&&(x=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var d=l.prng||Ye.random,y={nextBytes:function(g){for(var v=d.getBytesSync(g.length),m=0;m<g.length;++m)g[m]=v.charCodeAt(m)}};if(p.name==="PRIMEINC")return s(h,y,p.options,x);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,x,p){return"workers"in x?c(h,l,x,p):o(h,l,x,p)}function o(h,l,x,p){var d=f(h,l),y=0,g=u(d.bitLength());"millerRabinTests"in x&&(g=x.millerRabinTests);var v=10;"maxBlockTime"in x&&(v=x.maxBlockTime),a(d,h,l,y,g,v,p)}function a(h,l,x,p,d,y,g){var v=+new Date;do{if(h.bitLength()>l&&(h=f(l,x)),h.isProbablePrime(d))return g(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-v<y);Ye.util.setImmediate(function(){a(h,l,x,p,d,y,g)})}function c(h,l,x,p){if(typeof Worker>"u")return o(h,l,x,p);var d=f(h,l),y=x.workers,g=x.workLoad||100,v=g*30/8,m=x.workerScript||"forge/prime.worker.js";if(y===-1)return Ye.util.estimateCores(function(S,B){S&&(B=2),y=B-1,C()});C();function C(){y=Math.max(1,y);for(var S=[],B=0;B<y;++B)S[B]=new Worker(m);for(var R=y,B=0;B<y;++B)S[B].addEventListener("message",O);var L=!1;function O(M){if(!L){--R;var U=M.data;if(U.found){for(var q=0;q<S.length;++q)S[q].terminate();return L=!0,p(null,new t(U.prime,16))}d.bitLength()>h&&(d=f(h,l));var z=d.toString(16);M.target.postMessage({hex:z,workLoad:g}),d.dAddOffset(v,0)}}}}function f(h,l){var x=new t(h,l),p=h-1;return x.testBit(p)||x.bitwiseTo(t.ONE.shiftLeft(p),i,x),x.dAddOffset(31-x.mod(n).byteValue(),0),x}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Bi=pt((u2,bc)=>{var Y=ht();ln();wi();ci();hc();lc();pn();Ct();typeof st>"u"&&(st=Y.jsbn.BigInteger);var st,Ws=Y.util.isNodejs?yi():null,E=Y.asn1,te=Y.util;Y.pki=Y.pki||{};bc.exports=Y.pki.rsa=Y.rsa=Y.rsa||{};var Q=Y.pki,nd=[6,4,2,4,2,4,6,2],id={name:"PrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},sd={name:"RSAPrivateKey",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},od={name:"RSAPublicKey",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ad=Y.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:E.Class.UNIVERSAL,type:E.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},cd={name:"DigestInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},fd=function(e){var t;if(e.algorithm in Q.oids)t=Q.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=E.oidToDer(t).getBytes(),i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]),s=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[]);s.value.push(E.create(E.Class.UNIVERSAL,E.Type.OID,!1,n)),s.value.push(E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,""));var o=E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(o),E.toDer(i).getBytes()},gc=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(st.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(st.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new st(Y.util.bytesToHex(Y.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(st.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var o=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return o=o.multiply(n.modInverse(t.n)).mod(t.n),o};Q.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=mc(e,t,r)):(i=Y.util.createBuffer(),i.putBytes(e));for(var o=new st(i.toHex(),16),a=gc(o,t,n),c=a.toString(16),f=Y.util.createBuffer(),u=s-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(Y.util.hexToBytes(c)),f.getBytes()};Q.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var o=new st(Y.util.createBuffer(e).toHex(),16);if(o.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=gc(o,t,r),c=a.toString(16),f=Y.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(Y.util.hexToBytes(c)),n!==!1?Si(f.getBytes(),t,r):f.getBytes()};Q.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||Y.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new st(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};Q.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new st(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;e.keys===null&&(t<=0||a<t);){if(e.state===0){var c=e.p===null?e.pBits:e.qBits,f=c-1;e.pqState===0?(e.num=new st(c,e.rng),e.num.testBit(f)||e.num.bitwiseTo(st.ONE.shiftLeft(f),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(hd(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(nd[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(st.ONE).gcd(e.e).compareTo(st.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(st.ONE),e.q1=e.q.subtract(st.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(st.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:Q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:Q.rsa.setPublicKey(e.n,e.e)}}o=+new Date,a+=o-s,s=o}return e.keys!==null};Q.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!Y.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(pc("generateKeyPair"))return Ws.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:Q.privateKeyFromPem(f),publicKey:Q.publicKeyFromPem(c)})});if(dc("generateKey")&&dc("exportKey"))return te.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:xc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return te.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=Q.privateKeyFromAsn1(E.fromDer(Y.util.createBuffer(a)));n(null,{privateKey:c,publicKey:Q.setRsaPublicKey(c.n,c.e)})}});if(yc("generateKey")&&yc("exportKey")){var i=te.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:xc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,f=te.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=Q.privateKeyFromAsn1(E.fromDer(Y.util.createBuffer(h)));n(null,{privateKey:l,publicKey:Q.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(pc("generateKeyPairSync")){var s=Ws.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Q.privateKeyFromPem(s.privateKey),publicKey:Q.publicKeyFromPem(s.publicKey)}}}var o=Q.rsa.createKeyPairGenerationState(e,t,r);if(!n)return Q.rsa.stepKeyPairGenerationState(o,0),o.keys;ud(o,r,n)};Q.setRsaPublicKey=Q.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,f){return mc(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return Y.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return Q.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,f){f=Si(f,r,!0);var u=E.fromDer(f,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!E.validate(u,cd,h,l)){var x=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw x.errors=l,x}var p=E.derToOid(h.algorithmIdentifier);if(!(p===Y.oids.md2||p===Y.oids.md5||p===Y.oids.sha1||p===Y.oids.sha224||p===Y.oids.sha256||p===Y.oids.sha384||p===Y.oids.sha512||p===Y.oids["sha512-224"]||p===Y.oids["sha512-256"])){var x=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw x.oid=p,x}if((p===Y.oids.md2||p===Y.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,f){return f=Si(f,r,!0),c===f}});var a=Q.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};Q.setRsaPrivateKey=Q.rsa.setPrivateKey=function(e,t,r,n,i,s,o,a){var c={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=Q.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Si};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(x,p){return Y.pkcs1.decode_rsa_oaep(p,x,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(x){return x}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:fd},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return Q.rsa.encrypt(l,c,h)},c};Q.wrapRsaPrivateKey=function(e){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(0).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Q.oids.rsaEncryption).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")]),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,E.toDer(e).getBytes())])};Q.privateKeyFromAsn1=function(e){var t={},r=[];if(E.validate(e,id,t,r)&&(e=E.fromDer(Y.util.createBuffer(t.privateKey))),t={},r=[],!E.validate(e,sd,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,f,u,h;return i=Y.util.createBuffer(t.privateKeyModulus).toHex(),s=Y.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=Y.util.createBuffer(t.privateKeyPrivateExponent).toHex(),a=Y.util.createBuffer(t.privateKeyPrime1).toHex(),c=Y.util.createBuffer(t.privateKeyPrime2).toHex(),f=Y.util.createBuffer(t.privateKeyExponent1).toHex(),u=Y.util.createBuffer(t.privateKeyExponent2).toHex(),h=Y.util.createBuffer(t.privateKeyCoefficient).toHex(),Q.setRsaPrivateKey(new st(i,16),new st(s,16),new st(o,16),new st(a,16),new st(c,16),new st(f,16),new st(u,16),new st(h,16))};Q.privateKeyToAsn1=Q.privateKeyToRSAPrivateKey=function(e){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,E.integerToDer(0).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.n)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.e)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.d)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.p)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.q)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.dP)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.dQ)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.qInv))])};Q.publicKeyFromAsn1=function(e){var t={},r=[];if(E.validate(e,ad,t,r)){var n=E.derToOid(t.publicKeyOid);if(n!==Q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!E.validate(e,od,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=Y.util.createBuffer(t.publicKeyModulus).toHex(),o=Y.util.createBuffer(t.publicKeyExponent).toHex();return Q.setRsaPublicKey(new st(s,16),new st(o,16))};Q.publicKeyToAsn1=Q.publicKeyToSubjectPublicKeyInfo=function(e){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Q.oids.rsaEncryption).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")]),E.create(E.Class.UNIVERSAL,E.Type.BITSTRING,!1,[Q.publicKeyToRSAPublicKey(e)])])};Q.publicKeyToRSAPublicKey=function(e){return E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.n)),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,ge(e.e))])};function mc(e,t,r){var n=Y.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-e.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var f=0,u=Y.random.getBytes(o),c=0;c<o;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);o=f}return n.putByte(0),n.putBytes(e),n}function Si(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=Y.util.createBuffer(e),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var f=0;f<c;++f)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var u=s.getByte();if(u!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function ud(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(a,c){if(a)return r(a);if(e.p=c,e.q!==null)return o(a,e.q);s(e.qBits,o)})}function s(a,c){Y.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(e.q=c,e.p.compareTo(e.q)<0){var f=e.p;e.p=e.q,e.q=f}if(e.p.subtract(st.ONE).gcd(e.e).compareTo(st.ONE)!==0){e.p=null,i();return}if(e.q.subtract(st.ONE).gcd(e.e).compareTo(st.ONE)!==0){e.q=null,s(e.qBits,o);return}if(e.p1=e.p.subtract(st.ONE),e.q1=e.q.subtract(st.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(st.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,o);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:Q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:Q.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function ge(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=Y.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function hd(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function pc(e){return Y.util.isNodejs&&typeof Ws[e]=="function"}function dc(e){return typeof te.globalScope<"u"&&typeof te.globalScope.crypto=="object"&&typeof te.globalScope.crypto.subtle=="object"&&typeof te.globalScope.crypto.subtle[e]=="function"}function yc(e){return typeof te.globalScope<"u"&&typeof te.globalScope.msCrypto=="object"&&typeof te.globalScope.msCrypto.subtle=="object"&&typeof te.globalScope.msCrypto.subtle[e]=="function"}function xc(e){for(var t=Y.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Ac=pt((h2,Bc)=>{var H=ht();Os();ln();_0();ir();ci();P0();K0();pn();Z0();Bi();Ct();typeof vc>"u"&&(vc=H.jsbn.BigInteger);var vc,I=H.asn1,tt=H.pki=H.pki||{};Bc.exports=tt.pbe=H.pbe=H.pbe||{};var ar=tt.oids,ld={name:"EncryptedPrivateKeyInfo",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},pd={name:"PBES2Algorithms",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:I.Class.UNIVERSAL,type:I.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},dd={name:"pkcs-12PbeParams",tagClass:I.Class.UNIVERSAL,type:I.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:I.Class.UNIVERSAL,type:I.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:I.Class.UNIVERSAL,type:I.Type.INTEGER,constructed:!1,capture:"iterations"}]};tt.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=H.random.getBytesSync(r.saltSize),i=r.count,s=I.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":o=16,f=16,u=ar["aes128-CBC"],h=H.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,u=ar["aes192-CBC"],h=H.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,u=ar["aes256-CBC"],h=H.aes.createEncryptionCipher;break;case"des":o=8,f=8,u=ar.desCBC,h=H.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var x="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Sc(x),d=H.pkcs5.pbkdf2(t,n,i,o,p),y=H.random.getBytesSync(f),g=h(d);g.start(y),g.update(I.toDer(e)),g.finish(),c=g.output.getBytes();var v=yd(n,s,o,x);a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(ar.pkcs5PBES2).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(ar.pkcs5PBKDF2).getBytes()),v]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(u).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var m=new H.util.ByteBuffer(n),d=tt.pbe.generatePkcs12Key(t,m,1,i,o),y=tt.pbe.generatePkcs12Key(t,m,2,i,o),g=H.des.createEncryptionCipher(d);g.start(y),g.update(I.toDer(e)),g.finish(),c=g.output.getBytes(),a=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(ar["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var C=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[a,I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,c)]);return C};tt.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!I.validate(e,ld,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=I.derToOid(n.encryptionOid),a=tt.pbe.getCipher(o,n.encryptionParams,t),c=H.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=I.fromDer(a.output)),r};tt.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:I.toDer(e).getBytes()};return H.pem.encode(r,{maxline:t})};tt.encryptedPrivateKeyFromPem=function(e){var t=H.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return I.fromDer(t.body)};tt.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=tt.wrapRsaPrivateKey(tt.privateKeyToAsn1(e));return n=tt.encryptPrivateKeyInfo(n,t,r),tt.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=H.random.getBytesSync(16),a=H.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=H.random.getBytesSync(16),a=H.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=H.random.getBytesSync(16),a=H.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=H.random.getBytesSync(8),a=H.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=H.random.getBytesSync(8),a=H.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=H.pbe.opensslDeriveBytes(t,s.substr(0,8),o),u=a(f);u.start(s),u.update(I.toDer(tt.privateKeyToAsn1(e))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:H.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return H.pem.encode(h)};tt.decryptRsaPrivateKey=function(e,t){var r=null,n=H.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=H.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=H.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=H.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=H.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=H.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return H.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return H.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return H.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=H.util.hexToBytes(n.dekInfo.parameters),c=H.pbe.opensslDeriveBytes(t,a.substr(0,8),s),f=o(c);if(f.start(a),f.update(H.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=tt.decryptPrivateKeyInfo(I.fromDer(r),t):r=I.fromDer(r),r!==null&&(r=tt.privateKeyFromAsn1(r)),r};tt.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in H.md))throw new Error('"sha1" hash algorithm unavailable.');s=H.md.sha1.create()}var c=s.digestLength,f=s.blockLength,u=new H.util.ByteBuffer,h=new H.util.ByteBuffer;if(e!=null){for(a=0;a<e.length;a++)h.putInt16(e.charCodeAt(a));h.putInt16(0)}var l=h.length(),x=t.length(),p=new H.util.ByteBuffer;p.fillWithByte(r,f);var d=f*Math.ceil(x/f),y=new H.util.ByteBuffer;for(a=0;a<d;a++)y.putByte(t.at(a%x));var g=f*Math.ceil(l/f),v=new H.util.ByteBuffer;for(a=0;a<g;a++)v.putByte(h.at(a%l));var m=y;m.putBuffer(v);for(var C=Math.ceil(i/c),S=1;S<=C;S++){var B=new H.util.ByteBuffer;B.putBytes(p.bytes()),B.putBytes(m.bytes());for(var R=0;R<n;R++)s.start(),s.update(B.getBytes()),B=s.digest();var L=new H.util.ByteBuffer;for(a=0;a<f;a++)L.putByte(B.at(a%c));var O=Math.ceil(x/f)+Math.ceil(l/f),M=new H.util.ByteBuffer;for(o=0;o<O;o++){var U=new H.util.ByteBuffer(m.getBytes(f)),q=511;for(a=L.length()-1;a>=0;a--)q=q>>8,q+=L.at(a)+U.at(a),U.setAt(a,q&255);M.putBuffer(U)}m=M,u.putBuffer(B)}return u.truncate(u.length()-i),u};tt.pbe.getCipher=function(e,t,r){switch(e){case tt.oids.pkcs5PBES2:return tt.pbe.getCipherForPBES2(e,t,r);case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:return tt.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};tt.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!I.validate(t,pd,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=I.derToOid(n.kdfOid),e!==tt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=I.derToOid(n.encOid),e!==tt.oids["aes128-CBC"]&&e!==tt.oids["aes192-CBC"]&&e!==tt.oids["aes256-CBC"]&&e!==tt.oids["des-EDE3-CBC"]&&e!==tt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=H.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(tt.oids[e]){case"aes128-CBC":c=16,f=H.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=H.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=H.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=H.des.createDecryptionCipher;break;case"desCBC":c=8,f=H.des.createDecryptionCipher;break}var u=Ec(n.prfOid),h=H.pkcs5.pbkdf2(r,o,a,c,u),l=n.encIv,x=f(h);return x.start(l),x};tt.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!I.validate(t,dd,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=H.util.createBuffer(n.salt),a=H.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(e){case tt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=H.des.startDecrypting;break;case tt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(d,y){var g=H.rc2.createDecryptionCipher(d,40);return g.start(y,null),g};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=Ec(n.prfOid),l=tt.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var x=tt.pbe.generatePkcs12Key(r,o,2,a,f,h);return u(l,x)};tt.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in H.md))throw new Error('"md5" hash algorithm unavailable.');n=H.md.md5.create()}t===null&&(t="");for(var i=[wc(n,e+t)],s=16,o=1;s<r;++o,s+=16)i.push(wc(n,i[o-1]+e+t));return i.join("").substr(0,r)};function wc(e,t){return e.start().update(t).digest().getBytes()}function Ec(e){var t;if(!e)t="hmacWithSHA1";else if(t=tt.oids[I.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Sc(t)}function Sc(e){var t=H.md;switch(e){case"hmacWithSHA224":t=H.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function yd(e,t,r,n){var i=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,H.util.hexToBytes(r.toString(16))),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(tt.oids[n]).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])),i}});var gf=pt((cv,xf)=>{var mt=ht();ir();Ct();var Sn=xf.exports=mt.sha512=mt.sha512||{};mt.md.sha512=mt.md.algorithms.sha512=Sn;var df=mt.sha384=mt.sha512.sha384=mt.sha512.sha384||{};df.create=function(){return Sn.create("SHA-384")};mt.md.sha384=mt.md.algorithms.sha384=df;mt.sha512.sha256=mt.sha512.sha256||{create:function(){return Sn.create("SHA-512/256")}};mt.md["sha512/256"]=mt.md.algorithms["sha512/256"]=mt.sha512.sha256;mt.sha512.sha224=mt.sha512.sha224||{create:function(){return Sn.create("SHA-512/224")}};mt.md["sha512/224"]=mt.md.algorithms["sha512/224"]=mt.sha512.sha224;Sn.create=function(e){if(yf||Uy(),typeof e>"u"&&(e="SHA-512"),!(e in yr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=yr[e],r=null,n=mt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(e){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=mt.util.createBuffer(),r=new Array(t.length);for(var f=0;f<t.length;++f)r[f]=t[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=mt.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),pf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=mt.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(Do.substr(0,a.blockLength-u));for(var h,l,x=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,x+=l,c.putInt32(x>>>0),x=h>>>0;c.putInt32(x);for(var d=new Array(r.length),p=0;p<r.length;++p)d[p]=r[p].slice(0);pf(d,i,c);var y=mt.util.createBuffer(),g;e==="SHA-512"?g=d.length:e==="SHA-384"?g=d.length-2:g=d.length-4;for(var p=0;p<g;++p)y.putInt32(d[p][0]),(p!==g-1||e!=="SHA-512/224")&&y.putInt32(d[p][1]);return y},a};var Do=null,yf=!1,Po=null,yr=null;function Uy(){Do="\x80",Do+=mt.util.fillString("\0",128),Po=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],yr={},yr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],yr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],yr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],yr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],yf=!0}function pf(e,t,r){for(var n,i,s,o,a,c,f,u,h,l,x,p,d,y,g,v,m,C,S,B,R,L,O,M,U,q,z,Z,A,N,T,_,w,k,K,F=r.length();F>=128;){for(A=0;A<16;++A)t[A][0]=r.getInt32()>>>0,t[A][1]=r.getInt32()>>>0;for(;A<80;++A)_=t[A-2],N=_[0],T=_[1],n=((N>>>19|T<<13)^(T>>>29|N<<3)^N>>>6)>>>0,i=((N<<13|T>>>19)^(T<<3|N>>>29)^(N<<26|T>>>6))>>>0,k=t[A-15],N=k[0],T=k[1],s=((N>>>1|T<<31)^(N>>>8|T<<24)^N>>>7)>>>0,o=((N<<31|T>>>1)^(N<<24|T>>>8)^(N<<25|T>>>7))>>>0,w=t[A-7],K=t[A-16],T=i+w[1]+o+K[1],t[A][0]=n+w[0]+s+K[0]+(T/4294967296>>>0)>>>0,t[A][1]=T>>>0;for(d=e[0][0],y=e[0][1],g=e[1][0],v=e[1][1],m=e[2][0],C=e[2][1],S=e[3][0],B=e[3][1],R=e[4][0],L=e[4][1],O=e[5][0],M=e[5][1],U=e[6][0],q=e[6][1],z=e[7][0],Z=e[7][1],A=0;A<80;++A)f=((R>>>14|L<<18)^(R>>>18|L<<14)^(L>>>9|R<<23))>>>0,u=((R<<18|L>>>14)^(R<<14|L>>>18)^(L<<23|R>>>9))>>>0,h=(U^R&(O^U))>>>0,l=(q^L&(M^q))>>>0,a=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,c=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,x=(d&g|m&(d^g))>>>0,p=(y&v|C&(y^v))>>>0,T=Z+u+l+Po[A][1]+t[A][1],n=z+f+h+Po[A][0]+t[A][0]+(T/4294967296>>>0)>>>0,i=T>>>0,T=c+p,s=a+x+(T/4294967296>>>0)>>>0,o=T>>>0,z=U,Z=q,U=O,q=M,O=R,M=L,T=B+i,R=S+n+(T/4294967296>>>0)>>>0,L=T>>>0,S=m,B=C,m=g,C=v,g=d,v=y,T=i+o,d=n+s+(T/4294967296>>>0)>>>0,y=T>>>0;T=e[0][1]+y,e[0][0]=e[0][0]+d+(T/4294967296>>>0)>>>0,e[0][1]=T>>>0,T=e[1][1]+v,e[1][0]=e[1][0]+g+(T/4294967296>>>0)>>>0,e[1][1]=T>>>0,T=e[2][1]+C,e[2][0]=e[2][0]+m+(T/4294967296>>>0)>>>0,e[2][1]=T>>>0,T=e[3][1]+B,e[3][0]=e[3][0]+S+(T/4294967296>>>0)>>>0,e[3][1]=T>>>0,T=e[4][1]+L,e[4][0]=e[4][0]+R+(T/4294967296>>>0)>>>0,e[4][1]=T>>>0,T=e[5][1]+M,e[5][0]=e[5][0]+O+(T/4294967296>>>0)>>>0,e[5][1]=T>>>0,T=e[6][1]+q,e[6][0]=e[6][0]+U+(T/4294967296>>>0)>>>0,e[6][1]=T>>>0,T=e[7][1]+Z,e[7][0]=e[7][0]+z+(T/4294967296>>>0)>>>0,e[7][1]=T>>>0,F-=128}}});var x1={};Lt(x1,{noise:()=>y1,pureJsCrypto:()=>oi});function Ee(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function rt(e=0){return globalThis.Buffer?.alloc!=null?Ee(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function Bt(e=0){return globalThis.Buffer?.allocUnsafe!=null?Ee(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}var hu=Math.pow(2,7),lu=Math.pow(2,14),pu=Math.pow(2,21),Fi=Math.pow(2,28),Hi=Math.pow(2,35),qi=Math.pow(2,42),zi=Math.pow(2,49),ct=128,Vt=127;function Se(e){if(e<hu)return 1;if(e<lu)return 2;if(e<pu)return 3;if(e<Fi)return 4;if(e<Hi)return 5;if(e<qi)return 6;if(e<zi)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function du(e,t,r=0){switch(Se(e)){case 8:t[r++]=e&255|ct,e/=128;case 7:t[r++]=e&255|ct,e/=128;case 6:t[r++]=e&255|ct,e/=128;case 5:t[r++]=e&255|ct,e/=128;case 4:t[r++]=e&255|ct,e>>>=7;case 3:t[r++]=e&255|ct,e>>>=7;case 2:t[r++]=e&255|ct,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function yu(e,t,r=0){switch(Se(e)){case 8:t.set(r++,e&255|ct),e/=128;case 7:t.set(r++,e&255|ct),e/=128;case 6:t.set(r++,e&255|ct),e/=128;case 5:t.set(r++,e&255|ct),e/=128;case 4:t.set(r++,e&255|ct),e>>>=7;case 3:t.set(r++,e&255|ct),e>>>=7;case 2:t.set(r++,e&255|ct),e>>>=7;case 1:{t.set(r++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return t}function xu(e,t){let r=e[t],n=0;if(n+=r&Vt,r<ct||(r=e[t+1],n+=(r&Vt)<<7,r<ct)||(r=e[t+2],n+=(r&Vt)<<14,r<ct)||(r=e[t+3],n+=(r&Vt)<<21,r<ct)||(r=e[t+4],n+=(r&Vt)*Fi,r<ct)||(r=e[t+5],n+=(r&Vt)*Hi,r<ct)||(r=e[t+6],n+=(r&Vt)*qi,r<ct)||(r=e[t+7],n+=(r&Vt)*zi,r<ct))return n;throw new RangeError("Could not decode varint")}function gu(e,t){let r=e.get(t),n=0;if(n+=r&Vt,r<ct||(r=e.get(t+1),n+=(r&Vt)<<7,r<ct)||(r=e.get(t+2),n+=(r&Vt)<<14,r<ct)||(r=e.get(t+3),n+=(r&Vt)<<21,r<ct)||(r=e.get(t+4),n+=(r&Vt)*Fi,r<ct)||(r=e.get(t+5),n+=(r&Vt)*Hi,r<ct)||(r=e.get(t+6),n+=(r&Vt)*qi,r<ct)||(r=e.get(t+7),n+=(r&Vt)*zi,r<ct))return n;throw new RangeError("Could not decode varint")}function sa(e,t,r=0){return t==null&&(t=Bt(Se(e))),t instanceof Uint8Array?du(e,t,r):yu(e,t,r)}function Dn(e,t=0){return e instanceof Uint8Array?xu(e,t):gu(e,t)}function Zt(e,t){if(globalThis.Buffer!=null)return Ee(globalThis.Buffer.concat(e,t));t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=Bt(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return Ee(r)}function Rt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var aa=Symbol.for("@achingbrain/uint8arraylist");function oa(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function br(e){return!!e?.[aa]}var At=class e{bufs;length;[aa]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(br(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(br(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=oa(this.bufs,t);return r.buf[r.index]}set(t,r){let n=oa(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(br(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Zt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Zt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new e;return s.length=i,s.bufs=[...n],s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,c=a+o.byteLength;if(i=c,t>=c)continue;let f=t>=a&&t<c,u=r>a&&r<=c;if(f&&u){if(t===a&&r===c){n.push(o);break}let h=t-a;n.push(o.subarray(h,h+(r-t)));break}if(f){if(t===0){n.push(o);continue}n.push(o.subarray(t-a));continue}if(u){if(r===c){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!br(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=-1;for(let h=0;h<i;h++)o[n[h]]=h;let a=o,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let h=r;h<=c;h+=u){u=0;for(let l=f;l>=0;l--){let x=this.get(h+l);if(n[l]!==x){u=Math.max(1,l-a[x]);break}}if(u===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Bt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=rt(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=rt(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=rt(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Bt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=rt(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=rt(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=rt(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=rt(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=rt(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Rt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function Pn(e){return e[Symbol.asyncIterator]!=null}var kn=e=>{let t=Se(e),r=Bt(t);return sa(e,r),kn.bytes=t,r};kn.bytes=0;function Qr(e,t){t=t??{};let r=t.lengthEncoder??kn;function*n(i){let s=r(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}return Pn(e)?async function*(){for await(let i of e)yield*n(i)}():function*(){for(let i of e)yield*n(i)}()}Qr.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??kn;return new At(r(e.byteLength),e)};var vr=Gt(ua(),1);var bu=8,vu=1024*1024*4,Qe;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(Qe||(Qe={}));var Yi=e=>{let t=Dn(e);return Yi.bytes=Se(t),t};Yi.bytes=0;function Jr(e,t){let r=new At,n=Qe.LENGTH,i=-1,s=t?.lengthDecoder??Yi,o=t?.maxLengthLength??bu,a=t?.maxDataLength??vu;function*c(){for(;r.byteLength>0;){if(n===Qe.LENGTH)try{if(i=s(r),i<0)throw(0,vr.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,vr.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let f=s.bytes;r.consume(f),t?.onLength!=null&&t.onLength(i),n=Qe.DATA}catch(f){if(f instanceof RangeError){if(r.byteLength>o)throw(0,vr.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw f}if(n===Qe.DATA){if(r.byteLength<i)break;let f=r.sublist(0,i);r.consume(i),t?.onData!=null&&t.onData(f),yield f,n=Qe.LENGTH}}}return Pn(e)?async function*(){for await(let f of e)r.append(f),yield*c();if(r.byteLength>0)throw(0,vr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let f of e)r.append(f),yield*c();if(r.byteLength>0)throw(0,vr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Jr.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await e.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return Jr(n,{...t??{},onLength:s=>{r=s}})};function ne(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}var Un=class extends Error{type;code;constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.name="AbortError",this.code=r??"ABORT_ERR"}};async function ha(e,t,r){if(t==null)return e;if(t.aborted)return Promise.reject(new Un(r?.errorMessage,r?.errorCode));let n,i=new Un(r?.errorMessage,r?.errorCode);try{return await Promise.race([e,new Promise((s,o)=>{n=()=>{o(i)},t.addEventListener("abort",n)})])}finally{n!=null&&t.removeEventListener("abort",n)}}var Wi=class{needNext;haveNext;ended;nextResult;constructor(){this.ended=!1,this.needNext=ne(),this.needNext.resolve(),this.haveNext=ne()}[Symbol.asyncIterator](){return this}async next(){if(this.nextResult==null&&await this.haveNext.promise,this.nextResult==null)throw new Error("Have next but next was undefined");let t=this.nextResult;return this.nextResult=void 0,this.needNext.resolve(),this.needNext=ne(),t}async throw(t){return this.ended=!0,t!=null&&this.haveNext.reject(t),{done:!0,value:void 0}}async return(){let t={done:!0,value:void 0};return await this._push(void 0),t}async push(t,r){await this._push(t,r)}async end(t,r){t!=null?await this.throw(t):await this._push(void 0,r)}async _push(t,r){if(t!=null&&this.ended)throw new Error("Cannot push value onto an ended pushable");this.nextResult!=null&&await this.needNext.promise,t!=null?this.nextResult={done:!1,value:t}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=ne(),await ha(this.needNext.promise,r?.signal,r)}};function la(){return new Wi}var Kn=class extends Error{code;constructor(t,r){super(t),this.code=r}},$i=class extends Kn{type;constructor(t){super(t,"ABORT_ERR"),this.type="aborted"}};function pa(e,t){let r=la();e.sink(r).catch(async o=>{await r.end(o)}),e.sink=async o=>{for await(let a of o)await r.push(a);await r.end()};let n=e.source;e.source[Symbol.iterator]!=null?n=e.source[Symbol.iterator]():e.source[Symbol.asyncIterator]!=null&&(n=e.source[Symbol.asyncIterator]());let i=new At;return{read:async(o,a)=>{a?.signal?.throwIfAborted();let c,f=new Promise((u,h)=>{c=()=>{h(new $i("Read aborted"))},a?.signal?.addEventListener("abort",c)});try{if(o==null){let{done:h,value:l}=await Promise.race([n.next(),f]);return h===!0?new At:l}for(;i.byteLength<o;){let{value:h,done:l}=await Promise.race([n.next(),f]);if(l===!0)throw new Kn("unexpected end of input","ERR_UNEXPECTED_EOF");i.append(h)}let u=i.sublist(0,o);return i.consume(o),u}finally{c!=null&&a?.signal?.removeEventListener("abort",c)}},write:async(o,a)=>{a?.signal?.throwIfAborted(),o instanceof Uint8Array?await r.push(o,a):await r.push(o.subarray(),a)},unwrap:()=>{if(i.byteLength>0){let o=e.source;e.source=async function*(){t?.yieldBytes===!1?yield i:yield*i,yield*o}()}return e}}}var On=class extends Error{code;constructor(t,r){super(t),this.code=r}},da=e=>Dn(e);da.bytes=0;function Zi(e,t={}){let r=pa(e,t);return t.maxDataLength!=null&&t.maxLengthLength==null&&(t.maxLengthLength=Se(t.maxDataLength)),{read:async i=>{let s=-1,o=new At,a=t?.lengthDecoder??da;for(;;){o.append(await r.read(1,i));try{s=a(o)}catch(c){if(c instanceof RangeError)continue;throw c}if(t?.maxLengthLength!=null&&o.byteLength>t.maxLengthLength)throw new On("message length length too long","ERR_MSG_LENGTH_TOO_LONG");if(s>-1)break}if(t?.maxDataLength!=null&&s>t.maxDataLength)throw new On("message length too long","ERR_MSG_DATA_TOO_LONG");return r.read(s,i)},write:async(i,s)=>{await r.write(Qr.single(i,t),s)},writeV:async(i,s)=>{let o=new At(...i.map(a=>Qr.single(a,t)));await r.write(o,s)},unwrap:()=>r.unwrap()}}function Xi(){let e=ne(),t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){yield*await e.promise}()}}function ya(){let e=Xi(),t=Xi();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}var Mn=class{buffer;mask;top;btm;next;constructor(t){if(!(t>0)||t-1&t)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},wr=class{size;hwm;head;tail;constructor(t={}){this.hwm=t.splitLimit??16,this.head=new Mn(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new Mn(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};var Qi=class extends Error{type;code;constructor(t,r){super(t??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Vn(e={}){return Eu(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function Eu(e,t){t=t??{};let r=t.onEnd,n=new wr,i,s,o,a=ne(),c=async()=>{try{return n.isEmpty()?o?{done:!0}:await new Promise((y,g)=>{s=v=>{s=null,n.push(v);try{y(e(n))}catch(m){g(m)}return i}}):e(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=ne()})}},f=y=>s!=null?s(y):(n.push(y),i),u=y=>(n=new wr,s!=null?s({error:y}):(n.push({error:y}),i)),h=y=>{if(o)return i;if(t?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:y})},l=y=>o?i:(o=!0,y!=null?u(y):f({done:!0})),x=()=>(n=new wr,l(),{done:!0}),p=y=>(l(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:x,throw:p,push:h,end:l,get readableLength(){return n.size},onEmpty:async y=>{let g=y?.signal;if(g?.throwIfAborted(),n.isEmpty())return;let v,m;g!=null&&(v=new Promise((C,S)=>{m=()=>{S(new Qi)},g.addEventListener("abort",m)}));try{await Promise.race([a.promise,v])}finally{m!=null&&g!=null&&g?.removeEventListener("abort",m)}}},r==null)return i;let d=i;return i={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(y){return d.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return d.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(y){return d.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return d.readableLength},onEmpty:y=>d.onEmpty(y)},i}function Su(e){return e[Symbol.asyncIterator]!=null}function Bu(...e){let t=[];for(let r of e)Su(r)||t.push(r);return t.length===e.length?function*(){for(let r of t)yield*r}():async function*(){let r=Vn({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(e.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var xa=Bu;function ga(e,...t){if(e==null)throw new Error("Empty pipeline");if(Ji(e)){let n=e;e=()=>n.source}else if(ba(e)||ma(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&Ji(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)Ji(r[n])&&(r[n]=Cu(r[n]));return Au(...r)}var Au=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},ma=e=>e?.[Symbol.asyncIterator]!=null,ba=e=>e?.[Symbol.iterator]!=null,Ji=e=>e==null?!1:e.sink!=null&&e.source!=null,Cu=e=>t=>{let r=e.sink(t);if(r?.then!=null){let n=Vn({objectMode:!0});r.then(()=>{n.end()},o=>{n.end(o)});let i,s=e.source;if(ma(s))i=async function*(){yield*s,n.end()};else if(ba(s))i=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return xa(n,i())}return e.source};var Er=!!globalThis.process?.env?.DUMP_SESSION_KEYS;var Iu=e=>e instanceof Uint8Array;var Be=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),va=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Tu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Tu)throw new Error("Non little-endian hardware is not supported");function Fn(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Hn(e){if(typeof e=="string")e=Fn(e);else if(Iu(e))e=e.slice();else throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var _u=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function wa(e,t){if(t!==void 0&&(typeof t!="object"||!_u(t)))throw new Error("options must be object or undefined");return Object.assign(e,t)}function Je(e,t){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof t=="number"&&e.length!==t)throw new Error(`Uint8Array length ${t} expected`)}function Ea(e,t){if(e.length!==t.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<e.length;n++)r&&(r=e[n]===t[n]);return r}var ji=(e,t)=>(Object.assign(t,e),t);function ts(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+f,a,n)}function qn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function es(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function Sr(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function rs(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Sa(e,t){Sr(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Kt=(e,t)=>e[t++]&255|(e[t++]&255)<<8,ns=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Hn(t),Je(t,32);let r=Kt(t,0),n=Kt(t,2),i=Kt(t,4),s=Kt(t,6),o=Kt(t,8),a=Kt(t,10),c=Kt(t,12),f=Kt(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Kt(t,16+2*u)}process(t,r,n=!1){let i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],f=o[2],u=o[3],h=o[4],l=o[5],x=o[6],p=o[7],d=o[8],y=o[9],g=Kt(t,r+0),v=Kt(t,r+2),m=Kt(t,r+4),C=Kt(t,r+6),S=Kt(t,r+8),B=Kt(t,r+10),R=Kt(t,r+12),L=Kt(t,r+14),O=s[0]+(g&8191),M=s[1]+((g>>>13|v<<3)&8191),U=s[2]+((v>>>10|m<<6)&8191),q=s[3]+((m>>>7|C<<9)&8191),z=s[4]+((C>>>4|S<<12)&8191),Z=s[5]+(S>>>1&8191),A=s[6]+((S>>>14|B<<2)&8191),N=s[7]+((B>>>11|R<<5)&8191),T=s[8]+((R>>>8|L<<8)&8191),_=s[9]+(L>>>5|i),w=0,k=w+O*a+M*(5*y)+U*(5*d)+q*(5*p)+z*(5*x);w=k>>>13,k&=8191,k+=Z*(5*l)+A*(5*h)+N*(5*u)+T*(5*f)+_*(5*c),w+=k>>>13,k&=8191;let K=w+O*c+M*a+U*(5*y)+q*(5*d)+z*(5*p);w=K>>>13,K&=8191,K+=Z*(5*x)+A*(5*l)+N*(5*h)+T*(5*u)+_*(5*f),w+=K>>>13,K&=8191;let F=w+O*f+M*c+U*a+q*(5*y)+z*(5*d);w=F>>>13,F&=8191,F+=Z*(5*p)+A*(5*x)+N*(5*l)+T*(5*h)+_*(5*u),w+=F>>>13,F&=8191;let W=w+O*u+M*f+U*c+q*a+z*(5*y);w=W>>>13,W&=8191,W+=Z*(5*d)+A*(5*p)+N*(5*x)+T*(5*l)+_*(5*h),w+=W>>>13,W&=8191;let $=w+O*h+M*u+U*f+q*c+z*a;w=$>>>13,$&=8191,$+=Z*(5*y)+A*(5*d)+N*(5*p)+T*(5*x)+_*(5*l),w+=$>>>13,$&=8191;let et=w+O*l+M*h+U*u+q*f+z*c;w=et>>>13,et&=8191,et+=Z*a+A*(5*y)+N*(5*d)+T*(5*p)+_*(5*x),w+=et>>>13,et&=8191;let X=w+O*x+M*l+U*h+q*u+z*f;w=X>>>13,X&=8191,X+=Z*c+A*a+N*(5*y)+T*(5*d)+_*(5*p),w+=X>>>13,X&=8191;let J=w+O*p+M*x+U*l+q*h+z*u;w=J>>>13,J&=8191,J+=Z*f+A*c+N*a+T*(5*y)+_*(5*d),w+=J>>>13,J&=8191;let lt=w+O*d+M*p+U*x+q*l+z*h;w=lt>>>13,lt&=8191,lt+=Z*u+A*f+N*c+T*a+_*(5*y),w+=lt>>>13,lt&=8191;let ut=w+O*y+M*d+U*p+q*x+z*l;w=ut>>>13,ut&=8191,ut+=Z*h+A*u+N*f+T*c+_*a,w+=ut>>>13,ut&=8191,w=(w<<2)+w|0,w=w+k|0,k=w&8191,w=w>>>13,K+=w,s[0]=k,s[1]=K,s[2]=F,s[3]=W,s[4]=$,s[5]=et,s[6]=X,s[7]=J,s[8]=lt,s[9]=ut}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),i=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=i,i=t[a]>>>13,t[a]&=8191;t[0]+=i*5,i=t[0]>>>13,t[0]&=8191,t[1]+=i,i=t[1]>>>13,t[1]&=8191,t[2]+=i,n[0]=t[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=t[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)t[a]=t[a]&s|n[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+r[0];t[0]=o&65535;for(let a=1;a<8;a++)o=(t[a]+r[a]|0)+(o>>>16)|0,t[a]=o&65535}update(t){rs(this);let{buffer:r,blockLen:n}=this;t=Hn(t);let i=t.length;for(let s=0;s<i;){let o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(t,s);continue}r.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){rs(this),Sa(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)t[s++]=n[o]>>>0,t[s++]=n[o]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};function Lu(e){let t=(n,i)=>e(i).update(Hn(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}var Ba=Lu(e=>new ns(e));var Ru=Fn("expand 16-byte k"),Nu=Fn("expand 32-byte k"),Du=Be(Ru),Pu=Be(Nu);function G(e,t){return e<<t|e>>>32-t}function is(e){return e.byteOffset%4===0}var zn=64,ku=16,Ca=2**32-1,Aa=new Uint32Array;function Uu(e,t,r,n,i,s,o,a){let c=i.length,f=new Uint8Array(zn),u=Be(f),h=is(i)&&is(s),l=h?Be(i):Aa,x=h?Be(s):Aa;for(let p=0;p<c;o++){if(e(t,r,n,u,o,a),o>=Ca)throw new Error("arx: counter overflow");let d=Math.min(zn,c-p);if(h&&d===zn){let y=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let g=0,v;g<ku;g++)v=y+g,x[v]=l[v]^u[g];p+=zn;continue}for(let y=0,g;y<d;y++)g=p+y,s[g]=i[g]^f[y];p+=d}}function ss(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=wa({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return qn(i),qn(o),es(s),es(r),(a,c,f,u,h=0)=>{Sr(a),Sr(c),Sr(f);let l=f.length;if(u||(u=new Uint8Array(l)),Sr(u),qn(h),h<0||h>=Ca)throw new Error("arx: counter overflow");if(u.length<l)throw new Error(`arx: output (${u.length}) is shorter than data (${l})`);let x=[],p=a.length,d,y;if(p===32)d=a.slice(),x.push(d),y=Pu;else if(p===16&&r)d=new Uint8Array(32),d.set(a),d.set(a,16),y=Du,x.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);is(c)||(c=c.slice(),x.push(c));let g=Be(d);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(y,g,Be(c.subarray(0,16)),g),c=c.subarray(16)}let v=16-i;if(v!==c.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(v!==12){let C=new Uint8Array(12);C.set(c,s?0:12-c.length),c=C,x.push(c)}let m=Be(c);for(Uu(e,y,g,m,f,u,h,o);x.length>0;)x.pop().fill(0);return u}}function _a(e,t,r,n,i,s=20){let o=e[0],a=e[1],c=e[2],f=e[3],u=t[0],h=t[1],l=t[2],x=t[3],p=t[4],d=t[5],y=t[6],g=t[7],v=i,m=r[0],C=r[1],S=r[2],B=o,R=a,L=c,O=f,M=u,U=h,q=l,z=x,Z=p,A=d,N=y,T=g,_=v,w=m,k=C,K=S;for(let W=0;W<s;W+=2)B=B+M|0,_=G(_^B,16),Z=Z+_|0,M=G(M^Z,12),B=B+M|0,_=G(_^B,8),Z=Z+_|0,M=G(M^Z,7),R=R+U|0,w=G(w^R,16),A=A+w|0,U=G(U^A,12),R=R+U|0,w=G(w^R,8),A=A+w|0,U=G(U^A,7),L=L+q|0,k=G(k^L,16),N=N+k|0,q=G(q^N,12),L=L+q|0,k=G(k^L,8),N=N+k|0,q=G(q^N,7),O=O+z|0,K=G(K^O,16),T=T+K|0,z=G(z^T,12),O=O+z|0,K=G(K^O,8),T=T+K|0,z=G(z^T,7),B=B+U|0,K=G(K^B,16),N=N+K|0,U=G(U^N,12),B=B+U|0,K=G(K^B,8),N=N+K|0,U=G(U^N,7),R=R+q|0,_=G(_^R,16),T=T+_|0,q=G(q^T,12),R=R+q|0,_=G(_^R,8),T=T+_|0,q=G(q^T,7),L=L+z|0,w=G(w^L,16),Z=Z+w|0,z=G(z^Z,12),L=L+z|0,w=G(w^L,8),Z=Z+w|0,z=G(z^Z,7),O=O+M|0,k=G(k^O,16),A=A+k|0,M=G(M^A,12),O=O+M|0,k=G(k^O,8),A=A+k|0,M=G(M^A,7);let F=0;n[F++]=o+B|0,n[F++]=a+R|0,n[F++]=c+L|0,n[F++]=f+O|0,n[F++]=u+M|0,n[F++]=h+U|0,n[F++]=l+q|0,n[F++]=x+z|0,n[F++]=p+Z|0,n[F++]=d+A|0,n[F++]=y+N|0,n[F++]=g+T|0,n[F++]=v+_|0,n[F++]=m+w|0,n[F++]=C+k|0,n[F++]=S+K|0}function Ku(e,t,r,n){let i=e[0],s=e[1],o=e[2],a=e[3],c=t[0],f=t[1],u=t[2],h=t[3],l=t[4],x=t[5],p=t[6],d=t[7],y=r[0],g=r[1],v=r[2],m=r[3];for(let S=0;S<20;S+=2)i=i+c|0,y=G(y^i,16),l=l+y|0,c=G(c^l,12),i=i+c|0,y=G(y^i,8),l=l+y|0,c=G(c^l,7),s=s+f|0,g=G(g^s,16),x=x+g|0,f=G(f^x,12),s=s+f|0,g=G(g^s,8),x=x+g|0,f=G(f^x,7),o=o+u|0,v=G(v^o,16),p=p+v|0,u=G(u^p,12),o=o+u|0,v=G(v^o,8),p=p+v|0,u=G(u^p,7),a=a+h|0,m=G(m^a,16),d=d+m|0,h=G(h^d,12),a=a+h|0,m=G(m^a,8),d=d+m|0,h=G(h^d,7),i=i+f|0,m=G(m^i,16),p=p+m|0,f=G(f^p,12),i=i+f|0,m=G(m^i,8),p=p+m|0,f=G(f^p,7),s=s+u|0,y=G(y^s,16),d=d+y|0,u=G(u^d,12),s=s+u|0,y=G(y^s,8),d=d+y|0,u=G(u^d,7),o=o+h|0,g=G(g^o,16),l=l+g|0,h=G(h^l,12),o=o+h|0,g=G(g^o,8),l=l+g|0,h=G(h^l,7),a=a+c|0,v=G(v^a,16),x=x+v|0,c=G(c^x,12),a=a+c|0,v=G(v^a,8),x=x+v|0,c=G(c^x,7);let C=0;n[C++]=i,n[C++]=s,n[C++]=o,n[C++]=a,n[C++]=y,n[C++]=g,n[C++]=v,n[C++]=m}var Ou=ss(_a,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Mu=ss(_a,{counterRight:!1,counterLength:8,extendNonceFn:Ku,allowShortKeys:!1});var Vu=new Uint8Array(16),Ia=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(Vu.subarray(r))},Fu=new Uint8Array(32);function Ta(e,t,r,n,i){let s=e(t,r,Fu),o=Ba.create(s);i&&Ia(o,i),Ia(o,n);let a=new Uint8Array(16),c=va(a);ts(c,0,BigInt(i?i.length:0),!0),ts(c,8,BigInt(n.length),!0),o.update(a);let f=o.digest();return s.fill(0),f}var La=e=>(t,r,n)=>(Je(t,32),Je(r),{encrypt:(s,o)=>{let a=s.length,c=a+16;o?Je(o,c):o=new Uint8Array(c),e(t,r,s,o,1);let f=Ta(e,t,r,o.subarray(0,-16),n);return o.set(f,a),o},decrypt:(s,o)=>{let a=s.length,c=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");o?Je(o,c):o=new Uint8Array(c);let f=s.subarray(0,-16),u=s.subarray(-16),h=Ta(e,t,r,f,n);if(!Ea(u,h))throw new Error("invalid tag");return e(t,r,f,o,1),o}}),os=ji({blockSize:64,nonceLength:12,tagLength:16},La(Ou)),Bx=ji({blockSize:64,nonceLength:24,tagLength:16},La(Mu));function Gn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function as(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function jr(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Gn(e.outputLen),Gn(e.blockLen)}function Br(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ra(e,t){as(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Yn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Na=e=>e instanceof Uint8Array;var Wn=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ie=(e,t)=>e<<32-t|e>>>t,Hu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Hu)throw new Error("Non little-endian hardware is not supported");function cs(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Ke(e){if(typeof e=="string"&&(e=cs(e)),!Na(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function $n(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Na(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var Ar=class{clone(){return this._cloneInto()}},_x={}.toString;function Zn(e){let t=n=>e().update(Ke(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function je(e=32){if(Yn&&typeof Yn.getRandomValues=="function")return Yn.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function qu(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+f,a,n)}var Cr=class extends Ar{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Wn(this.buffer)}update(t){Br(this);let{view:r,buffer:n,blockLen:i}=this;t=Ke(t);let s=t.length;for(let o=0;o<s;){let a=Math.min(i-this.pos,s-o);if(a===i){let c=Wn(t);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Br(this),Ra(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let h=o;h<i;h++)r[h]=0;qu(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=Wn(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<f;h++)a.setUint32(4*h,u[h],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};var Xn=BigInt(4294967295),fs=BigInt(32);function Da(e,t=!1){return t?{h:Number(e&Xn),l:Number(e>>fs&Xn)}:{h:Number(e>>fs&Xn)|0,l:Number(e&Xn)|0}}function zu(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=Da(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}var Gu=(e,t)=>BigInt(e>>>0)<<fs|BigInt(t>>>0),Yu=(e,t,r)=>e>>>r,Wu=(e,t,r)=>e<<32-r|t>>>r,$u=(e,t,r)=>e>>>r|t<<32-r,Zu=(e,t,r)=>e<<32-r|t>>>r,Xu=(e,t,r)=>e<<64-r|t>>>r-32,Qu=(e,t,r)=>e>>>r-32|t<<64-r,Ju=(e,t)=>t,ju=(e,t)=>e,th=(e,t,r)=>e<<r|t>>>32-r,eh=(e,t,r)=>t<<r|e>>>32-r,rh=(e,t,r)=>t<<r-32|e>>>64-r,nh=(e,t,r)=>e<<r-32|t>>>64-r;function ih(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}var sh=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),oh=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,ah=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),ch=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,fh=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),uh=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;var hh={fromBig:Da,split:zu,toBig:Gu,shrSH:Yu,shrSL:Wu,rotrSH:$u,rotrSL:Zu,rotrBH:Xu,rotrBL:Qu,rotr32H:Ju,rotr32L:ju,rotlSH:th,rotlSL:eh,rotlBH:rh,rotlBL:nh,add:ih,add3L:sh,add3H:oh,add4L:ah,add4H:ch,add5H:uh,add5L:fh},j=hh;var[lh,ph]=j.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Oe=new Uint32Array(80),Me=new Uint32Array(80),us=class extends Cr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:f,El:u,Fh:h,Fl:l,Gh:x,Gl:p,Hh:d,Hl:y}=this;return[t,r,n,i,s,o,a,c,f,u,h,l,x,p,d,y]}set(t,r,n,i,s,o,a,c,f,u,h,l,x,p,d,y){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=x|0,this.Gl=p|0,this.Hh=d|0,this.Hl=y|0}process(t,r){for(let m=0;m<16;m++,r+=4)Oe[m]=t.getUint32(r),Me[m]=t.getUint32(r+=4);for(let m=16;m<80;m++){let C=Oe[m-15]|0,S=Me[m-15]|0,B=j.rotrSH(C,S,1)^j.rotrSH(C,S,8)^j.shrSH(C,S,7),R=j.rotrSL(C,S,1)^j.rotrSL(C,S,8)^j.shrSL(C,S,7),L=Oe[m-2]|0,O=Me[m-2]|0,M=j.rotrSH(L,O,19)^j.rotrBH(L,O,61)^j.shrSH(L,O,6),U=j.rotrSL(L,O,19)^j.rotrBL(L,O,61)^j.shrSL(L,O,6),q=j.add4L(R,U,Me[m-7],Me[m-16]),z=j.add4H(q,B,M,Oe[m-7],Oe[m-16]);Oe[m]=z|0,Me[m]=q|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:h,El:l,Fh:x,Fl:p,Gh:d,Gl:y,Hh:g,Hl:v}=this;for(let m=0;m<80;m++){let C=j.rotrSH(h,l,14)^j.rotrSH(h,l,18)^j.rotrBH(h,l,41),S=j.rotrSL(h,l,14)^j.rotrSL(h,l,18)^j.rotrBL(h,l,41),B=h&x^~h&d,R=l&p^~l&y,L=j.add5L(v,S,R,ph[m],Me[m]),O=j.add5H(L,g,C,B,lh[m],Oe[m]),M=L|0,U=j.rotrSH(n,i,28)^j.rotrBH(n,i,34)^j.rotrBH(n,i,39),q=j.rotrSL(n,i,28)^j.rotrBL(n,i,34)^j.rotrBL(n,i,39),z=n&s^n&a^s&a,Z=i&o^i&c^o&c;g=d|0,v=y|0,d=x|0,y=p|0,x=h|0,p=l|0,{h,l}=j.add(f|0,u|0,O|0,M|0),f=a|0,u=c|0,a=s|0,c=o|0,s=n|0,o=i|0;let A=j.add3L(M,q,Z);n=j.add3H(A,O,U,z),i=A|0}({h:n,l:i}=j.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=j.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=j.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=j.add(this.Dh|0,this.Dl|0,f|0,u|0),{h,l}=j.add(this.Eh|0,this.El|0,h|0,l|0),{h:x,l:p}=j.add(this.Fh|0,this.Fl|0,x|0,p|0),{h:d,l:y}=j.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:g,l:v}=j.add(this.Hh|0,this.Hl|0,g|0,v|0),this.set(n,i,s,o,a,c,f,u,h,l,x,p,d,y,g,v)}roundClean(){Oe.fill(0),Me.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var hs=Zn(()=>new us);var jn={};Lt(jn,{bitGet:()=>vh,bitLen:()=>bh,bitMask:()=>tn,bitSet:()=>wh,bytesToHex:()=>Ae,bytesToNumberBE:()=>Ce,bytesToNumberLE:()=>se,concatBytes:()=>Te,createHmacDrbg:()=>ds,ensureBytes:()=>yt,equalBytes:()=>gh,hexToBytes:()=>tr,hexToNumber:()=>ps,numberToBytesBE:()=>Ve,numberToBytesLE:()=>Ie,numberToHexUnpadded:()=>Ua,numberToVarBytesBE:()=>xh,utf8ToBytes:()=>mh,validateObject:()=>Jt});var ka=BigInt(0),Qn=BigInt(1),dh=BigInt(2),Jn=e=>e instanceof Uint8Array,yh=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ae(e){if(!Jn(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=yh[e[r]];return t}function Ua(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function ps(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function tr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){let i=n*2,s=e.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function Ce(e){return ps(Ae(e))}function se(e){if(!Jn(e))throw new Error("Uint8Array expected");return ps(Ae(Uint8Array.from(e).reverse()))}function Ve(e,t){return tr(e.toString(16).padStart(t*2,"0"))}function Ie(e,t){return Ve(e,t).reverse()}function xh(e){return tr(Ua(e))}function yt(e,t,r){let n;if(typeof t=="string")try{n=tr(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Jn(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}function Te(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!Jn(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function gh(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function mh(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function bh(e){let t;for(t=0;e>ka;e>>=Qn,t+=1);return t}function vh(e,t){return e>>BigInt(t)&Qn}var wh=(e,t,r)=>e|(r?Qn:ka)<<BigInt(t),tn=e=>(dh<<BigInt(e-1))-Qn,ls=e=>new Uint8Array(e),Pa=e=>Uint8Array.from(e);function ds(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ls(e),i=ls(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...h)=>r(i,n,...h),c=(h=ls())=>{i=a(Pa([0]),h),n=a(),h.length!==0&&(i=a(Pa([1]),h),n=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<t;){n=a();let x=n.slice();l.push(x),h+=n.length}return Te(...l)};return(h,l)=>{o(),c(h);let x;for(;!(x=l(f()));)c();return o(),x}}var Eh={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Jt(e,t,r={}){let n=(i,s,o)=>{let a=Eh[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=e[i];if(!(o&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}var _t=BigInt(0),bt=BigInt(1),er=BigInt(2),Sh=BigInt(3),ys=BigInt(4),Ka=BigInt(5),Oa=BigInt(8),Bh=BigInt(9),Ah=BigInt(16);function at(e,t){let r=e%t;return r>=_t?r:t+r}function xs(e,t,r){if(r<=_t||t<_t)throw new Error("Expected power/modulo > 0");if(r===bt)return _t;let n=bt;for(;t>_t;)t&bt&&(n=n*e%r),e=e*e%r,t>>=bt;return n}function xt(e,t,r){let n=e;for(;t-- >_t;)n*=n,n%=r;return n}function ti(e,t){if(e===_t||t<=_t)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=at(e,t),n=t,i=_t,s=bt,o=bt,a=_t;for(;r!==_t;){let f=n/r,u=n%r,h=i-o*f,l=s-a*f;n=r,r=u,i=o,s=a,o=h,a=l}if(n!==bt)throw new Error("invert: does not exist");return at(i,t)}function Ch(e){let t=(e-bt)/er,r,n,i;for(r=e-bt,n=0;r%er===_t;r/=er,n++);for(i=er;i<e&&xs(i,t,e)!==e-bt;i++);if(n===1){let o=(e+bt)/ys;return function(c,f){let u=c.pow(f,o);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(r+bt)/er;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(c,s),l=a.pow(c,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let x=1;for(let d=a.sqr(l);x<f&&!a.eql(d,a.ONE);x++)d=a.sqr(d);let p=a.pow(u,bt<<BigInt(f-x-1));u=a.sqr(p),h=a.mul(h,p),l=a.mul(l,u),f=x}return h}}function Ih(e){if(e%ys===Sh){let t=(e+bt)/ys;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%Oa===Ka){let t=(e-Ka)/Oa;return function(n,i){let s=n.mul(i,er),o=n.pow(s,t),a=n.mul(i,o),c=n.mul(n.mul(a,er),o),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return e%Ah,Ch(e)}var Ma=(e,t)=>(at(e,t)&bt)===bt,Th=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function gs(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Th.reduce((n,i)=>(n[i]="function",n),t);return Jt(e,r)}function _h(e,t,r){if(r<_t)throw new Error("Expected power > 0");if(r===_t)return e.ONE;if(r===bt)return t;let n=e.ONE,i=t;for(;r>_t;)r&bt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=bt;return n}function Lh(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}function ms(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ei(e,t,r=!1,n={}){if(e<=_t)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=ms(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=Ih(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:tn(i),ZERO:_t,ONE:bt,create:c=>at(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return _t<=c&&c<e},is0:c=>c===_t,isOdd:c=>(c&bt)===bt,neg:c=>at(-c,e),eql:(c,f)=>c===f,sqr:c=>at(c*c,e),add:(c,f)=>at(c+f,e),sub:(c,f)=>at(c-f,e),mul:(c,f)=>at(c*f,e),pow:(c,f)=>_h(a,c,f),div:(c,f)=>at(c*ti(f,e),e),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>ti(c,e),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Lh(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?Ie(c,s):Ve(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?se(c):Ce(c)}});return Object.freeze(a)}function Va(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}function Fa(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function bs(e){let t=Fa(e);return t+Math.ceil(t/2)}function Ha(e,t,r=!1){let n=e.length,i=Fa(t),s=bs(t);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);let o=r?Ce(e):se(e),a=at(o,t-bt)+bt;return r?Ie(a,i):Ve(a,i)}var Nh=BigInt(0),vs=BigInt(1);function ri(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>Nh;)s&vs&&(o=o.add(a)),a=a.double(),s>>=vs;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),c=[],f=i,u=f;for(let h=0;h<o;h++){u=f,c.push(u);for(let l=1;l<a;l++)u=u.add(f),c.push(u);f=u.double()}return c},wNAF(i,s,o){let{windows:a,windowSize:c}=n(i),f=e.ZERO,u=e.BASE,h=BigInt(2**i-1),l=2**i,x=BigInt(i);for(let p=0;p<a;p++){let d=p*c,y=Number(o&h);o>>=x,y>c&&(y-=l,o+=vs);let g=d,v=d+Math.abs(y)-1,m=p%2!==0,C=y<0;y===0?u=u.add(r(m,s[g])):f=f.add(r(C,s[v]))}return{p:f,f:u}},wNAFCached(i,s,o,a){let c=i._WINDOW_SIZE||1,f=s.get(i);return f||(f=this.precomputeWindow(i,c),c!==1&&s.set(i,a(f))),this.wNAF(c,f,o)}}}function en(e){return gs(e.Fp),Jt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ms(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var oe=BigInt(0),Xt=BigInt(1),ni=BigInt(2),Dh=BigInt(8),Ph={zip215:!0};function kh(e){let t=en(e);return Jt(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function ii(e){let t=kh(e),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=t,f=ni<<BigInt(a*8)-Xt,u=r.create,h=t.uvRatio||((_,w)=>{try{return{isValid:!0,value:r.sqrt(_*r.inv(w))}}catch{return{isValid:!1,value:oe}}}),l=t.adjustScalarBytes||(_=>_),x=t.domain||((_,w,k)=>{if(w.length||k)throw new Error("Contexts/pre-hash are not supported");return _}),p=_=>typeof _=="bigint"&&oe<_,d=(_,w)=>p(_)&&p(w)&&_<w,y=_=>_===oe||d(_,f);function g(_,w){if(d(_,w))return _;throw new Error(`Expected valid scalar < ${w}, got ${typeof _} ${_}`)}function v(_){return _===oe?_:g(_,n)}let m=new Map;function C(_){if(!(_ instanceof S))throw new Error("ExtendedPoint expected")}class S{constructor(w,k,K,F){if(this.ex=w,this.ey=k,this.ez=K,this.et=F,!y(w))throw new Error("x required");if(!y(k))throw new Error("y required");if(!y(K))throw new Error("z required");if(!y(F))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(w){if(w instanceof S)throw new Error("extended point not allowed");let{x:k,y:K}=w||{};if(!y(k)||!y(K))throw new Error("invalid affine point");return new S(k,K,Xt,u(k*K))}static normalizeZ(w){let k=r.invertBatch(w.map(K=>K.ez));return w.map((K,F)=>K.toAffine(k[F])).map(S.fromAffine)}_setWindowSize(w){this._WINDOW_SIZE=w,m.delete(this)}assertValidity(){let{a:w,d:k}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:K,ey:F,ez:W,et:$}=this,et=u(K*K),X=u(F*F),J=u(W*W),lt=u(J*J),ut=u(et*w),kt=u(J*u(ut+X)),Ut=u(lt+u(k*u(et*X)));if(kt!==Ut)throw new Error("bad point: equation left != right (1)");let Tt=u(K*F),Mt=u(W*$);if(Tt!==Mt)throw new Error("bad point: equation left != right (2)")}equals(w){C(w);let{ex:k,ey:K,ez:F}=this,{ex:W,ey:$,ez:et}=w,X=u(k*et),J=u(W*F),lt=u(K*et),ut=u($*F);return X===J&&lt===ut}is0(){return this.equals(S.ZERO)}negate(){return new S(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:w}=t,{ex:k,ey:K,ez:F}=this,W=u(k*k),$=u(K*K),et=u(ni*u(F*F)),X=u(w*W),J=k+K,lt=u(u(J*J)-W-$),ut=X+$,kt=ut-et,Ut=X-$,Tt=u(lt*kt),Mt=u(ut*Ut),we=u(lt*Ut),Xe=u(kt*ut);return new S(Tt,Mt,Xe,we)}add(w){C(w);let{a:k,d:K}=t,{ex:F,ey:W,ez:$,et}=this,{ex:X,ey:J,ez:lt,et:ut}=w;if(k===BigInt(-1)){let Qo=u((W-F)*(J+X)),Jo=u((W+F)*(J-X)),Vi=u(Jo-Qo);if(Vi===oe)return this.double();let jo=u($*ni*ut),ta=u(et*ni*lt),ea=ta+jo,ra=Jo+Qo,na=ta-jo,eu=u(ea*Vi),ru=u(ra*na),nu=u(ea*na),iu=u(Vi*ra);return new S(eu,ru,iu,nu)}let kt=u(F*X),Ut=u(W*J),Tt=u(et*K*ut),Mt=u($*lt),we=u((F+W)*(X+J)-kt-Ut),Xe=Mt-Tt,Xr=Mt+Tt,Xo=u(Ut-k*kt),Qf=u(we*Xe),Jf=u(Xr*Xo),jf=u(we*Xo),tu=u(Xe*Xr);return new S(Qf,Jf,tu,jf)}subtract(w){return this.add(w.negate())}wNAF(w){return L.wNAFCached(this,m,w,S.normalizeZ)}multiply(w){let{p:k,f:K}=this.wNAF(g(w,n));return S.normalizeZ([k,K])[0]}multiplyUnsafe(w){let k=v(w);return k===oe?R:this.equals(R)||k===Xt?this:this.equals(B)?this.wNAF(k).p:L.unsafeLadder(this,k)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return L.unsafeLadder(this,n).is0()}toAffine(w){let{ex:k,ey:K,ez:F}=this,W=this.is0();w==null&&(w=W?Dh:r.inv(F));let $=u(k*w),et=u(K*w),X=u(F*w);if(W)return{x:oe,y:Xt};if(X!==Xt)throw new Error("invZ was invalid");return{x:$,y:et}}clearCofactor(){let{h:w}=t;return w===Xt?this:this.multiplyUnsafe(w)}static fromHex(w,k=!1){let{d:K,a:F}=t,W=r.BYTES;w=yt("pointHex",w,W);let $=w.slice(),et=w[W-1];$[W-1]=et&-129;let X=se($);X===oe||(k?g(X,f):g(X,r.ORDER));let J=u(X*X),lt=u(J-Xt),ut=u(K*J-F),{isValid:kt,value:Ut}=h(lt,ut);if(!kt)throw new Error("Point.fromHex: invalid y coordinate");let Tt=(Ut&Xt)===Xt,Mt=(et&128)!==0;if(!k&&Ut===oe&&Mt)throw new Error("Point.fromHex: x=0 and x_0=1");return Mt!==Tt&&(Ut=u(-Ut)),S.fromAffine({x:Ut,y:X})}static fromPrivateKey(w){return U(w).point}toRawBytes(){let{x:w,y:k}=this.toAffine(),K=Ie(k,r.BYTES);return K[K.length-1]|=w&Xt?128:0,K}toHex(){return Ae(this.toRawBytes())}}S.BASE=new S(t.Gx,t.Gy,Xt,u(t.Gx*t.Gy)),S.ZERO=new S(oe,Xt,Xt,oe);let{BASE:B,ZERO:R}=S,L=ri(S,a*8);function O(_){return at(_,n)}function M(_){return O(se(_))}function U(_){let w=a;_=yt("private key",_,w);let k=yt("hashed private key",s(_),2*w),K=l(k.slice(0,w)),F=k.slice(w,2*w),W=M(K),$=B.multiply(W),et=$.toRawBytes();return{head:K,prefix:F,scalar:W,point:$,pointBytes:et}}function q(_){return U(_).pointBytes}function z(_=new Uint8Array,...w){let k=Te(...w);return M(s(x(k,yt("context",_),!!i)))}function Z(_,w,k={}){_=yt("message",_),i&&(_=i(_));let{prefix:K,scalar:F,pointBytes:W}=U(w),$=z(k.context,K,_),et=B.multiply($).toRawBytes(),X=z(k.context,et,W,_),J=O($+X*F);v(J);let lt=Te(et,Ie(J,r.BYTES));return yt("result",lt,a*2)}let A=Ph;function N(_,w,k,K=A){let{context:F,zip215:W}=K,$=r.BYTES;_=yt("signature",_,2*$),w=yt("message",w),i&&(w=i(w));let et=se(_.slice($,2*$)),X,J,lt;try{X=S.fromHex(k,W),J=S.fromHex(_.slice(0,$),W),lt=B.multiplyUnsafe(et)}catch{return!1}if(!W&&X.isSmallOrder())return!1;let ut=z(F,J.toRawBytes(),X.toRawBytes(),w);return J.add(X.multiplyUnsafe(ut)).subtract(lt).clearCofactor().equals(S.ZERO)}return B._setWindowSize(8),{CURVE:t,getPublicKey:q,sign:Z,verify:N,ExtendedPoint:S,utils:{getExtendedPublicKey:U,randomPrivateKey:()=>o(r.BYTES),precompute(_=8,w=S.BASE){return w._setWindowSize(_),w.multiply(BigInt(3)),w}}}}var rn=BigInt(0),ws=BigInt(1);function Uh(e){return Jt(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function qa(e){let t=Uh(e),{P:r}=t,n=m=>at(m,r),i=t.montgomeryBits,s=Math.ceil(i/8),o=t.nByteLength,a=t.adjustScalarBytes||(m=>m),c=t.powPminus2||(m=>xs(m,r-BigInt(2),r));function f(m,C,S){let B=n(m*(C-S));return C=n(C-B),S=n(S+B),[C,S]}function u(m){if(typeof m=="bigint"&&rn<=m&&m<r)return m;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(t.a-BigInt(2))/BigInt(4);function l(m,C){let S=u(m),B=u(C),R=S,L=ws,O=rn,M=S,U=ws,q=rn,z;for(let A=BigInt(i-1);A>=rn;A--){let N=B>>A&ws;q^=N,z=f(q,L,M),L=z[0],M=z[1],z=f(q,O,U),O=z[0],U=z[1],q=N;let T=L+O,_=n(T*T),w=L-O,k=n(w*w),K=_-k,F=M+U,W=M-U,$=n(W*T),et=n(F*w),X=$+et,J=$-et;M=n(X*X),U=n(R*n(J*J)),L=n(_*k),O=n(K*(_+n(h*K)))}z=f(q,L,M),L=z[0],M=z[1],z=f(q,O,U),O=z[0],U=z[1];let Z=c(O);return n(L*Z)}function x(m){return Ie(n(m),s)}function p(m){let C=yt("u coordinate",m,s);return o===s&&(C[o-1]&=127),se(C)}function d(m){let C=yt("scalar",m);if(C.length!==s&&C.length!==o)throw new Error(`Expected ${s} or ${o} bytes, got ${C.length}`);return se(a(C))}function y(m,C){let S=p(C),B=d(m),R=l(S,B);if(R===rn)throw new Error("Invalid private or public key received");return x(R)}let g=x(t.Gu);function v(m){return y(m,g)}return{scalarMult:y,scalarMultBase:v,getSharedSecret:(m,C)=>y(m,C),getPublicKey:m=>v(m),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:g}}var nn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),za=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),eg=BigInt(0),Kh=BigInt(1),Es=BigInt(2),Oh=BigInt(5),Ga=BigInt(10),Mh=BigInt(20),Vh=BigInt(40),Ya=BigInt(80);function Wa(e){let t=nn,n=e*e%t*e%t,i=xt(n,Es,t)*n%t,s=xt(i,Kh,t)*e%t,o=xt(s,Oh,t)*s%t,a=xt(o,Ga,t)*o%t,c=xt(a,Mh,t)*a%t,f=xt(c,Vh,t)*c%t,u=xt(f,Ya,t)*f%t,h=xt(u,Ya,t)*f%t,l=xt(h,Ga,t)*o%t;return{pow_p_5_8:xt(l,Es,t)*e%t,b2:n}}function $a(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Fh(e,t){let r=nn,n=at(t*t*t,r),i=at(n*n*t,r),s=Wa(e*i).pow_p_5_8,o=at(e*n*s,r),a=at(t*o*o,r),c=o,f=at(o*za,r),u=a===e,h=a===at(-e,r),l=a===at(-e*za,r);return u&&(o=c),(h||l)&&(o=f),Ma(o,r)&&(o=at(-o,r)),{isValid:u||h,value:o}}var _e=ei(nn,void 0,!0),Ss={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:_e,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:hs,randomBytes:je,adjustScalarBytes:$a,uvRatio:Fh},Ir=ii(Ss);function Za(e,t,r){if(t.length>255)throw new Error("Context is too big");return $n(cs("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}var rg=ii({...Ss,domain:Za}),ng=ii({...Ss,domain:Za,prehash:hs}),sn=qa({P:nn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=nn,{pow_p_5_8:r,b2:n}=Wa(e);return at(xt(r,BigInt(3),t)*n,t)},adjustScalarBytes:$a,randomBytes:je});var Hh=(_e.ORDER+BigInt(3))/BigInt(8),ig=_e.pow(Es,Hh),sg=_e.sqrt(_e.neg(_e.ONE)),og=(_e.ORDER-BigInt(5))/BigInt(8),ag=BigInt(486662);var cg=Va(_e,_e.neg(BigInt(486664)));var fg=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),ug=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),hg=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),lg=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var pg=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var si=class extends Ar{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,jr(t);let n=Ke(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){return Br(this),this.iHash.update(t),this}digestInto(t){Br(this),as(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Tr=(e,t,r)=>new si(e,t).update(r).digest();Tr.create=(e,t)=>new si(e,t);function Qa(e,t,r){return jr(e),r===void 0&&(r=new Uint8Array(e.outputLen)),Tr(e,Ke(r),Ke(t))}var Bs=new Uint8Array([0]),Xa=new Uint8Array;function Ja(e,t,r,n=32){if(jr(e),Gn(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/e.outputLen);r===void 0&&(r=Xa);let s=new Uint8Array(i*e.outputLen),o=Tr.create(e,t),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let f=0;f<i;f++)Bs[0]=f+1,a.update(f===0?Xa:c).update(r).update(Bs).digestInto(c),s.set(c,e.outputLen*f),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Bs.fill(0),s.slice(0,n)}var qh=(e,t,r)=>e&t^~e&r,zh=(e,t,r)=>e&t^e&r^t&r,Gh=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Fe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),He=new Uint32Array(64),As=class extends Cr{constructor(){super(64,32,8,!1),this.A=Fe[0]|0,this.B=Fe[1]|0,this.C=Fe[2]|0,this.D=Fe[3]|0,this.E=Fe[4]|0,this.F=Fe[5]|0,this.G=Fe[6]|0,this.H=Fe[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[t,r,n,i,s,o,a,c]}set(t,r,n,i,s,o,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,r){for(let h=0;h<16;h++,r+=4)He[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let l=He[h-15],x=He[h-2],p=ie(l,7)^ie(l,18)^l>>>3,d=ie(x,17)^ie(x,19)^x>>>10;He[h]=d+He[h-7]+p+He[h-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:f,H:u}=this;for(let h=0;h<64;h++){let l=ie(a,6)^ie(a,11)^ie(a,25),x=u+l+qh(a,c,f)+Gh[h]+He[h]|0,d=(ie(n,2)^ie(n,13)^ie(n,22))+zh(n,i,s)|0;u=f,f=c,c=a,a=o+x|0,o=s,s=i,i=n,n=x+d|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,i,s,o,a,c,f,u)}roundClean(){He.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var _r=Zn(()=>new As);var oi={hashSHA256(e){return _r(e.subarray())},getHKDF(e,t){let r=Qa(_r,t,e),i=Ja(_r,r,void 0,96),s=i.subarray(0,32),o=i.subarray(32,64),a=i.subarray(64,96);return[s,o,a]},generateX25519KeyPair(){let e=sn.utils.randomPrivateKey();return{publicKey:sn.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed(e){return{publicKey:sn.getPublicKey(e),privateKey:e}},generateX25519SharedKey(e,t){return sn.getSharedSecret(e.subarray(),t.subarray())},chaCha20Poly1305Encrypt(e,t,r,n){return os(n,t,r).encrypt(e.subarray())},chaCha20Poly1305Decrypt(e,t,r,n,i){return os(n,t,r).decrypt(e.subarray(),i)}};var ja=oi;var Lr=e=>{let t=Bt(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};Lr.bytes=2;var on=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};on.bytes=2;function t0(e){return new At(e.ne,e.ciphertext)}function e0(e){return new At(e.ne,e.ns,e.ciphertext)}function r0(e){return new At(e.ns,e.ciphertext)}function n0(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:rt(0)}}function i0(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function s0(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:rt(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}var a0=16;function c0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let s=i+65519;s>n.length&&(s=n.length);let o;n instanceof Uint8Array?o=e.encrypt(n.subarray(i,s),e.session):o=e.encrypt(n.sublist(i,s),e.session),t?.encryptedPackets.increment(),yield new At(Lr(o.byteLength),o)}}}function f0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let s=i+65535;if(s>n.length&&(s=n.length),s-a0<i)throw new Error("Invalid chunk");let o=n.sublist(i,s),a=Bt(s-a0-i),{plaintext:c,valid:f}=e.decrypt(o,e.session,a);if(!f)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield c}}}var cn=class e extends Error{code;constructor(t="Unexpected Peer"){super(t),this.code=e.code}static code="ERR_UNEXPECTED_PEER"},rr=class e extends Error{code;constructor(t="Invalid crypto exchange"){super(t),this.code=e.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"};var fw=Gt(ln(),1),uw=Gt(Ac(),1);var l2=Symbol.for("@libp2p/connection");var d2=Symbol.for("@libp2p/content-routing");var g2=Symbol.for("@libp2p/peer-discovery");var Cc=Symbol.for("@libp2p/peer-id");var v2=Symbol.for("@libp2p/peer-routing");var Ic;(function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"})(Ic||(Ic={}));var B2=Symbol.for("@libp2p/transport");var Tc;(function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"})(Tc||(Tc={}));var it=class extends Error{code;props;constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var $s=class extends Event{detail;constructor(t,r){super(t,r),this.detail=r?.detail}},L2=globalThis.CustomEvent??$s;var s1=Gt(ht(),1);var js={};Lt(js,{base10:()=>wd});function xd(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,g=0,v=p.length;g!==v&&p[g]===0;)g++,d++;for(var m=(v-g)*u+1>>>0,C=new Uint8Array(m);g!==v;){for(var S=p[g],B=0,R=m-1;(S!==0||B<y)&&R!==-1;R--,B++)S+=256*C[R]>>>0,C[R]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");y=B,g++}for(var L=m-y;L!==m&&C[L]===0;)L++;for(var O=c.repeat(d);L<m;++L)O+=e.charAt(C[L]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,g=0;p[d]===c;)y++,d++;for(var v=(p.length-d)*f+1>>>0,m=new Uint8Array(v);p[d];){var C=r[p.charCodeAt(d)];if(C===255)return;for(var S=0,B=v-1;(C!==0||S<g)&&B!==-1;B--,S++)C+=a*m[B]>>>0,m[B]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");g=S,d++}if(p[d]!==" "){for(var R=v-g;R!==v&&m[R]===0;)R++;for(var L=new Uint8Array(y+(v-R)),O=y;R!==v;)L[O++]=m[R++];return L}}}function x(p){var d=l(p);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:x}}var gd=xd,md=gd,_c=md;var rm=new Uint8Array(0);var Lc=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},De=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var Rc=e=>new TextEncoder().encode(e),Nc=e=>new TextDecoder().decode(e);var Zs=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Xs=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Pc(this,t)}},Qs=class{constructor(t){this.decoders=t}or(t){return Pc(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Pc=(e,t)=>new Qs({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Js=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Zs(t,r,n),this.decoder=new Xs(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},kr=({name:e,prefix:t,encode:r,decode:n})=>new Js(e,t,r,n),We=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=_c(r,t);return kr({prefix:e,name:t,encode:n,decode:s=>De(i(s))})},bd=(e,t,r,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,f=0;for(let u=0;u<s;++u){let h=i[e[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},vd=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},St=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>kr({prefix:t,name:e,encode(i){return vd(i,n,r)},decode(i){return bd(i,n,r,e)}});var wd=We({prefix:"9",name:"base10",alphabet:"0123456789"});var to={};Lt(to,{base16:()=>Ed,base16upper:()=>Sd});var Ed=St({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sd=St({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var eo={};Lt(eo,{base2:()=>Bd});var Bd=St({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ro={};Lt(ro,{base256emoji:()=>_d});var kc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ad=kc.reduce((e,t,r)=>(e[r]=t,e),[]),Cd=kc.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function Id(e){return e.reduce((t,r)=>(t+=Ad[r],t),"")}function Td(e){let t=[];for(let r of e){let n=Cd[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var _d=kr({prefix:"\u{1F680}",name:"base256emoji",encode:Id,decode:Td});var no={};Lt(no,{base32:()=>Ur,base32hex:()=>Dd,base32hexpad:()=>kd,base32hexpadupper:()=>Ud,base32hexupper:()=>Pd,base32pad:()=>Rd,base32padupper:()=>Nd,base32upper:()=>Ld,base32z:()=>Kd});var Ur=St({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ld=St({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rd=St({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Nd=St({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Dd=St({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pd=St({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),kd=St({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ud=St({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Kd=St({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var io={};Lt(io,{base36:()=>Od,base36upper:()=>Md});var Od=We({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Md=We({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var so={};Lt(so,{base58btc:()=>zt,base58flickr:()=>Vd});var zt=We({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vd=We({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var oo={};Lt(oo,{base64:()=>Ai,base64pad:()=>Fd,base64url:()=>Hd,base64urlpad:()=>qd});var Ai=St({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fd=St({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hd=St({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qd=St({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ao={};Lt(ao,{base8:()=>zd});var zd=St({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var co={};Lt(co,{identity:()=>Gd});var Gd=kr({prefix:"\0",name:"identity",encode:e=>Nc(e),decode:e=>Rc(e)});var gm=new TextEncoder,mm=new TextDecoder;var uo={};Lt(uo,{identity:()=>$e});var $d=Oc,Uc=128,Zd=127,Xd=~Zd,Qd=Math.pow(2,31);function Oc(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Qd;)t[r++]=e&255|Uc,e/=128;for(;e&Xd;)t[r++]=e&255|Uc,e>>>=7;return t[r]=e|0,Oc.bytes=r-n+1,t}var Jd=fo,jd=128,Kc=127;function fo(e,n){var r=0,n=n||0,i=0,s=n,o,a=e.length;do{if(s>=a)throw fo.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&Kc)<<i:(o&Kc)*Math.pow(2,i),i+=7}while(o>=jd);return fo.bytes=s-n,r}var ty=Math.pow(2,7),ey=Math.pow(2,14),ry=Math.pow(2,21),ny=Math.pow(2,28),iy=Math.pow(2,35),sy=Math.pow(2,42),oy=Math.pow(2,49),ay=Math.pow(2,56),cy=Math.pow(2,63),fy=function(e){return e<ty?1:e<ey?2:e<ry?3:e<ny?4:e<iy?5:e<sy?6:e<oy?7:e<ay?8:e<cy?9:10},uy={encode:$d,decode:Jd,encodingLength:fy},hy=uy,yn=hy;var xn=(e,t=0)=>[yn.decode(e,t),yn.decode.bytes],Kr=(e,t,r=0)=>(yn.encode(e,t,r),t),Or=e=>yn.encodingLength(e);var me=(e,t)=>{let r=t.byteLength,n=Or(e),i=n+Or(r),s=new Uint8Array(i+r);return Kr(e,s,0),Kr(r,s,n),s.set(t,i),new Mr(e,r,t,s)},gn=e=>{let t=De(e),[r,n]=xn(t),[i,s]=xn(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Mr(r,i,o,t)},Mc=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Lc(e.bytes,r.bytes)}},Mr=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var Vc=0,ly="identity",Fc=De,py=e=>me(Vc,Fc(e)),$e={code:Vc,name:ly,encode:Fc,digest:py};var po={};Lt(po,{sha256:()=>Ot,sha512:()=>dy});var lo=({name:e,code:t,encode:r})=>new ho(e,t,r),ho=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?me(this.code,r):r.then(n=>me(this.code,n))}else throw Error("Unknown type, must be binary type")}};var qc=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ot=lo({name:"sha2-256",code:18,encode:qc("SHA-256")}),dy=lo({name:"sha2-512",code:19,encode:qc("SHA-512")});var zc=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return xy(r,yo(e),t||zt.encoder);default:return gy(r,yo(e),t||Ur.encoder)}};var Gc=new WeakMap,yo=e=>{let t=Gc.get(e);if(t==null){let r=new Map;return Gc.set(e,r),r}return t},cr=class e{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==mn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==my)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=me(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&Mc(t.multihash,n.multihash)}toString(t){return zc(this,t)}toJSON(){return{"/":zc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:o}=r;return new e(n,i,s,o||Yc(n,i,s.bytes))}else if(r[by]===!0){let{version:n,multihash:i,code:s}=r,o=gn(i);return e.create(n,s,o)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==mn)throw new Error(`Version 0 CID must use dag-pb (code: ${mn}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let i=Yc(t,r,n.bytes);return new e(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,mn,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,i=De(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new Mr(r.multihashCode,r.digestSize,s,i);return[r.version===0?e.createV0(o):e.createV1(r.codec,o),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=xn(t.subarray(r));return r+=l,h},i=n(),s=mn;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(t,r){let[n,i]=yy(t,r),s=e.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return yo(s).set(n,t),s}},yy=(e,t)=>{switch(e[0]){case"Q":{let r=t||zt;return[zt.prefix,r.decode(`${zt.prefix}${e}`)]}case zt.prefix:{let r=t||zt;return[zt.prefix,r.decode(e)]}case Ur.prefix:{let r=t||Ur;return[Ur.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},xy=(e,t,r)=>{let{prefix:n}=r;if(n!==zt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},gy=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},mn=112,my=18,Yc=(e,t,r)=>{let n=Or(e),i=n+Or(t),s=new Uint8Array(i+r.byteLength);return Kr(e,s,0),Kr(t,s,n),s.set(r,i),s},by=Symbol.for("@ipld/js-cid/CID");var Fr={...co,...eo,...ao,...js,...to,...no,...io,...so,...oo,...ro},Pm={...po,...uo};function $c(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Wc=$c("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),xo=$c("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Bt(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),vy={utf8:Wc,"utf-8":Wc,hex:Fr.base16,latin1:xo,ascii:xo,binary:xo,...Fr},Ii=vy;function It(e,t="utf8"){let r=Ii[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ee(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var No={};Lt(No,{Ed25519PrivateKey:()=>dr,Ed25519PublicKey:()=>En,generateKeyPair:()=>Ny,generateKeyPairFromSeed:()=>lf,unmarshalEd25519PrivateKey:()=>Ly,unmarshalEd25519PublicKey:()=>Ry});var zm=Gt(Ct(),1),Gm=Gt(wi(),1),Zc=Gt(ht(),1);function Et(e,t="utf8"){let r=Ii[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function fe(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Zt([new Uint8Array(t-r.length),r])}return Et(r,"base64url")}function Qt(e){let t=Xc(e);return new Zc.default.jsbn.BigInteger(Et(t,"base16"),16)}function Xc(e,t){let r=It(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Zt([new Uint8Array(t-r.length),r])}return r}function ee(e){return e==null?!1:typeof e.then=="function"&&typeof e.catch=="function"&&typeof e.finally=="function"}var Hr=32,Pe=64,Ti=32;function Qc(){let e=Ir.utils.randomPrivateKey(),t=Ir.getPublicKey(e);return{privateKey:ef(e,t),publicKey:t}}function Jc(e){if(e.length!==Ti)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=Ir.getPublicKey(t);return{privateKey:ef(t,r),publicKey:r}}function jc(e,t){let r=e.subarray(0,Ti);return Ir.sign(t instanceof Uint8Array?t:t.subarray(),r)}function tf(e,t,r){return Ir.verify(t,r instanceof Uint8Array?r:r.subarray(),e)}function ef(e,t){let r=new Uint8Array(Pe);for(let n=0;n<Ti;n++)r[n]=e[n],r[Ti+n]=t[n];return r}var Wt={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var go={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function mo(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=Wt.get();r*=8;async function c(h,l){let x=a.getRandomValues(new Uint8Array(s)),p=a.getRandomValues(new Uint8Array(n)),d={name:t,iv:p};typeof l=="string"&&(l=It(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",go,{name:"AES-GCM"},!0,["encrypt"]);try{let v={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(v,m,{name:t,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",go,{name:"AES-GCM"},!0,["encrypt"])}}else{let v={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(v,m,{name:t,length:r},!0,["encrypt"])}let g=await a.subtle.encrypt(d,y,h);return Zt([x,d.iv,new Uint8Array(g)])}async function f(h,l){let x=h.subarray(0,s),p=h.subarray(s,s+n),d=h.subarray(s+n),y={name:t,iv:p};typeof l=="string"&&(l=It(l));let g;if(l.length===0)try{let m={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(m,C,{name:t,length:r},!0,["decrypt"])}catch{g=await a.subtle.importKey("jwk",go,{name:"AES-GCM"},!0,["decrypt"])}else{let m={name:"PBKDF2",salt:x,iterations:o,hash:{name:i}},C=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(m,C,{name:t,length:r},!0,["decrypt"])}let v=await a.subtle.decrypt(y,g,d);return new Uint8Array(v)}return{encrypt:c,decrypt:f}}async function qr(e,t){let n=await mo().encrypt(e,t);return Ai.encode(n)}var bo=new Float32Array([-0]),Ze=new Uint8Array(bo.buffer);function nf(e,t,r){bo[0]=e,t[r]=Ze[0],t[r+1]=Ze[1],t[r+2]=Ze[2],t[r+3]=Ze[3]}function sf(e,t){return Ze[0]=e[t],Ze[1]=e[t+1],Ze[2]=e[t+2],Ze[3]=e[t+3],bo[0]}var vo=new Float64Array([-0]),Ft=new Uint8Array(vo.buffer);function of(e,t,r){vo[0]=e,t[r]=Ft[0],t[r+1]=Ft[1],t[r+2]=Ft[2],t[r+3]=Ft[3],t[r+4]=Ft[4],t[r+5]=Ft[5],t[r+6]=Ft[6],t[r+7]=Ft[7]}function af(e,t){return Ft[0]=e[t],Ft[1]=e[t+1],Ft[2]=e[t+2],Ft[3]=e[t+3],Ft[4]=e[t+4],Ft[5]=e[t+5],Ft[6]=e[t+6],Ft[7]=e[t+7],vo[0]}var Ey=BigInt(Number.MAX_SAFE_INTEGER),Sy=BigInt(Number.MIN_SAFE_INTEGER),$t=class e{lo;hi;constructor(t,r){this.lo=t|0,this.hi=r|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return fr;if(t<Ey&&t>Sy)return this.fromNumber(Number(t));let r=t<0n;r&&(t=-t);let n=t>>32n,i=t-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>cf&&(i=0n,++n>cf&&(n=0n))),new e(Number(i),Number(n))}static fromNumber(t){if(t===0)return fr;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new e(n,i)}static from(t){return typeof t=="number"?e.fromNumber(t):typeof t=="bigint"?e.fromBigInt(t):typeof t=="string"?e.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new e(t.low>>>0,t.high>>>0):fr}},fr=new $t(0,0);fr.toBigInt=function(){return 0n};fr.zzEncode=fr.zzDecode=function(){return this};fr.length=function(){return 1};var cf=4294967296n;function ff(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function uf(e,t,r){if(r-t<1)return"";let i,s=[],o=0,a;for(;t<r;)a=e[t++],a<128?s[o++]=a:a>191&&a<224?s[o++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[o++]=55296+(a>>10),s[o++]=56320+(a&1023)):s[o++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,o>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,s)),o=0);return i!=null?(o>0&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))}function wo(e,t,r){let n=r,i,s;for(let o=0;o<e.length;++o)i=e.charCodeAt(o),i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(i=65536+((i&1023)<<10)+(s&1023),++o,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128);return r-n}function ue(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function _i(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}var Eo=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,ue(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw ue(this,4);return _i(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw ue(this,4);return _i(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw ue(this,4);let t=sf(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw ue(this,4);let t=af(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw ue(this,t);return this.pos+=t,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let t=this.bytes();return uf(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw ue(this,t);this.pos+=t}else do if(this.pos>=this.len)throw ue(this);while(this.buf[this.pos++]&128);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new $t(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw ue(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,t}if(this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw ue(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw ue(this,8);let t=_i(this.buf,this.pos+=4),r=_i(this.buf,this.pos+=4);return new $t(t,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function So(e){return new Eo(e instanceof Uint8Array?e:e.subarray())}function ur(e,t){let r=So(e);return t.decode(r)}function Bo(e){let t=e??8192,r=t>>>1,n,i=t;return function(o){if(o<1||o>r)return Bt(o);i+o>t&&(n=Bt(t),i=0);let a=n.subarray(i,i+=o);return i&7&&(i=(i|7)+1),a}}var hr=class{fn;len;next;val;constructor(t,r,n){this.fn=t,this.len=r,this.next=void 0,this.val=n}};function Ao(){}var Io=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},By=Bo();function Ay(e){return globalThis.Buffer!=null?Bt(e):By(e)}var wn=class{len;head;tail;states;constructor(){this.len=0,this.head=new hr(Ao,0,0),this.tail=this.head,this.states=null}_push(t,r,n){return this.tail=this.tail.next=new hr(t,r,n),this.len+=r,this}uint32(t){return this.len+=(this.tail=this.tail.next=new To((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(bn,10,$t.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let r=$t.fromBigInt(t);return this._push(bn,r.length(),r)}uint64Number(t){let r=$t.fromNumber(t);return this._push(bn,r.length(),r)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let r=$t.fromBigInt(t).zzEncode();return this._push(bn,r.length(),r)}sint64Number(t){let r=$t.fromNumber(t).zzEncode();return this._push(bn,r.length(),r)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Co,1,t?1:0)}fixed32(t){return this._push(vn,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let r=$t.fromBigInt(t);return this._push(vn,4,r.lo)._push(vn,4,r.hi)}fixed64Number(t){let r=$t.fromNumber(t);return this._push(vn,4,r.lo)._push(vn,4,r.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(nf,4,t)}double(t){return this._push(of,8,t)}bytes(t){let r=t.length>>>0;return r===0?this._push(Co,1,0):this.uint32(r)._push(Iy,r,t)}string(t){let r=ff(t);return r!==0?this.uint32(r)._push(wo,r,t):this._push(Co,1,0)}fork(){return this.states=new Io(this),this.head=this.tail=new hr(Ao,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new hr(Ao,0,0),this.len=0),this}ldelim(){let t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=r,this.len+=n),this}finish(){let t=this.head.next,r=Ay(this.len),n=0;for(;t!=null;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r}};function Co(e,t,r){t[r]=e&255}function Cy(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}var To=class extends hr{next;constructor(t,r){super(Cy,t,r),this.next=void 0}};function bn(e,t,r){for(;e.hi!==0;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}function vn(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Iy(e,t,r){t.set(e,r)}globalThis.Buffer!=null&&(wn.prototype.bytes=function(e){let t=e.length>>>0;return this.uint32(t),t>0&&this._push(Ty,t,e),this},wn.prototype.string=function(e){let t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(_y,t,e),this});function Ty(e,t,r){t.set(e,r)}function _y(e,t,r){e.length<40?wo(e,t,r):t.utf8Write!=null?t.utf8Write(e,r):t.set(It(e),r)}function _o(){return new wn}function lr(e,t){let r=_o();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var zr;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(zr||(zr={}));function Li(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Lo(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,o){let a=t(s);o.int32(a)},n=function(s){let o=s.int32();return t(o)};return Li("enum",zr.VARINT,r,n)}function pr(e,t){return Li("message",zr.LENGTH_DELIMITED,e,t)}var wt;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(wt||(wt={}));var Ro;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(Ro||(Ro={}));(function(e){e.codec=()=>Lo(Ro)})(wt||(wt={}));var be;(function(e){let t;e.codec=()=>(t==null&&(t=pr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>lr(r,e.codec()),e.decode=r=>ur(r,e.codec())})(be||(be={}));var ve;(function(e){let t;e.codec=()=>(t==null&&(t=pr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),wt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=wt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),t),e.encode=r=>lr(r,e.codec()),e.decode=r=>ur(r,e.codec())})(ve||(ve={}));var En=class{_key;constructor(t){this._key=Gr(t,Hr)}verify(t,r){return tf(this._key,r,t)}marshal(){return this._key}get bytes(){return be.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Rt(this.bytes,t.bytes)}hash(){let t=Ot.digest(this.bytes);return ee(t)?t.then(({bytes:r})=>r):t.bytes}},dr=class{_key;_publicKey;constructor(t,r){this._key=Gr(t,Pe),this._publicKey=Gr(r,Hr)}sign(t){return jc(this._key,t)}get public(){return new En(this._publicKey)}marshal(){return this._key}get bytes(){return ve.encode({Type:wt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Rt(this.bytes,t.bytes)}async hash(){let t=Ot.digest(this.bytes),r;return ee(t)?{bytes:r}=await t:r=t.bytes,r}async id(){let t=$e.digest(this.public.bytes);return zt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return qr(this.bytes,t);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Ly(e){if(e.length>Pe){e=Gr(e,Pe+Hr);let n=e.subarray(0,Pe),i=e.subarray(Pe,e.length);return new dr(n,i)}e=Gr(e,Pe);let t=e.subarray(0,Pe),r=e.subarray(Hr);return new dr(t,r)}function Ry(e){return e=Gr(e,Hr),new En(e)}async function Ny(){let{privateKey:e,publicKey:t}=Qc();return new dr(e,t)}async function lf(e){let{privateKey:t,publicKey:r}=Jc(e);return new dr(t,r)}function Gr(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new it(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}var Dy={"P-256":256,"P-384":384,"P-521":521},Py=Object.keys(Dy),Yb=Py.join(" / ");var Ko={};Lt(Ko,{MAX_KEY_SIZE:()=>Cn,RsaPrivateKey:()=>Yr,RsaPublicKey:()=>An,fromJwk:()=>Gy,generateKeyPair:()=>Yy,unmarshalRsaPrivateKey:()=>qy,unmarshalRsaPublicKey:()=>zy});var Bn=Gt(ht(),1);var Lv=Gt(gf(),1);function Ni(e){if(isNaN(e)||e<=0)throw new it("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return je(e)}var lv=Gt(Bi(),1),ko=Gt(ht(),1);function mf(e,t){return t.map(r=>Qt(e[r]))}function bf(e){return ko.default.pki.setRsaPrivateKey(...mf(e,["n","e","d","p","q","dp","dq","qi"]))}function vf(e){return ko.default.pki.setRsaPublicKey(...mf(e,["n","e"]))}var xr={};Lt(xr,{jwkToPkcs1:()=>Oy,jwkToPkix:()=>Vy,pkcs1ToJwk:()=>Ky,pkixToJwk:()=>My});var yv=Gt(ln(),1),xv=Gt(Bi(),1);var ke=Gt(ht(),1);function Ky(e){let t=ke.default.asn1.fromDer(Et(e,"ascii")),r=ke.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:fe(r.n),e:fe(r.e),d:fe(r.d),p:fe(r.p),q:fe(r.q),dp:fe(r.dP),dq:fe(r.dQ),qi:fe(r.qInv),alg:"RS256"}}function Oy(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new it("JWK was missing components","ERR_INVALID_PARAMETERS");let t=ke.default.pki.privateKeyToAsn1({n:Qt(e.n),e:Qt(e.e),d:Qt(e.d),p:Qt(e.p),q:Qt(e.q),dP:Qt(e.dp),dQ:Qt(e.dq),qInv:Qt(e.qi)});return It(ke.default.asn1.toDer(t).getBytes(),"ascii")}function My(e){let t=ke.default.asn1.fromDer(Et(e,"ascii")),r=ke.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:fe(r.n),e:fe(r.e)}}function Vy(e){if(e.n==null||e.e==null)throw new it("JWK was missing components","ERR_INVALID_PARAMETERS");let t=ke.default.pki.publicKeyToAsn1({n:Qt(e.n),e:Qt(e.e)});return It(ke.default.asn1.toDer(t).getBytes(),"ascii")}async function wf(e){let t=await Wt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Bf(t);return{privateKey:r[0],publicKey:r[1]}}async function Uo(e){let r=[await Wt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Fy(e)],n=await Bf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Ef(e,t){let r=await Wt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Wt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function Sf(e,t,r){let n=await Wt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Wt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r instanceof Uint8Array?r:r.subarray())}async function Bf(e){if(e.privateKey==null||e.publicKey==null)throw new it("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Wt.get().subtle.exportKey("jwk",e.privateKey),Wt.get().subtle.exportKey("jwk",e.publicKey)])}async function Fy(e){return Wt.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Af(e,t,r,n){let i=t?vf(e):bf(e),s=Et(r instanceof Uint8Array?r:r.subarray(),"ascii"),o=n(s,i);return It(o,"ascii")}function Cf(e,t){return Af(e,!0,t,(r,n)=>n.encrypt(r))}function If(e,t){return Af(e,!1,t,(r,n)=>n.decrypt(r))}function Di(e){if(e.kty!=="RSA")throw new it("invalid key type","ERR_INVALID_KEY_TYPE");if(e.n==null)throw new it("invalid key modulus","ERR_INVALID_KEY_MODULUS");return It(e.n,"base64url").length*8}var Cn=8192,An=class{_key;constructor(t){this._key=t}verify(t,r){return Sf(this._key,r,t)}marshal(){return xr.jwkToPkix(this._key)}get bytes(){return be.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}encrypt(t){return Cf(this._key,t)}equals(t){return Rt(this.bytes,t.bytes)}hash(){let t=Ot.digest(this.bytes);return ee(t)?t.then(({bytes:r})=>r):t.bytes}},Yr=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return Ni(16)}sign(t){return Ef(this._key,t)}get public(){if(this._publicKey==null)throw new it("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new An(this._publicKey)}decrypt(t){return If(this._key,t)}marshal(){return xr.jwkToPkcs1(this._key)}get bytes(){return ve.encode({Type:wt.RSA,Data:this.marshal()}).subarray()}equals(t){return Rt(this.bytes,t.bytes)}hash(){let t=Ot.digest(this.bytes);return ee(t)?t.then(({bytes:r})=>r):t.bytes}async id(){let t=await this.public.hash();return Et(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Bn.default.util.ByteBuffer(this.marshal()),i=Bn.default.asn1.fromDer(n),s=Bn.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Bn.default.pki.encryptRsaPrivateKey(s,t,o)}else{if(r==="libp2p-key")return qr(this.bytes,t);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function qy(e){let t=xr.pkcs1ToJwk(e);if(Di(t)>Cn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Uo(t);return new Yr(r.privateKey,r.publicKey)}function zy(e){let t=xr.pkixToJwk(e);if(Di(t)>Cn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new An(t)}async function Gy(e){if(Di(e)>Cn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let t=await Uo(e);return new Yr(t.privateKey,t.publicKey)}async function Yy(e){if(e>Cn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let t=await wf(e);return new Yr(t.privateKey,t.publicKey)}var Fo={};Lt(Fo,{Secp256k1PrivateKey:()=>Tn,Secp256k1PublicKey:()=>In,generateKeyPair:()=>i1,unmarshalSecp256k1PrivateKey:()=>r1,unmarshalSecp256k1PublicKey:()=>n1});function Wy(e){let t=en(e);Jt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:$y,hexToBytes:Zy}=jn,gr={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=gr;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:$y(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=gr,r=typeof e=="string"?Zy(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=gr._parseInt(r.subarray(2)),{d:o,l:a}=gr._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=f=>Number.parseInt(f[0],16)&8?"00"+f:f,r=f=>{let u=f.toString(16);return u.length&1?`0${u}`:u},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),c=r(o);return`30${r(o+s+4)}02${c}${i}02${a}${n}`}},Ue=BigInt(0),re=BigInt(1),Kv=BigInt(2),Tf=BigInt(3),Ov=BigInt(4);function Xy(e){let t=Wy(e),{Fp:r}=t,n=t.toBytes||((p,d,y)=>{let g=d.toAffine();return Te(Uint8Array.from([4]),r.toBytes(g.x),r.toBytes(g.y))}),i=t.fromBytes||(p=>{let d=p.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),g=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:g}});function s(p){let{a:d,b:y}=t,g=r.sqr(p),v=r.mul(g,p);return r.add(r.add(v,r.mul(p,d)),y)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Ue<p&&p<t.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:g,n:v}=t;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Ae(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let m;try{m=typeof p=="bigint"?p:Ce(yt("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return g&&(m=at(m,v)),a(m),m}let f=new Map;function u(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,y,g){if(this.px=d,this.py=y,this.pz=g,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(g==null||!r.isValid(g))throw new Error("z required")}static fromAffine(d){let{x:y,y:g}=d||{};if(!d||!r.isValid(y)||!r.isValid(g))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let v=m=>r.eql(m,r.ZERO);return v(y)&&v(g)?h.ZERO:new h(y,g,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(g=>g.pz));return d.map((g,v)=>g.toAffine(y[v])).map(h.fromAffine)}static fromHex(d){let y=h.fromAffine(i(yt("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return h.BASE.multiply(c(d))}_setWindowSize(d){this._WINDOW_SIZE=d,f.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let g=r.sqr(y),v=s(d);if(!r.eql(g,v))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){u(d);let{px:y,py:g,pz:v}=this,{px:m,py:C,pz:S}=d,B=r.eql(r.mul(y,S),r.mul(m,v)),R=r.eql(r.mul(g,S),r.mul(C,v));return B&&R}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=t,g=r.mul(y,Tf),{px:v,py:m,pz:C}=this,S=r.ZERO,B=r.ZERO,R=r.ZERO,L=r.mul(v,v),O=r.mul(m,m),M=r.mul(C,C),U=r.mul(v,m);return U=r.add(U,U),R=r.mul(v,C),R=r.add(R,R),S=r.mul(d,R),B=r.mul(g,M),B=r.add(S,B),S=r.sub(O,B),B=r.add(O,B),B=r.mul(S,B),S=r.mul(U,S),R=r.mul(g,R),M=r.mul(d,M),U=r.sub(L,M),U=r.mul(d,U),U=r.add(U,R),R=r.add(L,L),L=r.add(R,L),L=r.add(L,M),L=r.mul(L,U),B=r.add(B,L),M=r.mul(m,C),M=r.add(M,M),L=r.mul(M,U),S=r.sub(S,L),R=r.mul(M,O),R=r.add(R,R),R=r.add(R,R),new h(S,B,R)}add(d){u(d);let{px:y,py:g,pz:v}=this,{px:m,py:C,pz:S}=d,B=r.ZERO,R=r.ZERO,L=r.ZERO,O=t.a,M=r.mul(t.b,Tf),U=r.mul(y,m),q=r.mul(g,C),z=r.mul(v,S),Z=r.add(y,g),A=r.add(m,C);Z=r.mul(Z,A),A=r.add(U,q),Z=r.sub(Z,A),A=r.add(y,v);let N=r.add(m,S);return A=r.mul(A,N),N=r.add(U,z),A=r.sub(A,N),N=r.add(g,v),B=r.add(C,S),N=r.mul(N,B),B=r.add(q,z),N=r.sub(N,B),L=r.mul(O,A),B=r.mul(M,z),L=r.add(B,L),B=r.sub(q,L),L=r.add(q,L),R=r.mul(B,L),q=r.add(U,U),q=r.add(q,U),z=r.mul(O,z),A=r.mul(M,A),q=r.add(q,z),z=r.sub(U,z),z=r.mul(O,z),A=r.add(A,z),U=r.mul(q,A),R=r.add(R,U),U=r.mul(N,A),B=r.mul(Z,B),B=r.sub(B,U),U=r.mul(Z,q),L=r.mul(N,L),L=r.add(L,U),new h(B,R,L)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return x.wNAFCached(this,f,d,y=>{let g=r.invertBatch(y.map(v=>v.pz));return y.map((v,m)=>v.toAffine(g[m])).map(h.fromAffine)})}multiplyUnsafe(d){let y=h.ZERO;if(d===Ue)return y;if(a(d),d===re)return this;let{endo:g}=t;if(!g)return x.unsafeLadder(this,d);let{k1neg:v,k1:m,k2neg:C,k2:S}=g.splitScalar(d),B=y,R=y,L=this;for(;m>Ue||S>Ue;)m&re&&(B=B.add(L)),S&re&&(R=R.add(L)),L=L.double(),m>>=re,S>>=re;return v&&(B=B.negate()),C&&(R=R.negate()),R=new h(r.mul(R.px,g.beta),R.py,R.pz),B.add(R)}multiply(d){a(d);let y=d,g,v,{endo:m}=t;if(m){let{k1neg:C,k1:S,k2neg:B,k2:R}=m.splitScalar(y),{p:L,f:O}=this.wNAF(S),{p:M,f:U}=this.wNAF(R);L=x.constTimeNegate(C,L),M=x.constTimeNegate(B,M),M=new h(r.mul(M.px,m.beta),M.py,M.pz),g=L.add(M),v=O.add(U)}else{let{p:C,f:S}=this.wNAF(y);g=C,v=S}return h.normalizeZ([g,v])[0]}multiplyAndAddUnsafe(d,y,g){let v=h.BASE,m=(S,B)=>B===Ue||B===re||!S.equals(v)?S.multiplyUnsafe(B):S.multiply(B),C=m(this,y).add(m(d,g));return C.is0()?void 0:C}toAffine(d){let{px:y,py:g,pz:v}=this,m=this.is0();d==null&&(d=m?r.ONE:r.inv(v));let C=r.mul(y,d),S=r.mul(g,d),B=r.mul(v,d);if(m)return{x:r.ZERO,y:r.ZERO};if(!r.eql(B,r.ONE))throw new Error("invZ was invalid");return{x:C,y:S}}isTorsionFree(){let{h:d,isTorsionFree:y}=t;if(d===re)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=t;return d===re?this:y?y(h,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return Ae(this.toRawBytes(d))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=t.nBitLength,x=ri(h,t.endo?Math.ceil(l/2):l);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}function Qy(e){let t=en(e);return Jt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function _f(e){let t=Qy(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(A){return Ue<A&&A<r.ORDER}function a(A){return at(A,n)}function c(A){return ti(A,n)}let{ProjectivePoint:f,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=Xy({...t,toBytes(A,N,T){let _=N.toAffine(),w=r.toBytes(_.x),k=Te;return T?k(Uint8Array.from([N.hasEvenY()?2:3]),w):k(Uint8Array.from([4]),w,r.toBytes(_.y))},fromBytes(A){let N=A.length,T=A[0],_=A.subarray(1);if(N===i&&(T===2||T===3)){let w=Ce(_);if(!o(w))throw new Error("Point is not on curve");let k=h(w),K=r.sqrt(k),F=(K&re)===re;return(T&1)===1!==F&&(K=r.neg(K)),{x:w,y:K}}else if(N===s&&T===4){let w=r.fromBytes(_.subarray(0,r.BYTES)),k=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:w,y:k}}else throw new Error(`Point of length ${N} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),x=A=>Ae(Ve(A,t.nByteLength));function p(A){let N=n>>re;return A>N}function d(A){return p(A)?a(-A):A}let y=(A,N,T)=>Ce(A.slice(N,T));class g{constructor(N,T,_){this.r=N,this.s=T,this.recovery=_,this.assertValidity()}static fromCompact(N){let T=t.nByteLength;return N=yt("compactSignature",N,T*2),new g(y(N,0,T),y(N,T,2*T))}static fromDER(N){let{r:T,s:_}=gr.toSig(yt("DER",N));return new g(T,_)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(N){return new g(this.r,this.s,N)}recoverPublicKey(N){let{r:T,s:_,recovery:w}=this,k=R(yt("msgHash",N));if(w==null||![0,1,2,3].includes(w))throw new Error("recovery id invalid");let K=w===2||w===3?T+t.n:T;if(K>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let F=w&1?"03":"02",W=f.fromHex(F+x(K)),$=c(K),et=a(-k*$),X=a(_*$),J=f.BASE.multiplyAndAddUnsafe(W,et,X);if(!J)throw new Error("point at infinify");return J.assertValidity(),J}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return tr(this.toDERHex())}toDERHex(){return gr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tr(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}let v={isValidPrivateKey(A){try{return u(A),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let A=bs(t.n);return Ha(t.randomBytes(A),t.n)},precompute(A=8,N=f.BASE){return N._setWindowSize(A),N.multiply(BigInt(3)),N}};function m(A,N=!0){return f.fromPrivateKey(A).toRawBytes(N)}function C(A){let N=A instanceof Uint8Array,T=typeof A=="string",_=(N||T)&&A.length;return N?_===i||_===s:T?_===2*i||_===2*s:A instanceof f}function S(A,N,T=!0){if(C(A))throw new Error("first arg must be private key");if(!C(N))throw new Error("second arg must be public key");return f.fromHex(N).multiply(u(A)).toRawBytes(T)}let B=t.bits2int||function(A){let N=Ce(A),T=A.length*8-t.nBitLength;return T>0?N>>BigInt(T):N},R=t.bits2int_modN||function(A){return a(B(A))},L=tn(t.nBitLength);function O(A){if(typeof A!="bigint")throw new Error("bigint expected");if(!(Ue<=A&&A<L))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Ve(A,t.nByteLength)}function M(A,N,T=U){if(["recovered","canonical"].some(ut=>ut in T))throw new Error("sign() legacy options not supported");let{hash:_,randomBytes:w}=t,{lowS:k,prehash:K,extraEntropy:F}=T;k==null&&(k=!0),A=yt("msgHash",A),K&&(A=yt("prehashed msgHash",_(A)));let W=R(A),$=u(N),et=[O($),O(W)];if(F!=null){let ut=F===!0?w(r.BYTES):F;et.push(yt("extraEntropy",ut))}let X=Te(...et),J=W;function lt(ut){let kt=B(ut);if(!l(kt))return;let Ut=c(kt),Tt=f.BASE.multiply(kt).toAffine(),Mt=a(Tt.x);if(Mt===Ue)return;let we=a(Ut*a(J+Mt*$));if(we===Ue)return;let Xe=(Tt.x===Mt?0:2)|Number(Tt.y&re),Xr=we;return k&&p(we)&&(Xr=d(we),Xe^=1),new g(Mt,Xr,Xe)}return{seed:X,k2sig:lt}}let U={lowS:t.lowS,prehash:!1},q={lowS:t.lowS,prehash:!1};function z(A,N,T=U){let{seed:_,k2sig:w}=M(A,N,T),k=t;return ds(k.hash.outputLen,k.nByteLength,k.hmac)(_,w)}f.BASE._setWindowSize(8);function Z(A,N,T,_=q){let w=A;if(N=yt("msgHash",N),T=yt("publicKey",T),"strict"in _)throw new Error("options.strict was renamed to lowS");let{lowS:k,prehash:K}=_,F,W;try{if(typeof w=="string"||w instanceof Uint8Array)try{F=g.fromDER(w)}catch(Tt){if(!(Tt instanceof gr.Err))throw Tt;F=g.fromCompact(w)}else if(typeof w=="object"&&typeof w.r=="bigint"&&typeof w.s=="bigint"){let{r:Tt,s:Mt}=w;F=new g(Tt,Mt)}else throw new Error("PARSE");W=f.fromHex(T)}catch(Tt){if(Tt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(k&&F.hasHighS())return!1;K&&(N=t.hash(N));let{r:$,s:et}=F,X=R(N),J=c(et),lt=a(X*J),ut=a($*J),kt=f.BASE.multiplyAndAddUnsafe(W,lt,ut)?.toAffine();return kt?a(kt.x)===$:!1}return{CURVE:t,getPublicKey:m,getSharedSecret:S,sign:z,verify:Z,ProjectivePoint:f,Signature:g,utils:v}}function Jy(e){return{hash:e,hmac:(t,...r)=>Tr(e,t,$n(...r)),randomBytes:je}}function Lf(e,t){let r=n=>_f({...e,...Jy(n)});return Object.freeze({...r(t),create:r})}var Df=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Rf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),jy=BigInt(1),Oo=BigInt(2),Nf=(e,t)=>(e+t/Oo)/t;function t1(e){let t=Df,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),f=e*e*e%t,u=f*f*e%t,h=xt(u,r,t)*u%t,l=xt(h,r,t)*u%t,x=xt(l,Oo,t)*f%t,p=xt(x,i,t)*x%t,d=xt(p,s,t)*p%t,y=xt(d,a,t)*d%t,g=xt(y,c,t)*y%t,v=xt(g,a,t)*d%t,m=xt(v,r,t)*u%t,C=xt(m,o,t)*p%t,S=xt(C,n,t)*f%t,B=xt(S,Oo,t);if(!Mo.eql(Mo.sqr(B),e))throw new Error("Cannot find square root");return B}var Mo=ei(Df,void 0,void 0,{sqrt:t1}),he=Lf({a:BigInt(0),b:BigInt(7),Fp:Mo,n:Rf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Rf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-jy*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=Nf(s*e,t),c=Nf(-n*e,t),f=at(e-a*r-c*i,t),u=at(-a*n-c*s,t),h=f>o,l=u>o;if(h&&(f=t-f),l&&(u=t-u),f>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:f,k2neg:l,k2:u}}}},_r),Wv=BigInt(0);var $v=he.ProjectivePoint;function Pf(){return he.utils.randomPrivateKey()}function kf(e,t){let r=Ot.digest(t instanceof Uint8Array?t:t.subarray());if(ee(r))return r.then(({digest:n})=>he.sign(n,e).toDERRawBytes()).catch(n=>{throw new it(String(n),"ERR_INVALID_INPUT")});try{return he.sign(r.digest,e).toDERRawBytes()}catch(n){throw new it(String(n),"ERR_INVALID_INPUT")}}function Uf(e,t,r){let n=Ot.digest(r instanceof Uint8Array?r:r.subarray());if(ee(n))return n.then(({digest:i})=>he.verify(t,i,e)).catch(i=>{throw new it(String(i),"ERR_INVALID_INPUT")});try{return he.verify(t,n.digest,e)}catch(i){throw new it(String(i),"ERR_INVALID_INPUT")}}function Kf(e){return he.ProjectivePoint.fromHex(e).toRawBytes(!0)}function Of(e){try{he.getPublicKey(e,!0)}catch(t){throw new it(String(t),"ERR_INVALID_PRIVATE_KEY")}}function Vo(e){try{he.ProjectivePoint.fromHex(e)}catch(t){throw new it(String(t),"ERR_INVALID_PUBLIC_KEY")}}function Mf(e){try{return he.getPublicKey(e,!0)}catch(t){throw new it(String(t),"ERR_INVALID_PRIVATE_KEY")}}var In=class{_key;constructor(t){Vo(t),this._key=t}verify(t,r){return Uf(this._key,r,t)}marshal(){return Kf(this._key)}get bytes(){return be.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Rt(this.bytes,t.bytes)}async hash(){let t=Ot.digest(this.bytes),r;return ee(t)?{bytes:r}=await t:r=t.bytes,r}},Tn=class{_key;_publicKey;constructor(t,r){this._key=t,this._publicKey=r??Mf(t),Of(this._key),Vo(this._publicKey)}sign(t){return kf(this._key,t)}get public(){return new In(this._publicKey)}marshal(){return this._key}get bytes(){return ve.encode({Type:wt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Rt(this.bytes,t.bytes)}hash(){let t=Ot.digest(this.bytes);return ee(t)?t.then(({bytes:r})=>r):t.bytes}async id(){let t=await this.public.hash();return Et(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return qr(this.bytes,t);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function r1(e){return new Tn(e)}function n1(e){return new In(e)}async function i1(){let e=Pf();return new Tn(e)}var mr={rsa:Ko,ed25519:No,secp256k1:Fo};function Vf(e){let t=Object.keys(mr).join(" / ");return new it(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ff(e){let t=be.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case wt.RSA:return mr.rsa.unmarshalRsaPublicKey(r);case wt.Ed25519:return mr.ed25519.unmarshalEd25519PublicKey(r);case wt.Secp256k1:return mr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Vf(t.Type??"unknown")}}async function Hf(e){let t=ve.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case wt.RSA:return mr.rsa.unmarshalRsaPrivateKey(r);case wt.Ed25519:return mr.ed25519.unmarshalEd25519PrivateKey(r);case wt.Secp256k1:return mr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Vf(t.Type??"RSA")}}var o1=Symbol.for("nodejs.util.inspect.custom"),qf=Object.values(Fr).map(e=>e.decoder).reduce((e,t)=>e.or(t),Fr.identity.decoder),zf=114,Ho=36,qo=37,_n=class{type;multihash;privateKey;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Cc]=!0;toString(){return this.string==null&&(this.string=zt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return cr.createV1(zf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Rt(this.multihash.bytes,t);if(typeof t=="string")return a1(t).equals(this);if(t?.multihash?.bytes!=null)return Rt(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[o1](){return`PeerId(${this.toString()})`}},Wr=class extends _n{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},$r=class extends _n{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.multihash.digest}},Zr=class extends _n{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.multihash.digest}};function a1(e,t){if(t=t??qf,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=gn(zt.decode(`z${e}`));return e.startsWith("12D")?new $r({multihash:r}):e.startsWith("16U")?new Zr({multihash:r}):new Wr({multihash:r})}return c1(qf.decode(e))}function c1(e){try{let t=gn(e);if(t.code===$e.code){if(t.digest.length===Ho)return new $r({multihash:t});if(t.digest.length===qo)return new Zr({multihash:t})}if(t.code===Ot.code)return new Wr({multihash:t})}catch{return f1(cr.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function f1(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==zf)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Ot.code)return new Wr({multihash:e.multihash});if(t.code===$e.code){if(t.digest.length===Ho)return new $r({multihash:e.multihash});if(t.digest.length===qo)return new Zr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function zo(e,t){return e.length===Ho?new $r({multihash:me($e.code,e),privateKey:t}):e.length===qo?new Zr({multihash:me($e.code,e),privateKey:t}):new Wr({multihash:await Ot.digest(e),publicKey:e,privateKey:t})}var Pi;(function(e){let t;e.codec=()=>(t==null&&(t=pr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let s of r.webtransportCerthashes)n.uint32(10),n.bytes(s);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:{i.webtransportCerthashes.push(r.bytes());break}default:{r.skipType(o&7);break}}}return i})),t),e.encode=r=>lr(r,e.codec()),e.decode=r=>ur(r,e.codec())})(Pi||(Pi={}));var Ln;(function(e){let t;e.codec=()=>(t==null&&(t=pr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.identityKey!=null&&r.identityKey.byteLength>0&&(n.uint32(10),n.bytes(r.identityKey)),r.identitySig!=null&&r.identitySig.byteLength>0&&(n.uint32(18),n.bytes(r.identitySig)),r.extensions!=null&&(n.uint32(34),Pi.codec().encode(r.extensions,n)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:rt(0),identitySig:rt(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:{i.identityKey=r.bytes();break}case 2:{i.identitySig=r.bytes();break}case 4:{i.extensions=Pi.codec().decode(r,r.uint32());break}default:{r.skipType(o&7);break}}}return i})),t),e.encode=r=>lr(r,e.codec()),e.decode=r=>ur(r,e.codec())})(Ln||(Ln={}));async function Gf(e,t,r){let n=await h1(e,Yf(t));if(e.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return u1(e.publicKey,n,r)}function u1(e,t,r){return Ln.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function h1(e,t){if(e.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await Hf(e.privateKey)).sign(t)}async function Go(e){return zo(e.identityKey)}function Yo(e){return Ln.decode(e)}function Yf(e){let t=It("noise-libp2p-static-key:");return e instanceof Uint8Array?Zt([t,e],t.length+e.length):(e.prepend(t),e)}async function Wo(e,t,r){let n=await zo(t.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=Yf(e);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(t.identitySig==null)throw new Error("Signature was missing from message");if(!await Ff(n.publicKey).verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function Rn(e){return!(!(e instanceof Uint8Array)&&!br(e)||e.byteLength!==32)}var l1=0,p1=4294967295,d1="Cipherstate has reached maximum n, a new handshake must be performed",ki=class{n;bytes;view;constructor(t=l1){this.n=t,this.bytes=rt(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>p1)throw new Error(d1)}};var Ui=class{crypto;log;constructor(t,r){this.log=t.logger.forComponent("libp2p:noise:abstract-handshake"),this.crypto=r}encryptWithAd(t,r,n){let i=this.encrypt(t.k,t.n,r,n);return t.n.increment(),i}decryptWithAd(t,r,n,i){let{plaintext:s,valid:o}=this.decrypt(t.k,t.n,r,n,i);return o&&t.n.increment(),{plaintext:s,valid:o}}hasKey(t){return!this.isEmptyKey(t.k)}createEmptyKey(){return rt(32)}isEmptyKey(t){let r=this.createEmptyKey();return Rt(r,t)}encrypt(t,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,t)}encryptAndHash(t,r){let n;return this.hasKey(t.cs)?n=this.encryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,n),n}decrypt(t,r,n,i,s){r.assertValue();let o=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,t,s);return o?{plaintext:o,valid:!0}:{plaintext:rt(0),valid:!1}}decryptAndHash(t,r){let n,i=!0;return this.hasKey(t.cs)?{plaintext:n,valid:i}=this.decryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,r),{plaintext:n,valid:i}}dh(t,r){try{let n=this.crypto.generateX25519SharedKey(t,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return this.log.error("error deriving shared key",i),rt(32)}}mixHash(t,r){t.h=this.getHash(t.h,r)}getHash(t,r){return this.crypto.hashSHA256(new At(t,r))}mixKey(t,r){let[n,i]=this.crypto.getHKDF(t.ck,r);t.cs=this.initializeKey(i),t.ck=n}initializeKey(t){return{k:t,n:new ki}}initializeSymmetric(t){let r=It(t,"utf-8"),n=this.hashProtocolName(r),i=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:i,h:n}}hashProtocolName(t){if(t.length<=32){let r=rt(32);return r.set(t),r}else return this.getHash(t,rt(0))}split(t){let[r,n]=this.crypto.getHKDF(t.ck,rt(0)),i=this.initializeKey(r),s=this.initializeKey(n);return{cs1:i,cs2:s}}writeMessageRegular(t,r){let n=this.encryptWithAd(t,rt(0),r),i=this.createEmptyKey(),s=rt(0);return{ne:i,ns:s,ciphertext:n}}readMessageRegular(t,r){return this.decryptWithAd(t,rt(0),r.ciphertext)}};var Ki=class extends Ui{initializeInitiator(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,t);let a=rt(32);return{ss:o,s:r,rs:n,psk:i,re:a}}initializeResponder(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,t);let a=rt(32);return{ss:o,s:r,rs:n,psk:i,re:a}}writeMessageA(t,r,n){let i=rt(0);n!==void 0?t.e=n:t.e=this.crypto.generateX25519KeyPair();let s=t.e.publicKey;this.mixHash(t.ss,s);let o=this.encryptAndHash(t.ss,r);return{ne:s,ns:i,ciphertext:o}}writeMessageB(t,r){t.e=this.crypto.generateX25519KeyPair();let n=t.e.publicKey;this.mixHash(t.ss,n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let i=t.s.publicKey,s=this.encryptAndHash(t.ss,i);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let o=this.encryptAndHash(t.ss,r);return{ne:n,ns:s,ciphertext:o}}writeMessageC(t,r){let n=t.s.publicKey,i=this.encryptAndHash(t.ss,n);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let s=this.encryptAndHash(t.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:s},{cs1:c,cs2:f}=this.split(t.ss);return{h:t.ss.h,messageBuffer:a,cs1:c,cs2:f}}readMessageA(t,r){return Rn(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),this.decryptAndHash(t.ss,r.ciphertext)}readMessageB(t,r){if(Rn(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);i&&Rn(n)&&(t.rs=n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:o}=this.decryptAndHash(t.ss,r.ciphertext);return{plaintext:s,valid:i&&o}}readMessageC(t,r){let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);if(i&&Rn(n)&&(t.rs=n),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:o}=this.decryptAndHash(t.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(t.ss);return{h:t.ss.h,plaintext:s,valid:i&&o,cs1:a,cs2:c}}initSession(t,r,n){let i=this.createEmptyKey(),s=rt(32),o;return t?o=this.initializeInitiator(r,n,s,i):o=this.initializeResponder(r,n,s,i),{hs:o,i:t,mc:0}}sendMessage(t,r,n){let i;if(t.mc===0)i=this.writeMessageA(t.hs,r,n);else if(t.mc===1)i=this.writeMessageB(t.hs,r);else if(t.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(t.hs,r);i=o,t.h=s,t.cs1=a,t.cs2=c}else if(t.mc>2)if(t.i){if(!t.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(t.cs1,r)}else{if(!t.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(t.cs2,r)}else throw new Error("Session invalid.");return t.mc++,i}recvMessage(t,r){let n=rt(0),i=!1;if(t.mc===0)({plaintext:n,valid:i}=this.readMessageA(t.hs,r));else if(t.mc===1)({plaintext:n,valid:i}=this.readMessageB(t.hs,r));else if(t.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:f}=this.readMessageC(t.hs,r);n=o,i=a,t.h=s,t.cs1=c,t.cs2=f}return t.mc++,{plaintext:n,valid:i}}};function Wf(e,t){!t.enabled||!Er||(t(`LOCAL_STATIC_PUBLIC_KEY ${Et(e.publicKey,"hex")}`),t(`LOCAL_STATIC_PRIVATE_KEY ${Et(e.privateKey,"hex")}`))}function $o(e,t){!t.enabled||!Er||(e?(t(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Et(e.publicKey,"hex")}`),t(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Et(e.privateKey,"hex")}`)):t("Missing local ephemeral keys."))}function $f(e,t){!t.enabled||!Er||t(`REMOTE_STATIC_PUBLIC_KEY ${Et(e.subarray(),"hex")}`)}function Zo(e,t){!t.enabled||!Er||t(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Et(e.subarray(),"hex")}`)}function Zf(e,t){!t.enabled||!Er||(e.cs1&&e.cs2?(t(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${Et(e.cs1.k,"hex")}`),t(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${Et(e.cs2.k,"hex")}`)):t("Missing cipher state."))}var Oi=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;log;constructor(t,r,n,i,s,o,a,c,f){this.log=t.logger.forComponent("libp2p:noise:xxhandshake"),this.isInitiator=r,this.payload=n,this.prologue=i,this.staticKeypair=o,this.connection=a,c&&(this.remotePeer=c),this.xx=f??new Ki(t,s),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(Wf(this.session.hs.s,this.log),this.isInitiator){this.log.trace("Stage 0 - Initiator starting to send first message.");let t=this.xx.sendMessage(this.session,rt(0));await this.connection.write(t0(t)),this.log.trace("Stage 0 - Initiator finished sending first message."),$o(this.session.hs.e,this.log)}else{this.log.trace("Stage 0 - Responder waiting to receive first message...");let t=n0((await this.connection.read()).subarray()),{valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new rr("xx handshake stage 0 validation fail");this.log.trace("Stage 0 - Responder received first message."),Zo(this.session.hs.re,this.log)}}async exchange(){if(this.isInitiator){this.log.trace("Stage 1 - Initiator waiting to receive first message from responder...");let t=i0((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new rr("xx handshake stage 1 validation fail");this.log.trace("Stage 1 - Initiator received the message."),Zo(this.session.hs.re,this.log),$f(this.session.hs.rs,this.log),this.log.trace("Initiator going to check remote's signature...");try{let i=Yo(r);this.remotePeer=this.remotePeer||await Go(i),await Wo(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new cn(`Error occurred while verifying signed payload: ${s.message}`)}this.log.trace("All good with the signature!")}else{this.log.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let t=this.xx.sendMessage(this.session,this.payload);await this.connection.write(e0(t)),this.log.trace("Stage 1 - Responder sent the second handshake message with signed payload."),$o(this.session.hs.e,this.log)}}async finish(){if(this.isInitiator){this.log.trace("Stage 2 - Initiator sending third handshake message.");let t=this.xx.sendMessage(this.session,this.payload);await this.connection.write(r0(t)),this.log.trace("Stage 2 - Initiator sent message with signed payload.")}else{this.log.trace("Stage 2 - Responder waiting for third handshake message...");let t=s0((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new rr("xx handshake stage 2 validation fail");this.log.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=Yo(r);this.remotePeer=this.remotePeer||await Go(i),await Wo(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new cn(`Error occurred while verifying signed payload: ${s.message}`)}}Zf(this.session,this.log)}encrypt(t,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,rt(0),t)}decrypt(t,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,rt(0),t,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(t,r=!0){if(!t.cs1||!t.cs2)throw new rr("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?t.cs1:t.cs2:r?t.cs2:t.cs1}setRemoteNoiseExtension(t){t&&(this.remoteExtensions=t)}};function Xf(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var Mi=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;components;constructor(t,r={}){let{staticNoiseKey:n,extensions:i,crypto:s,prologueBytes:o}=r,{metrics:a}=t;this.components=t,this.crypto=s??ja,this.extensions=i,this.metrics=a?Xf(a):void 0,n?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(n):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=o??rt(0)}async secureOutbound(t,r,n){let i=Zi(r,{lengthEncoder:Lr,lengthDecoder:on,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:n}),o=await this.createSecureConnection(i,s);return r.source=o.source,r.sink=o.sink,{conn:r,remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(t,r,n){let i=Zi(r,{lengthEncoder:Lr,lengthDecoder:on,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:n}),o=await this.createSecureConnection(i,s);return r.source=o.source,r.sink=o.sink,{conn:r,remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(t){let r=await Gf(t.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(t,r)}async performXXHandshake(t,r){let{isInitiator:n,remotePeer:i,connection:s}=t,o=new Oi(this.components,n,r,this.prologue,this.crypto,this.staticKeys,s,i);try{await o.propose(),await o.exchange(),await o.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return o}async createSecureConnection(t,r){let[n,i]=ya(),s=t.unwrap();return await ga(n,c0(r,this.metrics),s,o=>Jr(o,{lengthDecoder:on}),f0(r,this.metrics),n),i}};function y1(e={}){return t=>new Mi(t,e)}return uu(x1);})();
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
