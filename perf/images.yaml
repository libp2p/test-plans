# Perf Test - Implementation Definitions
# This file defines all implementations to test for libp2p performance benchmarking

# Test Aliases - Define reusable patterns for test selection
# Usage: --test-select "~libp2p" or --test-ignore "~baseline"
test-aliases:
  - alias: "all"
    value: "~baselines|~impls"
  - alias: "impls"
    value: "dotnet-v1.0|go-v0.45|js-v3.x|rust-v0.56"
  - alias: "baselines"
    value: "https|quic-go|iperf"
  - alias: "go"
    value: "go-v0.45"
  - alias: "rust"
    value: "rust-v0.56"
  - alias: "js"
    value: "js-v3.x"
  - alias: "dotnet"
    value: "dotnet-v1.0"
  - alias: "failing"
    value: "go-v0.45|js-v3.x"

# Server configurations - Where perf servers run
# Supports both local (Docker on same machine) and remote (SSH to another machine)
servers:
  # Local server - runs in Docker container on same machine as client
  - id: local
    type: local
    description: "Run server in Docker on same machine as client"
    # No additional configuration needed for local servers

  # Example remote server configuration
  # Uncomment and configure for your setup
  # - id: remote
  #   type: remote
  #   hostname: "192.168.1.100"  # IP address or DNS name
  #   username: "perfuser"        # SSH username on remote machine
  #   description: "Remote Debian 13 server (Computer 2)"
  #   # Requirements:
  #   # - SSH key-based authentication setup (see QUICKSTART.md)
  #   # - Docker installed and user in docker group
  #   # - Port 4001 accessible (default perf protocol port)

# Baseline implementations - Separate from main tests
# These measure raw network/protocol performance for comparison
# Docker image naming: perf-<id>
baselines:
  # HTTPS baseline (standalone transport - no secureChannel/muxer needed)
  - id: https
    name: "HTTPS Baseline (Go stdlib)"
    source:
      type: local
      path: impls/https/v1.0
      dockerfile: Dockerfile
    server: local
    transports:
      - https
    secureChannels: []  # Standalone transport
    muxers: []          # Standalone transport
    protocols:
      - perf
    capabilities:
      - upload
      - download
      - latency
    metadata:
      language: go
      version: stdlib
      baseline: true

  # QUIC-Go baseline (standalone transport - no secureChannel/muxer needed)
  - id: quic-go
    name: "QUIC-Go Baseline"
    source:
      type: local
      path: impls/quic-go/v1.0
      dockerfile: Dockerfile
    server: local
    transports:
      - quic
    secureChannels: []  # Standalone transport
    muxers: []          # Standalone transport
    protocols:
      - perf
    capabilities:
      - upload
      - download
      - latency
    metadata:
      language: go
      version: v0.40.0
      baseline: true

  # iperf3 baseline (raw TCP performance)
  - id: iperf
    name: "iperf3 TCP Baseline"
    source:
      type: local
      path: impls/iperf/v3.0
      dockerfile: Dockerfile
    server: local
    transports:
      - tcp
    secureChannels: []  # Raw TCP, no encryption
    muxers: []          # No muxing
    protocols:
      - iperf3
    capabilities:
      - upload
      - download
      - latency
    metadata:
      language: bash
      version: "3.0"
      baseline: true

# Implementation definitions
# Docker image naming: perf-<id>
implementations:
  # go-libp2p
  - id: go-v0.45
    name: "go-libp2p v0.45"
    source:
      type: local
      path: impls/go/v0.45
      dockerfile: Dockerfile
    server: local              # Server to use: local, remote-1, etc.
    transports:
      - tcp
      - quic-v1
      - webtransport
    secureChannels:
      - noise
      - tls
    muxers:
      - yamux
      - mplex
    protocols:
      - perf
    capabilities:
      - upload
      - download
      - latency
    metadata:
      language: go
      version: v0.45.0
      repo: libp2p/go-libp2p

  # rust-libp2p
  - id: rust-v0.56
    name: "rust-libp2p v0.56"
    source:
      type: local
      path: impls/rust/v0.56
      dockerfile: Dockerfile
    server: local              # Change to remote-1 for remote testing
    transports:
      - tcp
      - quic-v1
    secureChannels:
      - noise
      - tls
    muxers:
      - yamux
      - mplex
    protocols:
      - perf
    capabilities:
      - upload
      - download
      - latency
    metadata:
      language: rust
      version: v0.56.0
      repo: libp2p/rust-libp2p

  # js-libp2p
  - id: js-v3.x
    name: "js-libp2p v3.x"
    source:
      type: local
      path: impls/js/v3.x
      dockerfile: Dockerfile
    server: local
    transports:
      - tcp
      - webtransport
    secureChannels:
      - noise
      - tls
    muxers:
      - yamux
      - mplex
    protocols:
      - perf
    capabilities:
      - upload
      - download
    metadata:
      language: javascript
      version: v3.0.0
      repo: libp2p/js-libp2p

  # dotnet-libp2p
  - id: dotnet-v1.0
    name: "dotnet-libp2p v1.0"
    source:
      type: local
      path: impls/dotnet/v1.0
      dockerfile: Dockerfile
    server: local
    transports:
      - tcp
      - quic-v1
    secureChannels:
      - noise
      - tls
    muxers:
      - yamux
      - mplex
    protocols:
      - perf
    capabilities:
      - upload
      - download
    metadata:
      language: dotnet
      version: v1.0
      repo: NethermindEth/dotnet-libp2p


